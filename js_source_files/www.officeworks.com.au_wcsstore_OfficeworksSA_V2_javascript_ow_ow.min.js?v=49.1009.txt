ow.models.owstoremodel=function(){var e=Backbone.Model.extend({defaults:{storeUniqueId:"",storeName:"",storeAddressLine:"",storeCity:"",storeState:"",storePostcode:"",storeTelephone:"",storeFax:"",storeGeocodeLat:"",storeGeocodeLon:"",storeDistance:"",storeDistanceUom:"",storeHours:"",isDefaultStore:!1,storeTradingException:"",storeActivity:"",notificationMessage:"",servicesAvailable:!1,serviceInstorePickup:"",serviceSpecialOrders:"",serviceOfficeFitout:"",serviceTechService:"",serviceManagedPrint:"",serviceRentIt:"",serviceExtraCover:"",serviceProductInsurance:"",serviceDeliverIt:"",serviceAssembleIt:"",serviceTrailerHire:"",serviceMeetingRooms:"",serviceWifi:"",serviceFreeInternet:"",servicePrintAndCopy:"",serviceParcelDelivery:"",serviceBusinessSpecialistInStore:"",status:""}});return e}(),ow.models.product=function(){var e=Backbone.Model.extend({defaults:{ratingRange:"",shortDescription:"",longDescription:"",digitalDownload:!1,mainImage:"",uniqueID:"",thumbnail:"",fullimage:"",maxOrderQty:0,ecoOk:!1,ratingValue:"0",reviewCount:"0",ratingPercentage:0,ribbonDisplayName:"",productName:"",priorityRibbon:"",productDisplayUrl:"",partNumber:"",ribbonFileName:"",platformLogo:null,onlineOnly:!1,storeOnly:!1,storeClearance:!1,onlineClearance:!1,deliveryMaxDays:"",deliverMinDays:"",attr:ow.collections.productattr,backordercapable:"N",productcattype:"STANDARD",rangedonline:"No",rangedretail:"No",bigandbulky:"No",swmsproduct:"No",thirdpartyproduct:"No",deliverymindays:"",deliverymaxdays:"",pbsproduct:"No"},initialize:function(){this.on("change",this.initAttrCommons)},initAttrCommons:function(){var e=this.get("attr");e.each(function(e){console.info(e.toJSON())}),alert(this.get("partNumber"))}});return e}(),ow.collections.products=function(){var e=Backbone.Collection.extend({model:ow.models.product});return e}(),ow.utils.wc.commonUtils=function(){var e={};return e.parseJson=function(e){if("undefined"!==e)try{return JSON.parse(e)}catch(t){return}},e.ajaxPost=function(t,r,a,o,i){return t&&"undefined"!=typeof t&&"undefined"!=typeof r?(-1===t.indexOf("nc=true")&&(t=e.noCommentURL(t)),$.post(t,r).done(a).fail(o).always(i)):void 0},e.ajaxGet=function(t,r,a,o,i){return t&&"undefined"!=typeof t&&"undefined"!=typeof r?(-1===t.indexOf("nc=true")&&(t=e.noCommentURL(t)),$.get(t,r).done(a).fail(o).always(i)):void 0},e.ajaxGetJSON=function(t,r,a,o,i){return t&&"undefined"!=typeof t&&"undefined"!=typeof r?(-1===t.indexOf("nc=true")&&(t=e.noCommentURL(t)),$.getJSON(t,r).done(a).fail(o).always(i)):void 0},e.compileHandlebarsTemplate=function(e,t,r,a){if("undefined"!==r&&r||(r={}),"undefined"!==e&&"undefined"!==t&&"object"==typeof r){var o=Handlebars.templates[t];a?$(e).replaceWith(o(r)):$(e).html(o(r))}},e.noCommentURL=function(e){var t;return t=-1!=e.indexOf("?")?e+"&nc=true":e+"?nc=true"},e.getBaseUrl=function(){var e=$(location).attr("href"),t=e.indexOf("?");return-1==t?e:e.slice(0,t)},e.getUrlParameters=function(){for(var e,t={},r=$(location).attr("href").slice($(location).attr("href").indexOf("?")+1).split("&"),a=0;a<r.length;a++)e=r[a].split("="),t[e[0]]=e[1];return t},e.getUrlParameter=function(t){return e.getUrlParameters()[t]},e.appendParams=function(e,t){var r;return r=-1!=e.indexOf("?")?e+"&"+$.param(t):e+"?"+$.param(t)},e.phoneValidateMethod=function(e,t){return this.optional(t)||/^[0-9\s]+$/i.test(e)},e.equalheight=function(e){var t,r=0,a=0,o=new Array;$(e).each(function(){if(t=$(this),$(t).height("auto"),topPostion=t.position().top,a!=topPostion){for(currentDiv=0;currentDiv<o.length;currentDiv++)o[currentDiv].height(r);o.length=0,a=topPostion,r=t.height(),o.push(t)}else o.push(t),r=r<t.height()?t.height():r;for(currentDiv=0;currentDiv<o.length;currentDiv++)o[currentDiv].height(r)})},e.loader=function(e){var t;$("#loadingModal").length<1?(loadingModalTemplate=Handlebars.templates.loadingModalTemplate,t=$(loadingModalTemplate())):t=$("#loadingModal"),"show"==e?t.modal("show"):"hide"==e&&t.modal("hide")},e.initAffixBar=function(e){e.css("visibility","hidden");var t=e.height();e.addClass("fixed").hide(),$("body").css({transition:"all 0.5s ease-in-out"}).css({"padding-top":t}),e.css("visibility","visible").slideDown()},e.formatCurrency=function(e,t){return t+parseFloat(e,10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")},e.loadEspots=function(e){var t=ow.url.dynamicEspotURL;$(document).ready(function(){$("[data-ems-name]").each(function(){var r=$(this).data();null==e||void 0==e||$.isEmptyObject(e)||$.extend(r,e),$.ajax({context:this,type:"GET",url:t,data:r,success:function(e){$(this).html(e),"undefined"!=typeof ow.controls.espotProductRecsControl&&ow.controls.espotProductRecsControl.findProductEspotAndDisplay();var t=document.createEvent("Event");t.initEvent("pbUpdate",!1,!0),document.dispatchEvent(t)},error:function(){console.log("unable to populate data for espot: "+r)}})})})},e}(),ow.utils.wc.eventbus=function(){return ow.state.vent=ow.state.vent||_.extend({},Backbone.Events),ow.state.vent}(),Handlebars.registerHelper("absoluteUrl",function(){return new Handlebars.SafeString(ow.url.absoluteURL)}),Handlebars.registerHelper("urlqueryhelper",function(e){return new Handlebars.SafeString(-1!=e.indexOf("?")?e+"&":e+"?")}),Handlebars.registerHelper("ifvalue",function(e,t){return t.hash.value===e?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("ifMatchesCaseInsensitive",function(e,t,r){return void 0===e||void 0===t?!1:e.toLowerCase()===t.toLowerCase()?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("ifCond",function(e,t,r){return e===t?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("option",function(e){var t=e.toString().toLowerCase()===this.value.toString().toLowerCase()?'selected="selected"':"";return'<option value="'+this.code+'" '+t+">"+this.value+"</option>"}),Handlebars.registerHelper("optionCode",function(e){var t=e.toString().toLowerCase()===this.code.toString().toLowerCase()?'selected="selected"':"";return'<option value="'+this.code+'" '+t+">"+this.value+"</option>"}),Handlebars.registerHelper("companyOptionClass",function(e){if(void 0===e||""===e)return"";var t=e.toString().toLowerCase(),r=this.code.toString().toLowerCase(),a=t===r||"0"!==r&&parseInt(t)>=parseInt(r)?"active":"";return a}),Handlebars.registerHelper("checkCardExpireAndDate",function(e,t){var r=new Date("20"+e.split("/")[1],e.split("/")[0]),a=new Date,o=Math.floor((r-a)/864e5);return a>r?"Expired":90>=o?"Expires in "+o+" Days":t.inverse(this)}),Handlebars.registerHelper("checkCardExpire",function(e,t){var r=new Date("20"+e.split("/")[1],e.split("/")[0]),a=new Date,o=Math.floor((r-a)/864e5);return a>r||90>=o?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("toLowerCase",function(e){return"string"==typeof e?e.toLowerCase():null}),Handlebars.registerHelper("ifgt",function(e,t,r){return e>t?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("ifne",function(e,t,r){return e!==t?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("ifCondExt",function(v1,operator,v2,options){switch(operator){case"==":return v1==v2?options.fn(this):options.inverse(this);case"!=":return v1!=v2?options.fn(this):options.inverse(this);case"===":return v1===v2?options.fn(this):options.inverse(this);case"!==":return v1!==v2?options.fn(this):options.inverse(this);case"&&":return v1&&v2?options.fn(this):options.inverse(this);case"||":return v1||v2?options.fn(this):options.inverse(this);case"<":return v2>v1?options.fn(this):options.inverse(this);case"<=":return v2>=v1?options.fn(this):options.inverse(this);case">":return v1>v2?options.fn(this):options.inverse(this);case">=":return v1>=v2?options.fn(this):options.inverse(this);default:return eval(""+v1+operator+v2)?options.fn(this):options.inverse(this)}}),Handlebars.registerHelper("eachData",function(e,t){var r,a=t.fn,o=t.inverse,i="";if(e&&e.length>0)for(var n=0,s=e.length;s>n;n++)r=Object.create(e[n]),r.index=n,i+=a(r);else i=o(this);return i}),Handlebars.registerHelper("math",function(e,t,r){return e=parseFloat(e),r=parseFloat(r),{"+":e+r,"-":e-r,"*":e*r,"/":e/r,"%":e%r}[t]}),Handlebars.registerHelper("block-params",function(){for(var e=[],t=arguments[arguments.length-1],r=0;r<arguments.length-1;r++)e.push(arguments[r]);return t.fn(this,{data:t.data,blockParams:e})}),Handlebars.registerHelper("unescape-html",function(e){return"undefined"!=typeof e?new Handlebars.SafeString(e.decodeEntities()):void 0}),Handlebars.registerHelper("unescape-url",function(e){return $("<textarea />").html(e.decodeEntities()).val()}),Handlebars.registerHelper("truncate",function(e,t){if(null!=e){if(e.length>t&&e.length>0){var r=e+" ";return r=e.substr(0,t),r=e.substr(0,r.lastIndexOf(" ")),r=r.length>0?r:e.substr(0,t),new Handlebars.SafeString(r+"...")}return e}}),Handlebars.registerHelper("chain",function(){var e,t=[];return $.each(arguments,function(r,a){return Handlebars.helpers[a]?void t.push(Handlebars.helpers[a]):(e=a,$.each(t,function(t,a){e=a(e,arguments[r+1])}),!1)}),e}),Handlebars.registerHelper("concat",function(){var e=Array.prototype.slice.call(arguments,0,-1);return e.join("")}),Handlebars.registerHelper("eachInMap",function(e,t){var r="";return Object.keys(e).map(function(a){r+=t.fn({key:a,value:e[a]})}),r}),Handlebars.registerHelper("kitImgDir",function(){return ow.imagePath}),Handlebars.registerHelper("global",function(varName){try{return eval(varName)}catch(e){}}),Handlebars.registerHelper("eachInMapMod",function(e,t){var r="";return Object.keys(e).map(function(a){r+=t.fn({prop:e[a]})}),r}),Handlebars.registerHelper("formatCurrency",function(e){return parseFloat(e,10).toFixed(2)}),Handlebars.registerHelper("safeVal",function(e,t){var r=e||t;return new Handlebars.SafeString(r)}),Handlebars.registerHelper("cssCompliantIdString",function(e){return e.replace(/[^\w-_:\.]/g,"-")}),Handlebars.registerHelper("addModalLinkToStore",function(e,t){return"undefined"==typeof e?"":"undefined"==typeof t?e:e.replace("Officeworks",'<a class="ow-availability__current-store" href="#storeModal" data-type="detailsonly" data-toggle="modal" data-storename="'+t+'">Officeworks</a>')}),Handlebars.registerHelper("maxOrderQtyCheck",function(e,t,r){return t&&0!==t&&e>t?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("formatPrice",function(e,t,r){return isNaN(e)||null===e?t?"$0.00":r?"FREE":"TBC":0==e?"FREE":"$"+Number(e).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}),Handlebars.registerHelper("json",function(e){return JSON.stringify(e)}),Handlebars.registerHelper("splitAndIterate",function(e,t,r,a,o,i){for(var n=a,s=0,c=0;c<e.length&&(c>0&&c%t==0&&s++,!(s>=r));c++)c>0&&c%t==0&&(n+=o,n+=a),n+=i.fn(e[c]);return n+=o}),Handlebars.registerHelper("getFromLocalStorage",function(e,t){if("string"==typeof window.ow.utils.localStorageUtil.sessionStorage(e))var r=JSON.parse(window.ow.utils.localStorageUtil.sessionStorage(e));return"undefined"!=typeof r&&"undefined"!=typeof r[t]?unescape(r[t]):void 0}),Handlebars.registerHelper("cleanConcat",function(e){var t=e.toLowerCase().replace(/\s/g,"-");return t}),Handlebars.registerHelper("capitalise",function(e){return"undefined"!=typeof e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():void 0}),Handlebars.registerHelper("capitaliseAllWords",function(e){return"undefined"!=typeof e?e.toLowerCase().replace(/\b\w/g,function(e){return e.toUpperCase()}):void 0}),Handlebars.registerHelper("eq",function(e,t){return e===t}),Handlebars.registerHelper("ne",function(e,t){return e!==t}),Handlebars.registerHelper("lt",function(e,t){return t>e}),Handlebars.registerHelper("gt",function(e,t){return e>t}),Handlebars.registerHelper("lte",function(e,t){return t>=e}),Handlebars.registerHelper("gte",function(e,t){return e>=t}),Handlebars.registerHelper("and",function(){for(var e=arguments.length>1,t=0;e&&t<arguments.length-1;t++)e=e&&(arguments[t]?!0:!1);return e}),Handlebars.registerHelper("or",function(){for(var e=!1,t=0;t<arguments.length-1;t++)e=e||(arguments[t]?!0:!1);return e}),Handlebars.registerHelper("not",function(e){return!(e?!0:!1)}),Handlebars.registerHelper("now",function(){return new Date}),Handlebars.registerHelper("parseDate_yyyy_MM_dd",function(e){if("string"==typeof e){var t=e.split("-");return new Date(t[0],t[1]-1,t[2])}return null}),Handlebars.registerHelper("numDays",function(e,t){return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),((t-e)/864e5).toFixed(0)}),Handlebars.registerHelper("formatDate",function(e){var t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r=["January","February","March","April","May","June","July","August","September","October","November","December"];return t[e.getDay()]+", "+r[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()}),Handlebars.registerHelper("cookie",function(e){return $.cookie(e)}),Handlebars.registerHelper("isBrowseAvailabilityPreferencesEnabled",function(){return"true"===$.cookie("OW_BROWSE_AVAILABILITY_PREFERENCES")||ow.state.browseAvailabilityPreferencesEnabled}),Handlebars.registerHelper("isAllAvailabilityPreferencesSet",function(){return!("undefined"==typeof $.cookie("OW_DELIVER_POSTCODE")||"undefined"==typeof $.cookie("OW_DELIVER_SUBURB")||"undefined"==typeof $.cookie("LOCATION_IDENTIFIED"))}),Handlebars.registerHelper("highlight",function(e,t,r,a){for(var o=[],i=0;i<e.length;i++)o.push(!1);for(var n=e.toLowerCase(),s=t.toLowerCase().split(" "),c=0;c<s.length;)""===s[c]?s.splice(c,1):c++;for(var c=0;c<s.length;c++){var l=s[c],d=0;do{var u=n.indexOf(l,d);if(-1!=u){for(var p=u;p<u+l.length;p++)o[p]=!0;d=u+1}else d=u}while(-1!=d)}for(var i=e.length-1;i>=0;i--)o[i]&&(i===o.length-1?e+=a:o[i+1]||(e=e.slice(0,i+1)+a+e.slice(i+1))),o[i]&&(0===i?e=r+e:o[i-1]||(e=e.slice(0,i)+r+e.slice(i)));return e}),Handlebars.registerHelper("isAvailabilityPreferenceItem",function(e){var t="true"===$.cookie("OW_BROWSE_AVAILABILITY_PREFERENCES")||ow.state.browseAvailabilityPreferencesEnabled,r=!("undefined"!=typeof $.cookie("OW_DELIVER_POSTCODE")&&"undefined"!=typeof $.cookie("OW_DELIVER_SUBURB")&&"undefined"!=typeof $.cookie("LOCATION_IDENTIFIED")),a=!0;return e&&(a=$.inArray(e,["GENERAL_SERVICE","DIGITAL_DOWNLOAD","DONATION","ONLINE_PRINT"])>=0?!1:!0),t&&r&&a}),Handlebars.registerHelper("decodeURIComponent",function(e){return decodeURIComponent(e)}),Handlebars.registerHelper("stripNonNumericChars",function(e){return"undefined"==typeof e?e:e.replace(/[^0-9]/g,"")}),Handlebars.registerHelper("startsWith",function(e,t){return null===e?null===t:0===e.indexOf(t)}),Handlebars.registerHelper("isNotFirefoxBrowser",function(){return!(navigator.userAgent.toLowerCase().indexOf("firefox")>1)});var NEXT_DAY_THIRD_PARTY_PART_NUMBERS=["FF5X7PRI","OP5X7PRI","FF5X7COL","OP5X7COL","FF5X5PRI","OP5X5PRI","FF6X4PRI","OP4X6PRI","FF6X4COL","OP4X6COL","FF6X6PRI","OP6X6PRI","FF6X8PRI","OP6X8PRI","FF6X8COL","OP6X8COL","FF8X10PRI","OP8X10PRI","FF8X10COL","OP8X10COL","FF8X12PRI","OP8X12PRI","FF8X12COL","OP8X12COL","FF8X8PRI","OP8X8PRI","FF11X14PRI","OP11X14PRI","FF12X12PRI","OP12X12PRI","FF12X16PRI","OP12X16PRI","FF12X18PRI","OP12X18PRI","FF12X24PRI","OP12X24PRI","FF12X36PRI","OP12X36PRI"],NEXT_DAY_THIRD_PARTY_EXCLUDED_STORE=["W363","W615","W271"];Handlebars.registerHelper("getThirdPartyCollectMsg",function(e,t){var r=e,a=$.cookie("OW_STORE_NAME");return $.inArray(t,NEXT_DAY_THIRD_PARTY_PART_NUMBERS)>-1&&$.inArray(a,NEXT_DAY_THIRD_PARTY_EXCLUDED_STORE)<0&&(r="Next business day collection"),r}),ow.utils.wc.localstorageutil=function(){var e=Backbone.View.extend({initialize:function(){_.bindAll(this),this.localStorageSupported=this.testLocalStorageSupported(),this.sessionStorageSupported=this.testSessionStorageSupported()},isLocalStorageSupported:function(){return this.localStorageSupported},isSessionStorageSupported:function(){return this.sessionStorageSupported},testLocalStorageSupported:function(){if(void 0==amplify.store.localStorage)return!1;try{return amplify.store.localStorage("ow.localstorageutil.tester","localtest"),amplify.store.localStorage("ow.localstorageutil.tester",null),!0}catch(e){return!1}},testSessionStorageSupported:function(){if(void 0==amplify.store.sessionStorage)return!1;try{return amplify.store.sessionStorage("ow.localstorageutil.tester","sessiontest"),amplify.store.sessionStorage("ow.localstorageutil.tester",null),!0}catch(e){return!1}},localStorage:function(e,t){if(void 0!=t){if(this.localStorageSupported)try{amplify.store.localStorage(e,t)}catch(r){}}else{var a;if(!this.localStorageSupported)return{};try{return a=amplify.store.localStorage(e),void 0!=a?a:{}}catch(r){return{}}}},localStorageRemove:function(e){if(!this.localStorageSupported)return{};try{amplify.store.localStorage(e,null)}catch(t){return{}}},sessionStorage:function(e,t){if(void 0!=t){if(this.sessionStorageSupported)try{amplify.store.sessionStorage(e,t)}catch(r){}}else{var a;if(!this.sessionStorageSupported)return{};try{return a=amplify.store.sessionStorage(e),void 0!=a?a:{}}catch(r){return{}}}},sessionStorageRemove:function(e){if(!this.sessionStorageSupported)return{};try{amplify.store.sessionStorage(e,null)}catch(t){return{}}}});return e}(),ow.utils.localStorageUtil=new ow.utils.wc.localstorageutil,ow.utils.wc.owutils=function(){var e={};return e.isEmpty=function(e){return"string"==typeof e&&!e.trim()||"undefined"==typeof e||null===e},e.partial=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),e.apply(this,r)}},e.getBaseUrl=function(){var e=$(location).attr("href"),t=e.indexOf("?");return-1==t?e:e.slice(0,t)},e.getUrlParameters=function(){for(var e,t={},r=$(location).attr("href").slice($(location).attr("href").indexOf("?")+1).split("&"),a=0;a<r.length;a++)e=r[a].split("="),t[e[0]]=e[1];return t},e.getUrlParameter=function(e){return this.getUrlParameters()[e]},e.noCommentURL=function(e){var t;return t=-1!=e.indexOf("?")?e+"&nc=true":e+"?nc=true"},e.appendParams=function(e,t){var r;return r=-1!=e.indexOf("?")?e+"&"+$.param(t):e+"?"+$.param(t)},e.phoneValidateMethod=function(e,t){return this.optional(t)||/^[0-9\s]+$/i.test(e)},e.equalheight=function(e){var t,r=0,a=0,o=new Array;$(e).each(function(){if(t=$(this),$(t).height("auto"),topPostion=t.position().top,a!=topPostion){for(currentDiv=0;currentDiv<o.length;currentDiv++)o[currentDiv].height(r);o.length=0,a=topPostion,r=t.height(),o.push(t)}else o.push(t),r=r<t.height()?t.height():r;for(currentDiv=0;currentDiv<o.length;currentDiv++)o[currentDiv].height(r)})},e.loader=function(e,t,r){var a=$("undefined"!=typeof t?t:".ow-loading"),o="undefined"!=typeof r?r:"";"show"==e?a.addClass("ow-loading "+o):"hide"==e&&a.removeClass(function(e,t){return(t.match(/(^|\s)ow-load\S+/g)||[]).join(" ")})},e.modals={availabilityModal:function(){$("#availabilityModal").unbind(),$("#availabilityModal").on("show.bs.modal",function(e){var t={},r=$(e.relatedTarget);t.productId=r.closest("[data-id]").data("id");var a=Handlebars.templates["inventory-availability-store-changestore"];$(r).find("#checkinstore").replaceWith(a(t));var o=r.html(),i=$("#product_name_"+r.data("part-number")+" a"),n=i.clone().text(i.attr("title")),s=$(this);s.find(".product-link").html(n),s.find(".modal-body").html(o)})},addToListModal:function(){$("#addToListModal").on("hidden.bs.modal",function(){var e=$(this);e.find(".modal-content").empty()})},storeModal:function(){var t=new window.ow.utils.wc.storelocatorutil,r=$("#storeModal"),a=Handlebars.templates.storeavailability,o=Handlebars.templates.changeStoreLocationsTemplate,i=function(e,i,s){var c={},l="searchwithinventory"===r.data("type"),d=$.Deferred(),u=function(e){e.showInventory=l,r.find(".stores-list").html(a(e))};if($("#checkStoresButton_modal").trigger("buttoncomplete"),"undefined"!=typeof s.suburbs){var p=o(s);return r.find(".change-store-menu").empty().append(p),window.ow.utils.wc.owutils.loader("hide",".stores-list"),void r.find(".duplicate-suburb-link").click(function(t){var a=$(t.currentTarget).text();r.find("#location").val(a),n(e,a)})}return"undefined"==typeof s.stores?(r.find(".stores-list").html(a()),void window.ow.utils.wc.owutils.loader("hide",".stores-list")):(c=t.getOWStores(s),c.showInventory=l,$.when(c).done(function(){window.ow.utils.wc.owutils.loader("hide",".stores-list");var e=[];null!=c&&c.length>0&&$.each(c,function(t,r){r.storeLocatorViewURL=window.ow.url.storeLocatorViewURL.replace(/&amp;/g,"&"),r.showInventory=l,e.push(r.storeIdentifier)}),$.when(d).always(function(){u(c)});var t="accurate"===$.cookie("OW_AVAILABILITY")||window.ow.state.isAvailabilityApiEnabled;if(t){e=_.uniq(e);var a=[],o=r.data("partnumber");_.each(c,function(e){var t=window.ow.url.apiAvailabilityUrl+"/store/"+e.storeIdentifier+"?partNumber="+o;a.push(t)});var i=[];_.each(a,function(e){i.push($.get(e))});var n=function(e){if("undefined"!=typeof e)for(var t=0;t<e.options.length;t++){var r=e.options[t];if("inStore"===r.type)return r.site}return null},s=function(e){if("undefined"!=typeof e)for(var t=0;t<e.options.length;t++){var r=e.options[t];if("inStore"===r.type)return r.qty}return 0};_.each(c,function(e){e.inStock=!1,e.isLimited=!1});var p=window.ow.state.limitedStockLimit;"undefined"==typeof p&&(p=5),$.when.apply($,i).done(function(){_.each(arguments,function(e){var t=e[0][0],r=n(t);if(null!==r){var a=s(t);_.each(c,function(e){e.storeIdentifier===r&&(a>0?(e.inStock=!0,e.isLimited=p>=a?!0:!1):(e.inStock=!1,e.isLimited=!1))})}}),d.resolve()}).fail(function(){d.reject()})}else d.resolve()}),void $.when(d).always(function(){$(".set-store-availability").on("click",function(e){var t=$(e.currentTarget).data("storeid");window.ow.utils.wc.store.setStore(t,function(e){r.modal("hide"),$(document).trigger("loadDeliveryPageSummarySection",e),$(document).trigger("loadFPClickCollectedSection",e),$(document).trigger("storeUpdatedFromModal")})})}))},n=function(e,a,o){r.find(".change-store-menu").empty(),r.find(".stores-list").empty(),window.ow.utils.wc.owutils.loader("show",".stores-list");var n="accurate"===$.cookie("OW_AVAILABILITY")||window.ow.state.isAvailabilityApiEnabled;"searchwithinventory"!==r.data("type")||"undefined"===o||n?t.findNearbyStoresByAddress(a).done(function(t){i(e,a,t)}):t.findNearbyStoresByAddressWithInventory(a,o).done(function(t){i(e,a,t)})},s=function(t,a){var o={},i=Handlebars.templates.storeModal;if(r.addClass("ow-modal--store"),r.data("storename")){var s=r.data("storename"),c=window.ow.utils.localStorageUtil.localStorage("STORE_LIST"),l=c.stores.filter(function(e){return e.storeName===s});if(!(l.length>0))return;store=l[0],o={addressLine:store.storeAddressLine,city:store.storeCity,delTimeframe:null,distance:null,distanceUom:null,externalIdentifier:store.storeIdentifier,fax:store.storeFax,ffmCenterId:null,hours:$("<div />").html(store.StoreHours).text(),lat:store.storeGeocodeLat,lon:store.storeGeocodeLon,name:store.storeName,postcode:store.storePostcode.trim(),state:store.storeState,telephone:store.storeTelephone.trim(),uniqueId:store.storeUniqueId,zone:null},o.storeLocatorViewURL=window.ow.url.storeLocatorViewURL.replace(/&amp;/g,"&")}else"string"==typeof window.ow.utils.localStorageUtil.sessionStorage("PREFERRED_STORE")&&(o=JSON.parse(window.ow.utils.localStorageUtil.sessionStorage("PREFERRED_STORE")),o.hours=$("<div />").html(o.hours).text(),o.storeLocatorViewURL=window.ow.url.storeLocatorViewURL.replace(/&amp;/g,"&"));o.search="search"===t,o.searchwithinventory="searchwithinventory"===t,o.details="details"===t,o.detailsonly="detailsonly"===t,o.productID=a,o.searchString=r.data("postcode-input");var d=i(o),u=d.replace(/%2C/g,",");r.find(".modal-content").html(u),e.isEmpty(o.searchString)||n(r,o.searchString),$(document).trigger("contentloaded")};r.on("show.bs.modal",function(e){var t=$(e.relatedTarget),a=t.data("type"),o=t.data("productid"),i=t.data("partnumber"),n=t.data("storename");r.data("productid",o),r.data("partnumber",i),r.data("type",a),r.data("storename",n),r.data("postcode-input",$("#"+t.data("postcode-input")).val()),s(a,o)}),r.on("hidden.bs.modal",function(){r.find(".modal-content").empty()}),$(document).on("change","#show_nearest",function(){$("#storeSearchModal").submit()}),$(document).on("click","#changeStoreModal",function(){s("search")}),$(document).on("submit","#storeSearchModal",function(e){e.preventDefault();var t=r.find("[name='location']").val(),a=r.data("productid");$("#storeSearchModal").valid()&&n(r,t,a)})},deliveryPageAddressModal:function(){$("#addressModal").on("show.bs.modal",function(e){var t=$(e.relatedTarget),r=Handlebars.templates["deliveryPage-address-modal"],a=t.data("addresstype"),o=t.data("action"),i=t.data("tabname");i=i||"",$(this).find(".modal-content").html(r({addressType:a,addressAction:o,fpTabname:i})),$(document).trigger("contentloaded"),$(document).trigger("addressModalLoaded",$(e.relatedTarget))})},deliveryPageAddressSearchModal:function(){$("#searchAddressModal").on("show.bs.modal",function(e){var t=($(e.relatedTarget),Handlebars.templates["deliveryPage-address-search-modal"]),r={mode:$(e.relatedTarget).data("mode")};$(this).find(".modal-content").html(t(r)),$(document).trigger("contentloaded"),$(document).trigger("addressSearchModalLoaded",$(e.relatedTarget))})},deliveryPageContactSearchModal:function(){$("#searchContactModal").on("show.bs.modal",function(e){var t=($(e.relatedTarget),Handlebars.templates["deliveryPage-contact-search-modal"]);$(this).find(".modal-content").html(t({})),$(document).trigger("contentloaded"),$(document).trigger("contactSearchModalLoaded",$(e.relatedTarget))})},deliveryPageBranchSearchModal:function(){$("#searchBranchModal").on("show.bs.modal",function(e){var t=($(e.relatedTarget),Handlebars.templates["deliveryPage-branch-search-modal"]);$(this).find(".modal-content").html(t({})),$(document).trigger("contentloaded"),$(document).trigger("branchSearchModalLoaded",$(e.relatedTarget))})}},e.initAffixBar=function(e){e.css("visibility","hidden");var t=e.height();e.addClass("fixed").hide(),$("body").css({transition:"all 0.5s ease-in-out"}).css({"padding-top":t}),e.css("visibility","visible").slideDown()},e.formatCurrency=function(e,t){return t+parseFloat(e,10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")},e.getBreakpoint=function(){return window.ow.breakpoints.getBreakpoint()},e.truncateElementToSize=function(e,t){var r=e.val();"undefined"!=typeof r&&$.trim(r).length>t&&e.val($.trim(r).substring(0,t))},e.isVisible=function(e,t){var r=$(window).scrollTop(),a=r+$(window).height(),o=$(e).offset().top,i=o+$(e).height();return t===!0?o>=r&&a>i:a>=o&&i>=r},$(function(){$(".original-text-link").click(function(e){e.preventDefault(),$.removeCookie("siteChoice",{path:"/"}),setTimeout(function(){location.reload(!0)},500)})}),e}(),ow.utils.wc.storelocatorutil=function(){var e=ow.models.owstoremodel,t=ow.utils.wc.owutils,r=function(){this.initialize=function(){},this.findNearbyStores=function(e){return null!=e?$.ajax({type:"GET",url:t.noCommentURL(ow.url.storeLocatorCmdURL+"&lat="+e.latitude+"&lon="+e.longitude+"&service="+$(".form-storelocator .dropdown-toggle").text())}):void 0},this.findNearbyStoresByAddress=function(e){return null!=e?$.ajax({type:"GET",url:t.noCommentURL(ow.url.storeLocatorCmdURL+"&address="+e+"&service="+$(".form-storelocator .dropdown-toggle").text())}):void 0},this.findNearbyStoresByAddressWithInventory=function(e,r){return null!=e?$.ajax({type:"GET",url:t.noCommentURL(ow.url.storeLocatorCmdURL+"&address="+e+"&service="+$(".form-storelocator .dropdown-toggle").text()+"&isIncludeInventory=true&catentryId="+r+"&catalogId="+ow.state.catalogId)}):void 0},this.findNearbyStoresWithInventoryStatus=function(e,r){return null!=e?$.ajax({type:"GET",url:t.noCommentURL(ow.url.absoluteURL+"OWStoreLocatorInvCmd?lat="+e.latitude+"&lon="+e.longitude+"&service="+$(".form-storelocator .dropdown-toggle").text()+"&catentryId="+r+"&catalogId="+ow.state.catalogId)}):void 0},this.getAllStores=function(){return $.ajax({type:"GET",url:t.noCommentURL(ow.url.storeLocatorCmdURL+"&loadAll=y")})},this.replaceSpecialChars=function(e){var t=e.replace(/amp;/g,"");return t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/&quot;/g,""),t=t.replace(/&apos;/g,"")},this.getOWStores=function(t){if("undefined"==typeof t.stores)return null;var r=[],a=t.stores,o=t.defaultStore,i=$.cookie("PREFERRED_STORE_ID");return i&&(o=i),$.each(a,function(t,a){var i=new e;a.storeUniqueId==o&&(i.isDefaultStore=!0),i.storeUniqueId=a.storeUniqueId,i.storeIdentifier=a.storeIdentifier,i.storeName=_.unescape(a.storeName),i.storeEmail=_.unescape(a.Email),i.storeAddressLine=_.unescape(a.storeAddressLine),i.storeCity=_.unescape(a.storeCity),i.storeState=_.unescape(a.storeState),i.storePostcode=_.unescape(a.storePostcode),i.storeTelephone=_.unescape(a.storeTelephone),i.storeFax=_.unescape(a.storeFax),i.storeGeocodeLat=_.unescape(a.storeGeocodeLat),i.storeGeocodeLon=_.unescape(a.storeGeocodeLon),i.storeDistance=Math.round(a.storeDistance).toFixed(1),i.storeDistanceUom=_.unescape(a.storeDistanceUom),i.storeHours=a.StoreHours,i.storeTradingException=a.TradingException,i.storeActivity=a.StoreActivity,i.notificationMessage=_.unescape(a.NotificationMessage),i.servicesAvailable="true"==a.servicesAvailable,i.serviceInstorePickup="true"==a.storepickup,i.serviceSpecialOrders="true"==a.specialorder,i.serviceOfficeFitout="true"==a.officefitout,i.serviceTechService="true"==a.techservices,i.serviceManagedPrint="true"==a.managedprint,i.serviceRentIt="true"==a.rentit,i.serviceExtraCoverb="true"==a.extracover,ow.state.productInsuranceEnabled&&(i.serviceProductInsurance="true"==a.productinsurance),i.serviceDeliverIt="true"==a.deliverit,i.serviceAssembleIt="true"==a.assembleit,i.serviceTrailerHire="true"==a.courtesytrailer,i.serviceMeetingRooms="true"==a.meetingrooms,i.serviceWifi="true"==a.wifi,i.serviceFreeInternet="true"==a.freeinternet,i.servicePrintAndCopy="true"==a.printandcopy,i.serviceParcelDelivery="true"==a.parceldelivery,i.serviceBusinessSpecialistInStore="true"==a.businessspecialistinstore,i.inStock="true"==a.inStock,i.isLimited="true"==a.isLimited,i.status=a.Status,i.inStockMsg=$("<textarea />").html($ow.storeInstock).val(),i.outOfStockMsg=$("<textarea />").html($ow.storeOutOfstock).val(),i.limitedStockMsg=$("<textarea />").html($ow.storeLimitedstock).val(),null!=a.userData&&$.each(a.userData.userDataField,function(e,t){"invStatus"==t.key&&(i.inStock="Available"==t.value?!0:!1)}),r.push(i)}),r}};return r}(),ow.utils.wc.addressUtil=function(){var e=ow.utils.wc.commonUtils,t={};return t.getSuburbs=function(t,r){e.ajaxGet(ow.url.absoluteURL+"OWSuburbFinderCmd",{postcode:t},r)},t.qasCheckAddress=function(t,r){e.ajaxGet(ow.url.qasCheckUrl,t,r)},t.addressContainsPOBox=function(e){return e&&e.toUpperCase().match(/(p\.?\s?[o|0]\.?\s?b\.?([o|0]x)?|post\soffice\sbox)/gi)?!0:!1},t}(),ow.utils.wc.customerinfoutil=function(){var e=ow.utils.wc.eventbus,t=Backbone.View.extend({initialize:function(){_.bindAll(this),e.on("clearUserDataCache",this.clearUserData),this.initCachedGetCustomerDataFunction()},initCachedGetCustomerDataFunction:function(){var e=this;"function"!=typeof ow.utils.wc.getCustomerInfoViaCache&&(ow.utils.wc.getCustomerInfoViaCache=this.createCache(function(t){e.refresh(function(e){t.resolve(e)})}))},needToRefresh:function(){if($.isEmptyObject(ow.utils.localStorageUtil.localStorage("ow.customerinfo.userdata")))return!0;var e=this.getUserActivityIdFromCookie();return void 0!=e&&e===ow.utils.localStorageUtil.localStorage("ow.customerinfo.userdata").WC_USERACTIVITY?!1:!0},refreshIfNewSession:function(e){this.needToRefresh()?"function"==typeof ow.utils.wc.getCustomerInfoViaCache?ow.utils.wc.getCustomerInfoViaCache(e):(this.initCachedGetCustomerDataFunction(),ow.utils.wc.getCustomerInfoViaCache(e)):e(ow.utils.localStorageUtil.localStorage("ow.customerinfo.userdata"))},getUserActivityIdFromCookie:function(){for(var e,t=document.cookie.split(/; */),r=/^WC_USERACTIVITY_/,a=0;a<t.length;a++){var o=t[a].split("=");o[0].search(r)>=0&&(id=o[1],e=o[0].substring("WC_USERACTIVITY_".length,o[0].length))}return e},refresh:function(e){var t="",r=this.getUserActivityIdFromCookie();
t="-1002"===r||"undefined"==typeof r?ow.url.owUserInfoAnonymousURL:ow.url.owUserInfoURL,$.getJSON(t).done(function(t){var a;t.result.isCustomerServiceRep?(a=t.result.isCustomerServiceRepActingAsCustomer?t.result.loggedInUserBasicInfo:t.result.userBasicInfo,a.OWTMDetails=t.result.userBasicInfo):a=t.result.userBasicInfo,a.isCustomerServiceRepActingAsCustomer=t.result.isCustomerServiceRepActingAsCustomer,a.isCustomerServiceRep=t.result.isCustomerServiceRep,a.WC_USERACTIVITY=r,ow.utils.localStorageUtil.localStorage("ow.customerinfo.userdata",a),e(a)}).error(function(){e(ow.utils.localStorageUtil.localStorage("ow.customerinfo.userdata"))})},getUserData:function(e){this.refreshIfNewSession(e)},promiseUserData:function(){var e=$.Deferred();return this.refreshIfNewSession(function(t){e.resolve(t)}),e.promise()},clearUserData:function(){ow.utils.localStorageUtil.localStorageRemove("ow.customerinfo.userdata"),$.removeCookie("isUserLoggedIn",{path:"/"}),$.cookie("minicart","reset",{path:"/"})},setUserData:function(e){ow.utils.localStorageUtil.localStorage("ow.customerinfo.userdata",e)},isLoggedIn:function(e){this.getUserData(function(t){var r=!("undefined"==typeof t||"undefined"==typeof t.userType||null==t.userType||"G"===t.userType);return"function"!=typeof e?r:void e(r)})},getActiveTemplateId:function(e){this.getUserData(function(t){return"function"!=typeof e?t.activeTemplateId:void e(t.activeTemplateId)})},getDisplayGSTExclusive:function(e){this.getUserData(function(t){return"function"!=typeof e?t.displayGSTExclusive:void e(t.displayGSTExclusive)})},createCache:function(e){var t=null;return function(r){t||(t=$.Deferred(function(t){e(t)}).promise()),t.done(r)}}});return $(function(){new t({el:$(document)})}),t}(),ow.utils.wc.resourcecache=function(){var e=Backbone.View.extend({bus:ow.utils.wc.eventbus,initialize:function(){_.bindAll(this),this.bus.on("clearResourceCache."+this.options.key,this.clear)},hasData:function(){var e=ow.utils.localStorageUtil.localStorage(this.options.key);return!$.isEmptyObject(e)},refresh:function(){var e=this,t=$.Deferred();return $.ajax({url:e.options.resource,cache:!0,dataType:"json"}).done(function(r){e.set(r),t.resolve(r)}).fail(function(){t.reject()}),t.promise()},get:function(){if(this.hasData()){var e=$.Deferred();return e.resolve(ow.utils.localStorageUtil.localStorage(this.options.key)),e.promise()}return this.refresh()},clear:function(){ow.utils.localStorageUtil.localStorageRemove(this.options.key)},set:function(e){ow.utils.localStorageUtil.localStorage(this.options.key,e)}});return e}(),ow.utils.wc.analytics=function(){var e={myAccountCartDetails:function(e){ow.state.myaccountmainpage&&this.cmConversionTag(e.customerType,e.cartQty,e.cartTotal)},cmConversionTag:function(e,t,r){cmCreateConversionEventTag("Visit Start With Shopping Cart",2,"Shopping Carts",0,e+"-_--_--_-"+r+"-_-"+t)}};return e}(),ow.utils.wc.checkoututil=function(){var e=ow.utils.wc.commonUtils,t=(ow.utils.wc.productsubutils,ow.utils.wc.customerinfoutil),r={};return r.checkRestrictedRange=function(t){if(ow.state.cartpage){var r=this;e.ajaxGet(e.noCommentURL(ow.url.absoluteURL+"OWPreProcessCheckOutAjax"),{action:"CR",orderId:t},function(e){void 0!=e.status&&"FAILED"==e.status&&($.each(e.response,function(e,t){2==t.type?!$('[data-price="default"][data-id="'+t.productId+'"]').find(".icon-ow-contractprice").length>0&&self.disableRestrictedProductById(t.productId):1==t.type&&self.disableRestrictedProductById(t.productId)}),$(".ow-cart__row.is-restricted .restricted-text").removeClass("hide"),$("[data-empty-disable]").prop("disabled",!0)),r.callback&&"function"==typeof r.callback&&r.callback()})}},r.highlightErrorItems=function(){if("undefined"!=typeof ow.state.invalidItemList){var e=ow.state.invalidItemList.substring(1,ow.state.invalidItemList.length-1).split("|");$.each(e,function(e,t){$('.ow-cart__row[data-catentryid="'+t+'"]').addClass("has-error")})}"undefined"!=typeof ow.state.sapInvalidInventoryItemMap&&$.each(ow.state.sapInvalidInventoryItemMap,function(e){$('.ow-cart__row[data-catentryid="'+e+'"]').addClass("has-error")})},r.removeItemFromCart=function(t,r){e.ajaxGet(e.noCommentURL(ow.url.orderItemDeleteURL),t,r)},r.updateItemInCart=function(t,r){e.ajaxGet(e.noCommentURL(ow.url.orderItemUpdateURL),t,r)},r.addItemInCart=function(t,r){e.ajaxGet(e.noCommentURL(ow.url.orderItemAddURL),t,r)},r.updateAddress=function(t,r){var a="/webapp/wcs/stores/servlet/UpdateOrderAddress?catalogId=10551&nc=true&langId=-1&storeId=10151&nc=true";e.ajaxPost(a,t,r)},r.addNewAddress=function(t,r,a){var o="/webapp/wcs/stores/servlet/UpdateOrderAddress?catalogId=10551&nc=true&langId=-1&storeId=10151&nc=true";e.ajaxPost(o,t,r,a)},r.initAddresses=function(t,r){var a="/webapp/wcs/stores/servlet/UpdateOrderAddress?catalogId=10551&nc=true&langId=-1&storeId=10151&nc=true";e.ajaxGet(a,t,r)},r.emptyCart=function(t,r){e.ajaxGet(e.noCommentURL(ow.url.orderItemDeleteURL),t,r)},disableRestrictedProductById=function(e){$('.ow-cart__row[data-catentryid="'+e+'"]').addClass("is-restricted")},r.checkAndDisplayApprovalMsg=function(){"function"==typeof t&&(t=new t),t.getUserData(function(e){!$.isEmptyObject(e)&&"BUSINESS"===e.customerType&&e.orderApprovalRuleActive&&$.ajax({type:"GET",url:ow.url.approvalCheckURL}).done(function(e){"undefined"!==e&&e.doesOrderRequireApproval?r.approvalTriggered||($(document).trigger("alert",{type:"warning",html:"<p><strong>Warning!</strong> Your order will require approval.</p> <p>If your order breaks an Order Rule applied to your account, a request will be sent to your assigned Approval Group to review and approve your order. You will have the option to send a message to your Approval Group after submitting your order for approval.</p>",dismissible:!0,id:"approvalWarningError",trackState:!1,floating:ow.breakpoints.isSmall(),insert:{method:"insertAfter",selector:"ul.ow-progress-bar"}}),r.approvalTriggered=!0):($("#approvalWarningError").remove(),r.approvalTriggered=!1)})})},r}(),ow.utils.compareUtils=function(){function e(e){var r=ow.utils.localStorageUtil.localStorage("productCompare");return r&&new Date(r.expires).getTime()<(new Date).getTime()?(t({}),"undefined"!=typeof e&&e.notifyExpired?{expired:!0}:{}):r}function t(e){e&&e.products&&(e.expires=(new Date).getTime()+c),ow.utils.localStorageUtil.localStorage("productCompare",e)}function r(e,t,r,a){if(e){var o={};"undefined"!=typeof ow.tagging&&(o.pageType=ow.tagging.cmPageType),"undefined"!=typeof a&&(o.source=a),"undefined"!=typeof r&&(o.product=r),"undefined"!=typeof t&&(o.tray=t),$.publish(e,o)}}function a(e,t){return t&&o(e,t)>-1?!0:!1}function o(e,t){return t?n.call(t,i.bind(null,e)):-1}function i(e,t){return t.identifier===e}function n(e){for(var t=0;t<this.length;t++)if(e(this[t],t,this))return t;return-1}function s(){$(document).trigger("alert",{type:"warning",html:"<strong>Sorry! The products you selected are no longer available to compare. </strong>Please select 2 new items to begin your comparison.",dismissible:!0,scrollTo:!0,trackState:!1,floating:!0,timeout:5e3,insert:{method:"prependTo",selector:"body"}})}var c=864e5,l=(ow.utils.wc.owutils,{});return l.getCompareProducts=e,l.saveCompareProducts=t,l.sendAnalytics=r,l.hasCompareProduct=a,l.getCompareProductIndex=o,l.notifyExpired=s,l}(),ow.utils.confirmationmodal=function(){var e={};return e.show=function(e,t,r,a,o,i){var n=Handlebars.templates.confirmationModal,s=n({body:e,title:t,confirmButtonName:r,cancelButtonName:a}),c=$("#confirmationModal");c.length?c.replaceWith(s):$("body").append(s);var l=$("#confirmationModal");o&&$("#confirmationModalConfirmButton").one("click",function(e){l.modal("hide"),o(e)}),i&&l.one("hidden.bs.modal",i),l.modal("show")},e}(),ow.utils.facets=function(){function e(e){this.threshold=Math.ceil(e*p)}function t(e,t){this.type=t,this.data=e}function r(e,t){var r=t.values.reduce(a,0);return r>=e}function a(e,t){return isNaN(t.count)||(e+=parseInt(t.count)),e}function o(e,t){this._sorted=!1,this.expanded="undefined"!=typeof t&&t===!0?t:!1,this.data=e}function i(e){this.data=e}function n(e){i.call(this,e)}function s(e){this.facet=e,this.sortType=h[e.name]}function c(e,t){this.sorters=e,this.compareValueFn=t}function l(e,t){this.orderArr=this.loadArr(e),this.listCaptureRegex=new RegExp("("+this.orderArr.join("|")+")"),this.directionalMultiplier=t}function d(e,t){this.regex=/^([0-9]*[.]?[0-9]*)(.*)/,this.numericDirectionalMultiplier=e,this.characterDirectionalMultiplier=t}var u="true"===ow.state.filterFacetsEnabled?!0:!1,p=parseFloat(ow.state.filterFacetModifier),f="true"===ow.state.facetValueSortEnabled?!0:!1,h=ow.state.facetSortType,m=ow.state.sortOrder,v={},g=ow.state.facetExpansionThreshold;return v.DEFAULT={selector:"#owFacets",template:Handlebars.templates.subCategoryFacetTemplate,process:function(e){var t={priceBands:e.priceBands,priceFacetApplied:e.priceFacetApplied},r=0;return t.owfacets=e.owfacets.map(function(e){var t=new o(e,!1);return g>r&&(t.expanded=!0,r++),t}),t.facets=e.facets.map(function(e){var t=new o(e,!1);return g>r&&(t.expanded=!0,r++),t}),t}},v.CATEGORY={selector:"#owCategories",template:Handlebars.templates.categoryFacetTemplate,process:function(e){var t=e.categories.reduce(function(e,t){return e.length<12&&(t.url=t.url.replace(/&amp;/g,"&"),t.name=$("<div/>").html(t.name).text(),t.display="true",e.push(new n(t))),e},[]);return{categories:t}}},v.BUSINESS={selector:"#owBusinessFilters",template:Handlebars.templates.businessFiltersFacetTemplate,process:function(e){return{contractFilterFacet:e.contractFilterFacet,contractFilterFacetValue:e.contractFilterFacetValue,contractFilterFacetName:e.contractFilterFacetName,cpFilterSelected:e.cpFilterSelected}}},e.prototype.getFacetList=function(e,a){var o="undefined"!=typeof a?a:v.DEFAULT;return o===v.DEFAULT&&u&&(e.facets=e.facets.filter(r.bind(null,this.threshold))),new t(e,o)},e.DEFAULT=v.DEFAULT,e.CATEGORY=v.CATEGORY,e.BUSINESS=v.BUSINESS,t.prototype={get data(){return this._data},set data(e){this._data=this.process(e)}},t.prototype.render=function(){if("undefined"!=typeof this.type.template){var e=this.type.template(this.data);$(this.type.selector).replaceWith(e)}},t.prototype.process=function(e){return this.type.process.call(this,e)},o.prototype={get name(){return this.data.name},get values(){if(f&&!this._sorted){var e=new s(this).getComparator();this.data.values=this.data.values.sort(e.sort.bind(e)),this._sorted=!0}return this.data.values},set name(e){this.data.name=e},set values(e){this.data.values=e}},i.prototype={get count(){return this.data.count},get key(){return this.data.key},get name(){return this.data.name},set count(e){this.data.count=e},set key(e){this.data.key=e},set name(e){this.data.name=e}},n.prototype=Object.create(i.prototype,{url:{get:function(){return this.data.url},set:function(e){this.data.url=e}},display:{get:function(){return this.data.display},set:function(e){this.data.display=e}}}),n.prototype.constructor=n,s.LIST_NAME=0,s.LIST_DIRECTION=1,s.NUMERIC_DIRECTION=2,s.CHARACTER_DIRECTION=3,s.prototype={getListSorter:function(){if("undefined"!=typeof this.sortType){var e=this.getList(),t=this.getDirection(s.LIST_DIRECTION,1);if("undefined"!=typeof e)return new l(e,t)}},getAlphaNumericSorter:function(){var e=this.getDirection(s.NUMERIC_DIRECTION,-1),t=this.getDirection(s.CHARACTER_DIRECTION,1);return new d(e,t)},getComparator:function(){var e=this.getListSorter(),t=this.getAlphaNumericSorter(),r=[];return"undefined"!=typeof e&&r.push(e),r.push(t),new c(r,this.getFacetValue)},getList:function(){var e=this.sortType[s.LIST_NAME];return e="undefined"!=typeof e?e.trim():"",""!==e?m[e]:void 0},getDirection:function(e,t){var r="undefined"!=typeof this.sortType?this.sortType[e]:void 0;return"undefined"==typeof r?t:0>r?-1:1},getFacetValue:function(e){return e.value}},c.prototype={sort:function(e,t){var r=e,a=t;if("undefined"!=typeof this.compareValueFn)var r=this.compareValueFn(e),a=this.compareValueFn(t);for(var o=0,i=0;i<this.sorters.length&&0===o;i++)o=this.sorters[i].sort(r,a);return o}},l.prototype={sort:function(e,t){var r=e.trim().toUpperCase(),a=t.trim().toUpperCase(),o=this.getListMatch(r),i=this.getListMatch(a),n=this.orderArr.indexOf(o),s=this.orderArr.indexOf(i);return-1===n&&(id1=(this.orderArr.length+1)*this.directionalMultiplier),-1===s&&(id2=(this.orderArr.length+1)*this.directionalMultiplier),(n-s)*this.directionalMultiplier},loadArr:function(e){return e.map(function(e){return e.trim().toUpperCase()})},getListMatch:function(e){var t=this.listCaptureRegex.exec(e);return t?t[1]:t}},d.prototype={sort:function(e,t){var r=this.compareNA(e,t);if(0!==r)return r;var a=this.regex.exec(e),o=this.regex.exec(t);return r=this.numericCompare(a[1],o[1]),0===r&&(r=this.alphaCompare(a[2],o[2])),r},numericCompare:function(e,t){var r,a;return e&&(r=parseFloat(e)),t&&(a=parseFloat(t)),r===a?0:isNaN(r)?1:isNaN(a)?-1:(r-a)*this.numericDirectionalMultiplier},alphaCompare:function(e,t){var r=e.trim().toUpperCase(),a=t.trim().toUpperCase();return r===a?0:(a>r?-1:1)*this.characterDirectionalMultiplier},compareNA:function(e,t){var r="N/A",a="NA",o=e.trim().toUpperCase(),i=t.trim().toUpperCase();return o!=r&&o!=a||i!=r&&i!=a?o==r||o==a?1:i==r||i==a?-1:0:0}},e}(),ow.utils.wc.geocodeutil=function(){var e=function(){this.initialize=function(){},this.getEnhancedAddress=function(e){var t=parseInt(e);return isNaN(t)?e+=" australia":e>=800&&907>=e?e="australia+NT+"+e:t>=1e3&&2899>=t?e="australia+NSW+"+t:t>=2900&&2914>=t?e="australia+ACT+"+t:t>=3e3&&3996>=t||t>=8e3&&8873>=t?e="australia+VIC+"+t:t>=4e3&&4895>=t||t>=9e3&&9020>=t?e=4219==t?"west burleigh australia":"australia+QLD+"+t:t>=5e3&&5950>=t?e="australia+SA+"+t:t>=6e3&&6992>=t?e="australia+WA+"+t:t>=7e3&&7923>=t&&(e="australia+TAS+"+t),e},this.dogeocoding=function(e,t,r){var a=this,o={address:this.getEnhancedAddress(t),region:"au"};e.geocode(o,function(e,t){var o=[],i=[];t==google.maps.GeocoderStatus.OK?($.each(e,function(e,t){if(a.isAccceptedAddress(t.types)){var r={longitude:t.geometry.location.lng(),latitude:t.geometry.location.lat(),address:t.formatted_address,address_components:t.address_components};-1==$.inArray(r.address,i)&&(i.push(r.address),o.push(r))}}),r(o)):r(null)})},this.isAccceptedAddress=function(e){var t=["postal_code","locality","political","sublocality"],r=!1;return $.each(e,function(e,a){return $.inArray(a,t)>-1?void(r=!0):void 0}),r}};return e}(),ow.utils.globalvariablecache=function(){var e={};return e.orderedJsonStringify=function(e){return"object"==typeof e?JSON.stringify(Object.keys(e).sort().reduce(function(t,r){return t[r]=e[r],t},{})):e},e.get=function(e,t){return"undefined"==typeof ow.state.globalVariableCache&&(ow.state.globalVariableCache={}),"undefined"==typeof ow.state.globalVariableCache[e]&&(ow.state.globalVariableCache[e]={}),ow.state.globalVariableCache[e][this.orderedJsonStringify(t)]},e.remove=function(e,t){"undefined"!=typeof ow.state.globalVariableCache&&"undefined"!=typeof ow.state.globalVariableCache[e]&&delete ow.state.globalVariableCache[e][t]},e.put=function(e,t,r){"undefined"==typeof ow.state.globalVariableCache&&(ow.state.globalVariableCache={}),"undefined"==typeof ow.state.globalVariableCache[e]&&(ow.state.globalVariableCache[e]={}),ow.state.globalVariableCache[e][this.orderedJsonStringify(t)]=r},e.has=function(e,t){return"undefined"!=typeof this.get(e,t)},e.clear=function(e){"undefined"==typeof ow.state.globalVariableCache&&(ow.state.globalVariableCache={}),ow.state.globalVariableCache[e]={}},e.all=function(e){return"undefined"==typeof ow.state.globalVariableCache&&(ow.state.globalVariableCache={}),"undefined"==typeof ow.state.globalVariableCache[e]&&(ow.state.globalVariableCache[e]={}),ow.state.globalVariableCache[e]},e}(),ow.utils.wc.intelligentofferutil=function(){void 0!=ow.state&&void 0==ow.state.intelligentoffer&&(ow.state.intelligentoffer={}),ow.state.intelligentoffer.onPageCMRecCount=-1,ow.state.intelligentoffer.onPageCMRecReadyCount=-1;var e=Backbone.View.extend({initialize:function(){var e=0;window.checkCMRecReadyInterval=setInterval(function(){if(e++,ow.state.intelligentoffer.onPageCMRecReadyCount>0&&ow.state.intelligentoffer.onPageCMRecReadyCount==ow.state.intelligentoffer.onPageCMRecCount){try{cmDisplayRecs()}catch(t){}clearInterval(window.checkCMRecReadyInterval)}e>200&&clearInterval(window.checkCMRecReadyInterval)},50)}});return $(function(){}),e}(),ow.utils.messagemodal=function(){var e={};return e.show=function(e,t,r,a,o){var i=Handlebars.templates.messageModal,n=i({body:e,title:t,buttonName:r,rawBody:o}),s=$("#messageModal");s.length?s.replaceWith(n):$("body").append(n);var c=$("#messageModal");a&&c.one("hidden.bs.modal",a),c.modal("show")},e}(),ow.utils.wc.myaccountUtil=function(){var e=(ow.utils.wc.commonUtils,ow.utils.wc.owutils),t={};return t.retrieveAndSetMyAccountSideMenu=function(){if(void 0===ow.state||1!=ow.state.MyAccountSideMenuRetrieved){ow.state.MyAccountSideMenuRetrieved=!0;var t=$.Deferred();return 0==$("#myAccountSidebar li").length?(e.loader("show","#myAccountSidebar","ow-loading--top-aligned"),$.get(ow.url.customerSidebarURL).done(function(r){e.loader("hide","#myAccountSidebar"),r.activePage=ow.state.activeMyAccountPage;var a=Handlebars.templates.myAccountSideMenu,o=a(r);$("#myAccountSidebar").html(o),$(document).trigger("contentloaded"),t.resolve()}).error(function(){t.reject()})):t.reject(),t.promise()}},t.showDigitalDownload=function(){var t={};t.task="getAll",$.isEmptyObject(t)||$.ajax({method:"get",url:e.noCommentURL(ow.url.digitalDownloadCmdURL),data:t,timeout:5e4,success:function(e){void 0!=e&&void 0!=e.result&&e.result.count>0&&($("#my-software-downloads").show(),$("[data-isdonwload]").each(function(){$(this).show()}))}})},t}();var googleMapsCallback;ow.utils.wc.ondemandgmaputil=function(){var e=function(){this.initialize=function(){this.geocoder="",this.geocodeUtil=new ow.utils.wc.geocodeutil},this.geocodeAddress=function(e,t){var r=this;if(""==this.geocoder){var a=$.Deferred();googleMapsCallback=function(){a.resolve()},$.extend({loadGoogleMaps:function(){return $.ajax({url:"https://maps.googleapis.com/maps/api/js?v=3&client="+ow.state.googleMapClientKey+"&sensor=false&callback=googleMapsCallback",dataType:"script"}).fail(function(){a.reject}),a.promise()}}),$.loadGoogleMaps().done(function(){r.geocoder=new google.maps.Geocoder,r.dogeocoding(e,t)})}else this.dogeocoding(e,t)},this.dogeocoding=function(e,t){this.geocodeUtil.dogeocoding(this.geocoder,e,t)}};return e}(),ow.utils.wc.owaddressvalidateutil=function(){var e=ow.utils.wc.owutils,t=function(){this.initialize=function(){},this.checkPostcodeSuburbState=function(t,r,a){return $.ajax({type:"GET",url:e.noCommentURL(ow.url.absoluteURL+"OWAddressValidateCmd?postcode="+t+"&suburb="+r+"&state="+a)})},this.checkPostcodeSuburbStateInForm=function(t){this.form=void 0==t.address1&&void 0!=t.length&&t.length>0?t[0]:t;var r=$(this.form.zipCode).val(),a=$(this.form.city).val(),o=$(this.form.state).val();return $.ajax({type:"GET",url:e.noCommentURL(ow.url.absoluteURL+"OWAddressValidateCmd?postcode="+r+"&suburb="+a+"&state="+o)})},this.addressContainsPOBox=function(e){return e&&e.toUpperCase().match(/(p\.?\s?[o|0]\.?\s?b\.?([o|0]x)?|post\soffice\sbox)/gi)?!0:!1}};return t}();var isDebug=!1;if("undefined"==typeof isDebug||!isDebug)var emptyFunction=function(){},console={messages:emptyFunction,raw:emptyFunction,dump:emptyFunction,log:emptyFunction,debug:emptyFunction,warn:emptyFunction,info:emptyFunction,warn:emptyFunction,error:emptyFunction,assert:emptyFunction,clear:emptyFunction,dir:emptyFunction,dirxml:emptyFunction,trace:emptyFunction,group:emptyFunction,groupCollapsed:emptyFunction,groupEnd:emptyFunction,time:emptyFunction,timeEnd:emptyFunction,timeStamp:emptyFunction,profile:emptyFunction,profileEnd:emptyFunction,count:emptyFunction,exception:emptyFunction,table:emptyFunction};ow.controls.owordertemplatecontrol=function(){{var e=ow.utils.wc.owutils,t=ow.utils.wc.eventbus,r=(ow.controls.changestorecontrol,Backbone.View.extend({activeForm:null,events:{"click .addtotemplate-button":"addToTemplateClick","click .createnewtemplate-button":"addToTemplateClick","click .createTemplate":"createnewTemplate","click .dropdown-create-template":"addToTemplateClick","click .reqlist-dropdown-item":"addItemToTemplate","click .set-active-template":"activateTemplate","click .templateList-dropdown-toggle":"displayTemplateListDropDown","keypress input.input-template":"templateNameKeyupHandler"},initialize:function(){_.bindAll(this),t.on("initAddToMyList",this.initAddToMyList),"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),e.modals.addToListModal()},initAddToMyList:function(){var e=this,t=$(".addToMyList");ow.utils.wc.customerinfoutil.isLoggedIn(function(r){$.each(t,function(t,a){e.initAddToMyListItem(a,r)})})},initAddToMyListItem:function(e,t){var r=!t,a=Handlebars.templates.addToMyListTemplate,o=$(e).attr("data-catentryid"),i=$(e).data("partnumber"),n=$(e).data("productname"),s=$(e).data("dropup"),c=$('[data-cart="add"][data-catentryid="'+o+'"]').attr("data-channel");"STOREONLY"==c&&(r=!0);var l={isDropDownDisabled:r,productUniqueID:o,partNumber:i,productName:n,dropUp:s};$(e).replaceWith(a(l)),"STOREONLY"==c&&$('[data-template="add"][data-catentryid="'+o+'"]').attr("disabled","disabled")},showLoader:function(){},templateNameKeyupHandler:function(e){13==e.keyCode&&(e.preventDefault(),$("button.addtemplate").click())},navToLogin:function(e){var t=location.pathname+location.search;t=t.replace("#","");var r=$('form input[name="URL"]').val(),a=-1!=t.indexOf("UserRegistrationForm");0==a&&(r=r.replace("URL=officeworks","URL="+t));var o=ow.state.cachedHttpRequest+"LogonForm?"+$.param({URL:r,pageURLToReload:e?e:r,reLogonURL:"LogonForm",errorViewName:"AjaxOrderItemDisplayView",storeId:ow.state.storeId,catalogId:ow.state.catalogId,langId:ow.state.langId});window.location=o},createandaddProductToTemplate:function(e){var r=(e.currentTarget,this),a=$(r.activeForm).attr("data-partnumber"),o=$(r.activeForm).attr("data-prodId"),i=1,n=$("#quantity_"+o),i=1;n.length>0&&(i=$(n).val());var s=new Array,c=new Array,l=new Array;s[0]=o,c[0]=a,l[0]=i;var d=$.extend({},ow.state.orderItemAddBaseParams),u=$(r.activeForm).data("actiontype");if("copy"===u){var p=ow.state.currentOrderId;void 0==p&&(p=$("#copyTemplateButton").data("order_id")),d.orderId=p,d.action="copycreate"}else d.action="create"===u?"create":"addcreate";for(var f,f=0;f<c.length;f++)"undefined"==typeof c[f]||/^\s*$/.test(c[f])||(d["partNumber_"+(f+1)]=c[f],d["quantity_"+(f+1)]=l[f]);var h=$(r.activeForm).find(".input-template").val();d.reqListName=h;var m=$(r.activeForm).find("#isSharedList").is(":checked");d.isSharedList=m;var v=$.param(d,!0);r.postTemplateRequest(v,function(e){t.trigger("clearUserDataCache"),r.successfullyAddedCallback(e)})},createnewTemplate:function(e){e.preventDefault();var t=$(e.target).data("prodid"),r=$.extend({},ow.state.orderItemAddBaseParams),a=Handlebars.templates.createtemplate,o=r;o.catId=t,$("#addToListModal").html(a(o))},addToTemplateClick:function(e,t){var r=this;ow.utils.wc.customerinfoutil.isLoggedIn(function(a){a?ow.utils.wc.customerinfoutil.getUserData(function(t){"add"===$(e.currentTarget).data("template")&&void 0!=t.activeTemplateId&&t.activeTemplateId.length>0?r.addItemToTemplate(e):r.displayAddToNewTemplateModalForm(e)}):r.navToLogin(t)})},postTemplateRequest:function(t,r){$.ajax({type:"POST",url:e.noCommentURL(ow.url.orderTemplateURL),data:t,dataType:"json"}).done(r).error(function(e){"_ERR_INVALID_COOKIE"==e.responseJSON.errorMessageKey?location.href=ow.url.relogonFormURL:e&&e.responseJSON&&e.responseJSON.response&&e.responseJSON.response.status&&"FAILURE"===e.responseJSON.response.status?ow.utils.messagemodal.show("Could not add item to list.  Please check if this list is yours to modify.","Error","Close"):ow.utils.messagemodal.show("Server error.","Error","Close")}).always(function(){$("#loader, .ajax-loader-btn").hide("fast")})},displayAddToNewTemplateModalForm:function(e){{var t=this,r=e.currentTarget,a={templateAction:$(r).data("template"),catId:$(r).data("catentryid"),partNumber:$(r).data("partnumber"),productName:$(r).data("productname")},o=Handlebars.templates.createtemplate;$(r).data("catentryid")}$("#addToListModal .modal-content").html(o(a)),$("#addToListModal").modal("show").on("shown.bs.modal",function(){ow.breakpoints.isSmall()||$("[name=tmplName]").focus(),$(document).trigger("contentloaded")});for(var i=$(".create-template"),n=0;n<i.length;n++)$(i[n]).validate({rules:{tmplName:{required:!0}},messages:{tmplName:{required:"Please enter a name for your new list"}},showErrors:function(){this.defaultShowErrors(),$.each(this.successList,function(e,t){$(t).next("label.error").remove()})},onfocusout:!1,focusInvalid:!0,focusCleanup:!1,submitHandler:function(r){return t.activeForm=r,"copypreviousorder"===$(r).data("actiontype")?t.createTemplateFromOrderHistory(e):"copyprevorderfrmorderwl"===$(r).data("actiontype")?t.createTemplateFromOrderWorkList(e):t.createandaddProductToTemplate(e),!1}})},addItemToTemplate:function(e){var t=$(e.currentTarget),r=t.data("catentryid"),a=t.data("partnumber"),o=t.data("productname");r||(r=$(e.target).data("catentryid"));var i=$("#quantity_"+r),n=1;i.length>0&&(n=$(i).val());var s=new Array,c=new Array,l=new Array;s[0]=r,c[0]=a,l[0]=n;var d=$.extend({},ow.state.orderItemAddBaseParams),u=$(e.target).data("templateid"),p=this;ow.utils.wc.customerinfoutil.getUserData(function(e){if(void 0!=u)d.reqListId=u;else{var r=e.activeTemplateId;void 0!=r&&(d.reqListId=r)}d.action="add";for(var i,i=0;i<c.length;i++)"undefined"==typeof c[i]||/^\s*$/.test(c[i])||(d["partNumber_"+(i+1)]=c[i],d["quantity_"+(i+1)]=l[i]);$.publish("AddItemToReqList",{reqListId:u,partNumber:a,productName:o});var n=$.param(d,!0);p.postTemplateRequest(n,function(e){t.button("reset"),p.successfullyAddedCallback(e)})})},successfullyAddedCallback:function(e){if("create"===e.action[0])return t.trigger("clearUserDataCache"),void(window.location.href=ow.url.orderTemplateViewURL+"&orderId="+e.response.reqList.reqListId);var r=Handlebars.templates.productaddedtemplate,a=e.response.reqList;a.teplateviewurl=ow.url.orderTemplateViewURL,"copycreate"===e.action[0]&&(a.action="copycreate"),("addcreate"===e.action[0]||"add"===e.action[0])&&(a.action=e.response.reqList.addedCatentry.length>1?"addMultiple":"addSingle"),e.reqListName&&(e.reqListName=$("<textarea />").html(e.reqListName).val()),$("#addToListModal .modal-content").html(r(e.response.reqList)),$("#addToListModal").modal("show");var o=this;ow.utils.wc.customerinfoutil.getUserData(function(t){void 0==t.activeTemplateId&&"add"!==e.action[0]?o.postTemplateRequest({reqListId:e.response.reqList.reqListId,action:"activate"},function(){t.activeTemplateId=e.response.reqList.reqListId,ow.utils.wc.customerinfoutil.setUserData(t),o.loadTemplateList(function(){})}):("addcreate"===e.action[0]||"copycreate"===e.action[0])&&o.loadTemplateList(function(){})}),t.trigger("owSearchAddedToTemplate")},addOrderToTemplate:function(t){this.showLoader();$(t.target).data("templateid");ow.utils.wc.customerinfoutil.getUserData(function(r){var a=r.activeTemplateId,o=$.extend({},ow.state.orderItemAddBaseParams);o.reqListId=a,o.action="copy",o.orderId=ow.state.currentOrderId;{var i=$.param(o,!0);$(t.currentTarget).attr("id")}$.ajax({type:"POST",url:e.noCommentURL(ow.url.orderTemplateURL),data:i,dataType:"json"}).done(function(e){$("#loader").hide();var t=Handlebars.templates.productaddedtemplate;e.response.reqList.teplateviewurl=ow.url.orderTemplateViewURL,"copy"===o.action?(e.templateAction="copy",$("#addToListModal .modal-content").html(t(e.response.reqList)),$("#addToListModal").modal("show")):($("#addToListModal").html(t(e.response.reqList)),$("#addToListModal").modal("show"))}).always(function(){$("#loader").hide("fast")})})},activateTemplate:function(t){var r=$.extend({},ow.state.orderItemAddBaseParams),a=$(t.target).data("templateid");r.reqListId=a,r.action="activate";var o=this;$.ajax({type:"POST",url:e.noCommentURL(ow.url.orderTemplateURL),data:r,dataType:"json"}).done(function(){alert("template activated"),r.action="display";$.param(r,!0);o.retrieveTemplate(r)}).always(function(){$("#loader").hide("fast")})},retrieveTemplate:function(t){$.ajax({type:"POST",url:e.noCommentURL(ow.url.orderTemplateURL),data:t,dataType:"json"}).done(function(e){var r=Handlebars.templates.templateList;e.response.catId=t.id,e.response.templateAction=t.templateAction,$("#addToListModal").html("copy"===e.response.templateAction?r(e.response):r(e.response))}).always(function(){$("#loader").hide("fast")})},createTemplateFromOrderHistory:function(t){t.preventDefault(),$("#addToListModal").modal("hide"),this.showLoader();for(var r=ow.pages.myorderspage.data,a=$(this.activeForm).find(".input-template").val(),o={action:"addcreate",reqListName:a},i=0;i<r.items.length;i++)o["partNumber_"+(i+1)]=r.items[i].productId,o["quantity_"+(i+1)]=r.items[i].qty;$.post(e.noCommentURL(ow.url.orderTemplateURL),o).done(function(e){location.href=ow.url.orderTemplateViewURL+"&orderId="+e.response.reqList.reqListId}).fail(function(){var e="<div>No item available to be added to tempelate</div>";$("#addToListModal .modal-body").html(e),$("#addToListModal").modal("show")}).always(function(){$("#loader").hide()})},createTemplateFromOrderWorkList:function(t){t.preventDefault(),$("#addToListModal").modal("hide"),this.showLoader();for(var r=ow.pages.orderapprovaldetailpage.data,a=$(this.activeForm).find(".input-template").val(),o={action:"addcreate",reqListName:a},i=0;i<r.items.length;i++)o["partNumber_"+(i+1)]=r.items[i].partNumber,o["quantity_"+(i+1)]=r.items[i].qty;$.post(e.noCommentURL(ow.url.orderTemplateURL),o).done(function(e){location.href=ow.url.orderTemplateViewURL+"&orderId="+e.response.reqList.reqListId}).fail(function(){var e="<div>No item available to be added to tempelate</div>";$("#addToListModal .modal-body").html(e),$("#addToListModal").modal("show")}).always(function(){$("#loader").hide()})},loadTemplateList:function(t,r){var a=this;a.showLoader(),$.post(e.noCommentURL(ow.url.orderTemplateURL),{action:"display"}).done(function(e){a.templateList=e.response,t(r)}).always(function(){$("#loader").hide()})},templateList:{},displayTemplateListDropDown:function(e){$.isEmptyObject(this.templateList)?this.loadTemplateList(this.doDisplayTemplateListDropDown,e):this.doDisplayTemplateListDropDown(e)},doDisplayTemplateListDropDown:function(e){if(!$.isEmptyObject(this.templateList)){var t=$(e.currentTarget),r=Handlebars.templates.orderTemplateDropDownList;this.templateList.reqList.sort(function(e,t){return e.isactive===t.isactive?0:e.isactive?-1:1}),this.templateList.catentryid=$(t).data("catentryid"),this.templateList.partNumber=$(t).data("partnumber");var a=r(this.templateList);$("#templateList_dropdown_"+$(t).data("catentryid")).html(a)}}}));new r({el:$(document)})}return r}(),ow.utils.wc.passwordstrength=function(){function e(e,t,r){var a=this,o=$("<span>").css({display:"inline-block",position:"relative",verticalAlign:"bottom",width:"0"}).height(e.outerHeight()).insertAfter(e);this.field=e,this.className=t,this.toggleClass=r,this.toggle=$("<a>").addClass(this.className).on("mousedown",function(){a.toggle.addClass(a.toggleClass),a.field.attr("type","text")}).on("mouseup mouseleave",function(){a.toggle.removeClass(a.toggleClass),a.field.attr("type","password")}).appendTo(o),this.calculatePosition()}var t=function(e,t){this.level=0,this.segments=t,this.defaultMessage="<em>Note: Password must contain; Min. 6 characters, 1 alphabet and 1 number.</em>",this.container=$("<div>").addClass("strength-rating"),this.bar=$("<div>").addClass("strength-bar"),this.message=$("<div>").addClass("strength-message").html(this.defaultMessage),this.levels={unsecure:"Unsecure Password",low:"Low Password",medium:"Medium Password",high:"Strong Password"};for(var r=0;r<this.segments;r++)$("<div>").addClass("segment").css({width:100/this.segments+"%"}).appendTo(this.bar);
this.bar.appendTo(this.container),this.message.appendTo(this.container),this.container.appendTo(e)};return t.prototype.getStrengthLevel=function(e){var t=Object.keys(this.levels);return t[Math.round(e/this.segments*t.length)-1]},t.prototype.getIcon=function(e){var t=this.getStrengthLevel(e);return t?'<span class="status-icon">'+("unsecure"===t?"&times;":"&#10003;")+"</span>":""},t.prototype.getMessage=function(e){var t=this.getStrengthLevel(e);return t?this.levels[t]:""},t.prototype.getErrors=function(e){var t=this.hasRepeatedCharacters(e,4),r=/\d/.test(e),a=/[a-zA-Z]/.test(e),o=e.length<6,i=[],n=/^(.)\1{2}/.test(e),s=/^(\?|\!)/.test(e);return a||i.push("Your password does not contain an alphabetic character."),r||i.push("Your password does not contain a numeric character."),o&&i.push("Your password must be at least 6 characters long."),t&&i.push("You cannot use the same character 4 or more times."),n&&i.push("Your password must not have the same letters on first three characters"),s&&i.push("Your password must not start with '?' or '!' "),i},t.prototype.hasRepeatedCharacters=function(e,t){for(var r={},a=!1,o=0;o<e.length;o++){var i=e.charAt(o);if(r[i]=("undefined"==typeof r[i]?0:r[i])+1,r[i]===t){a=!0;break}}return a},t.prototype.scorePassword=function(e){var t=1,r={},a=[],o=0;if(e){if(a=this.getErrors(e),a.length)return this.setLevel(t),a;for(var i=0;i<e.length;i++)r[e[i]]="undefined"!=typeof r[e[i]]?r[e[i]]+.01:.15,t+=r[e[i]];$.each({digits:/\d/.test(e),upper:/[A-Z]/.test(e),nonWords:/\W/.test(e)},function(e,t){o+=t===!0?1:0}),t+=.1*(o-1)}return t=Math.min(Math.round(t),this.segments),this.setLevel(t),a},t.prototype.setLevel=function(e){var t=this.getStrengthLevel(e);this.container.removeClass(this.getStrengthLevel(this.level)).addClass(t),this.message.html(t?this.getIcon(e)+this.getMessage(e):this.defaultMessage),this.bar.find(".segment").removeClass("filled").slice(0,e).addClass("filled"),this.level=e,"undefined"==typeof ow.state.passwordstrength&&(ow.state.passwordstrength={}),ow.state.passwordstrength.level=e},e.prototype.calculatePosition=function(){var e=(this.toggle.outerWidth(!0)-this.toggle.width())/2;this.field.css({paddingRight:this.toggle.outerWidth(!0)}),this.toggle.css({position:"absolute",top:"50%",marginTop:-1*Math.round(this.toggle.height()/2),marginLeft:-1*(this.toggle.width()+e)})},$(function(){$("[data-password-strength]").each(function(){var r,a,o,i=$(this),n=$(i.attr("data-password-strength"));n.length&&(n.addClass("strength-checked"),r=new e(n,"password-toggle","show"),n.on("keyup blur",function(){var e=n.val();a.scorePassword(e),o&&(n.popover("hide"),o=!1)}),n.on("focus",function(){a||(a=new t(i,4))}),n.on("blur",function(){var e,t=n.val(),r='<span class="status-icon">&times;</span>';e=a.scorePassword(t),e.length>0?(passwordUpdateDiv=$("#passwordUpdateError"),o||(n.popover("destroy").popover({trigger:"manual",html:!0,placement:"right",container:".passwordStrengthContainer",content:'<strong>Correct the following before you can continue.</strong><div class="errors">'+r+e.slice(0,2).join("<br>"+r)+"</div>"}).popover("show").addClass("error"),o=!0)):n.removeClass("error")}))})}),t}(),ow.utils.wc.productselectorutil=function(){var e=ow.utils.wc.eventbus,t=function(){this.searchQuery=null,this.queryParams={},this.initialize=function(){_.bindAll(this)},this.loadProducts=function(e,t){var r=ow.url.absoluteURL+"ProductSelectorSearchResultView";this.queryParams.searchTerm="",this.queryParams.beginIndex=t,this.queryParams.pageSize=e,this.queryParams.physicalStoreId=$.cookie("PREFERRED_STORE_ID"),this.queryParams.storeId=ow.state.storeId,this.queryParams.catalogId=ow.state.catalogId,this.queryParams.orderBy=3,$.ajax({type:"get",url:r,contentType:"text/plain",data:this.queryParams,context:this,xhrFields:{withCredentials:!1},dataType:"text",success:this.processResponse,error:function(){},traditional:!0}),this.queryParams={}},this.processResponse=function(e){e=e.replace(/<!--[\s\S]*?-->/g,""),this.processProducts(JSON.parse(e))},this.processProducts=function(t){var r=[];ow.state.productData={};for(var a=0;a<t.CatalogEntryView.length;a++){var o={};o.name=t.CatalogEntryView[a].name,o.description=$("<div/>").html(t.CatalogEntryView[a].longDescription).text(),o.sku=t.CatalogEntryView[a].partNumber,void 0!=t.Inventory[a].price&&(o.price=t.Inventory[a].price),o.smallImage=t.CatalogEntryItemView[a].smallImage,o.mediumImage=t.CatalogEntryItemView[a].mediumImage,o.largeImage=t.CatalogEntryItemView[a].largeImage,o.catentryid=t.CatalogEntryView[a].uniqueID,o.inventory=t.Inventory[a],r.push(o),void 0==o.inventory.store&&(o.inventory.store="nostore");var i=0,n=5;$.each(t.CatalogEntryView[a].userData.userDataField,function(){"Rating_Range"==this.key?n=this.value:"Rating"==this.key&&(i=this.value)}),o.rating=i/n*100}r.sort(this.compareProducts),ow.state.productData.metaData=t.MetaData,ow.state.productData.metaData.totalCount=t.totalCount,ow.state.productData.products=r,e.trigger("productsLoaded")},this.compareProducts=function(e,t){return parseFloat(e.price)<parseFloat(t.price)?-1:parseFloat(e.price)>parseFloat(t.price)?1:0},this.getFilterParam=function(e){if("mainFilter"==e.type&&("facet"==e.target?(null==this.queryParams[e.target]&&(this.queryParams[e.target]=[]),this.queryParams[e.target].push(e.value)):this.queryParams[e.target]=e.value),"select"==e.type){var t=$("#"+e.name).find(":selected").val();""!=t&&("facet"==e.target?(null==this.queryParams[e.target]&&(this.queryParams[e.target]=[]),this.queryParams[e.target].push(t)):this.queryParams[e.target]=t)}if("priceSelect"==e.type){var r=JSON.parse($("#"+e.name).find(":selected").val());null!=r.maxPrice&&(this.queryParams.maxPrice=r.maxPrice),null!=r.minPrice&&(this.queryParams.minPrice=r.minPrice)}if("tabs"==e.type){var a=e.name,t=$("#"+e.name+" a.selected").data("value");this.queryParams[a]=t}"price"==e.type&&($("#slider-range").slider("option","disabled")||(r=$("#slider-range").slider("values"),this.queryParams.minPrice=r[0],this.queryParams.maxPrice=r[1]))},this.filterInit=function(t){"price"==t.type?($("#slider-range").slider({range:!0,disabled:!0,stop:function(){e.trigger("priceFilter")},slide:function(e,t){$(".sliderContainer .values").text("$"+t.values[0]+" - $"+t.values[1])},animate:"fast"}),$(".sliderContainer .values").text("$"+$("#slider-range").slider("values",0)+" - $"+$("#slider-range").slider("values",1))):"tabs"==t.type&&void 0!=t.defaultOption&&$("#"+t.name+' a[data-value="'+t.defaultOption+'"]').addClass("selected")},this.enableFilter=function(e){"price"==e.type&&1==$("#slider-range").slider("option","disabled")&&($("#slider-range").slider("option","disabled",!1),$("#slider-range").slider("option","max",parseFloat(ow.state.productData.metaData.maxPriceInResults)),$("#slider-range").slider("option","min",parseFloat(ow.state.productData.metaData.minPriceInResults)),$("#slider-range").slider("option","values",[parseFloat(ow.state.productData.metaData.minPriceInResults),parseFloat(ow.state.productData.metaData.maxPriceInResults)]),$(".sliderContainer .values").text("$"+$("#slider-range").slider("values",0)+" - $"+$("#slider-range").slider("values",1)))},this.pauseFilter=function(e){"price"==e.type&&$("#slider-range").slider("option","disabled",!0)},this.filterSelect=function(t,r){"tabs"==t.type&&($("#"+t.name+" a").removeClass("selected"),$("#"+t.name+' a[data-id="'+r+'"]').addClass("selected"),e.trigger("recsTrigger",$("#"+t.name+' a[data-id="'+r+'"]').data("id"))),("select"==t.type||"priceSelect"==t.type)&&$("#"+t.name).find('option[data-id="'+r+'"]').attr("selected",!0)},this.filterHashValue=function(e){return"tabs"==e.type?$("#"+e.name+" a.selected").data("id"):"select"==e.type||"priceSelect"==e.type?$("#"+e.name).find(":selected").data("id"):void 0}};return t}(),ow.utils.wc.productsubutilsapi=function(){var e=(ow.utils.wc.owutils,ow.utils.wc.commonUtils),t=ow.utils.globalvariablecache,r=(ow.utils.wc.inventory,{});return r.productSubDisplayStatuses=["outofstock","backorder","backorder_partial","unavailable"],r.resetAllDisplayedSubstitutionsFor=function(){$("[id^=productSub_]").html("")},r.prodSubInventoryCheck=function(r){var a=$.Deferred(),o=this,i={},n="",s=function(){var e=t.all("productSubCache");return _.map(_.values(e),function(e){return e.substituteProductId})},c=function(r){try{var a=r;if("undefined"!=typeof a&&$.each(a,function(e,r){r=ow.utils.wc.inventory.updatemessaging(r,!0),t.put("substitutesInventoryCache",r.partNumber,r)}),o.populateSubstitutesWithInventory(i),r){var c={productId:s().join(",")};return e.ajaxGet(n,c,l)}return l()}catch(d){}},l=function(e){var r=$.Deferred();try{var a=$.cookie("OW_PRICE_FETCH")||ow.state.customPriceFetchEnabled;e=a&&e&&e.prices?e.prices:e,e&&$.each(e,function(e,r){t.put("priceCache",r.productId,r)}),o.populateSubstitutesWithPrice(i).done(function(){o.displayProductSubstitutions(i),r.resolve()}).fail(function(){r.reject()})}catch(n){r.reject()}return r.promise()};return"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(s){try{var l=r.filter(function(e){return!t.has("substitutesInventoryCache",e)});if($.each(t.all("productSubCache"),function(e,t){i[t.substituteProductId]?i[t.substituteProductId].push(t):(i[t.substituteProductId]=[],i[t.substituteProductId].push(t))}),l.length>0){var d=ow.utils.wc.inventory,u=d.getInventoryCheckURL(s,l);n=o.getPriceCheckURL(s),e.ajaxGetJSON(u,"",c).done(function(){a.resolve()}).fail(function(){a.reject()})}else c().done(function(){a.resolve()}).fail(function(){a.reject()})}catch(p){console.log(p)}}),a.promise()},r.populateSubstitutesWithInventory=function(e){$.each(e,function(e,r){$.each(r,function(e,r){var a=t.get("substitutesInventoryCache",r.substitutePartNumber),o=$("div").data("noStock_"+r.productId);r.substitutionMessage=o?o.availableQty>0?"backorder"===o.online||"backorder_partial"===o.online?ow.state.productSubNotEnoughQtyBackorderMessage:ow.state.productSubNotEnoughQtyRegularMessage:"backorder"===o.online||"backorder_partial"===o.online?ow.state.productSubOOSBackorderMessage:ow.state.productSubOOSRegularMessage:ow.state.productSubOOSRegularMessage,o&&(r.parentProductId=o.parentProductId,r.online=a.online,r.deliveryTitle=a.deliveryTitle,r.deliveryMsg=$("<textarea />").html(a.deliveryMsg).val(),r.store=a.store,r.storeMsg=a.storeMsg,r.isSubstituteInShoppingCart=a.isSubstituteInShoppingCart,r.checkstoresmessage=a.checkstoresmessage,r.clickcollect=a.clickcollect,r.clickAndCollectMsg=$("<textarea />").html(a.clickAndCollectMsg).val(),r.channel=a.channel,r.allowaddtocart=a.allowaddtocart,r.storetitle=a.storetitle,r.introMessage=o.introMessage?$("<div/>").html(o.introMessage+" "+a.deliveryMsg.replace("Dispatched","dispatched")+" or "+a.clickAndCollectMsg.replace("Collect","collected from store")+".").text():"")})})},r.populateSubstitutesWithPrice=function(e){var r=[],a=$.map(t.all("productSubCache"),function(e){return e.substituteProductId}),o=_.pick(t.all("priceCache"),a);return $.each(o,function(t,a){e[a.productId]&&$.each(e[a.productId],function(e,t){var o=$.Deferred();r.push(o),"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getDisplayGSTExclusive(function(e){e?(t.price=a.priceExcludeTax,t.priceRange=a.priceRangeExclTax,t.displayGSTExclusiveFlag=e):(t.price=a.price,t.priceRange=a.priceRange),o.resolve()}),t.hasContractPrice=a.hasContractPrice})}),$.when.apply($,r)},r.displayProductSubstitutions=function(e){var t=this,r=Handlebars.templates["product-substitution"];$.each(e,function(e,a){$.each(a,function(e,a){if("instock"===a.online){a.uniqueID=a.substituteProductId,a.isSubstitute=!0,a.isSubstituteInShoppingCart=!!ow.state.ShoppingCart,a.compact="compact"===$("#productSub_"+a.parentProductId).data("size")?!0:!1;var o=$("#productSub_"+a.parentProductId);o.html(r(a)),o.hasClass("hidden")&&o.removeClass("hidden");var i=$("#substituteProductModal");i.attr("data-prodsubcontent",a.substituteProductId),$("div").data("priceRange_s_"+a.parentProductId+"_"+a.substituteProductId,t.transformPriceRange(a.priceRange,"s_"+a.parentProductId+"_"+a.substituteProductId)),$('[data-price="default"]').css("display","inline-block"),a.displayGSTExclusiveFlag&&$(".gst.excl-gst-msg-display").show()}})}),$(document).trigger("contentloaded")},r.transformPriceRange=function(e,t){if(e){for(var r=[],a=0;a<e.length;a++){var o=e[a],i={},n=o.minimumQuantity;n&&(n=Number(n));var s=o.maximumQuantity;s&&(s=Number(s)),i.minQty=n,i.maxQty=s,i.price=o.value.value,i.catentryid=t,r.push(i)}return r}},r.updateProductSubDetails=function(r){var a=$.Deferred();if(ow.url.productSubEnabled)try{var o=this,i=r.productId.split(","),n=t.all("outOfStockProduct"),s=i.filter(function(e){return!_.has(n,e)}),c=({productId:s.join(",")},o.getProductSubtitutionURL());s.length>0?($.each(s,function(e,r){t.put("outOfStockProduct",r,"")}),e.ajaxGetJSON(c,r,o.handleFetchSubstituteProductsResponse).done(function(){a.resolve()}).fail(function(){a.reject()})):o.handleFetchSubstituteProductsResponse().done(function(){a.resolve()}).fail(function(){a.reject()})}catch(l){a.reject()}else a.resolve();return a.promise()},r.handleFetchSubstituteProductsResponse=function(e){var a=$.Deferred(),o=[];e&&$.each(e,function(e,r){if("true"===r.replacementProductExists&&null!=r.substituteProductId){var a=$('[data-id="'+r.productId+'"]'),o=$(a).data("partnumber");r.parentPartNumber=o,$("#productSub_"+r.productId).attr("data-partnumber",r.substitutePartNumber),t.put("productSubCache",r.productId,r)}});var i=t.all("productSubCache");return $.each(i,function(e,t){o.indexOf(t.substitutePartNumber)<0&&o.push(t.substitutePartNumber)}),o.length>0?r.prodSubInventoryCheck(o).done(function(){a.resolve()}).fail(function(){a.reject()}):a.resolve(),a.promise()},r.getInventoryCheckURL=function(e,t){ow.state.isRegistered="R"===e.userType,ow.state.isThirtyDayAcnt=e.thirtyDayAccountEnabled;var r=$.cookie("FFMCenter");if(r){var a=[];$.each(t,function(e,t){a.push(t+"|1")}),-1!=r.indexOf(",")&&(r=r.replace(",","-"),$.cookie("FFMCenter",r,{path:"/"}));var o=r.split("-")[0],i=r.split("-")[1],n=ow.state.cachedHttpRequest+"GetInventory?storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId+"&ffmcenterId="+o+"&storeffmcenterId="+i+"&nc=true&iscartPage=false&catentryId="+a.join(",")+"&usertypecachebust="+ow.state.isRegistered+"-"+ow.state.isThirtyDayAcnt;return n}},r.getProductSubtitutionURL=function(){var e=$.cookie("PREFERRED_STORE_ID")||"",t=ow.url.absoluteURL+"OfficeworksSA/Api/ProductSubstitutions.jsp?storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId+"&physicalStoreId="+e;return t},r.getPriceCheckURL=function(e){var t=$.cookie("PREFERRED_STORE_ID")||"",r=$.cookie("OW_PRICE_FETCH")||ow.state.customPriceFetchEnabled;if("undefined"!=typeof e&&"BUSINESS"===e.customerType){var a=ow.url.absoluteURL+(r?"OWGetPriceBusiness?":"OWPriceViewBusiness?");a+="business=true&"}else var a=ow.url.absoluteURL+(r?"OWGetPrice?":"OWPriceView?");return a=a+"storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId+"&physicalStoreId="+t},r.removeFromCacheIfExists=function(e){t.remove("productSubCache",e)},r}(),ow.utils.wc.productsubutils=function(){var e="accurate"===$.cookie("OW_AVAILABILITY")||ow.state.isAvailabilityApiEnabled;if(e)return ow.utils.wc.productsubutilsapi;var t=(ow.utils.wc.owutils,ow.utils.wc.commonUtils),r=ow.utils.globalvariablecache,a={};return a.productSubDisplayStatuses=["outofstock","backorder","backorder_partial","unavailable"],a.resetAllDisplayedSubstitutionsFor=function(){$("[id^=productSub_]").html("")},a.prodSubInventoryCheck=function(e){var a=$.Deferred(),o=this,i={},n="",s={productId:e.join(",")},c=function(e){try{return"undefined"!=typeof e&&"undefined"!=typeof e.inventory&&$.each(e.inventory,function(e,t){ow.utils.wc.inventory.updatemessaging(t),r.put("inventoryCache",e,t)}),o.populateSubstitutesWithInventory(i),e?t.ajaxPost(n,s,l):l()}catch(a){}},l=function(e){var t=$.Deferred();try{var a=$.cookie("OW_PRICE_FETCH")||ow.state.customPriceFetchEnabled;e=a&&e&&e.prices?e.prices:e,e&&$.each(e,function(e,t){r.put("priceCache",t.productId,t)}),o.populateSubstitutesWithPrice(i).done(function(){o.displayProductSubstitutions(i),t.resolve()}).fail(function(){t.reject()})}catch(n){t.reject()}return t.promise()};return"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(s){try{var l=e.filter(function(e){return!r.has("inventoryCache",e)});if($.each(r.all("productSubCache"),function(e,t){i[t.substituteProductId]?i[t.substituteProductId].push(t):(i[t.substituteProductId]=[],i[t.substituteProductId].push(t))}),l.length>0){var d=o.getInventoryCheckURL(s,l);n=o.getPriceCheckURL(s),t.ajaxGetJSON(d,"",c).done(function(){a.resolve()}).fail(function(){a.reject()})}else c().done(function(){a.resolve()}).fail(function(){a.reject()})}catch(u){}}),a.promise()},a.populateSubstitutesWithInventory=function(e){var t=$.map(e,function(e,t){return r.get("inventoryCache",t)});$.each(t,function(t,r){e[r.productId]&&$.each(e[r.productId],function(e,t){var a=$("div").data("noStock_"+t.productId);t.substitutionMessage=a?a.availableQty>0?"backorder"===a.online?ow.state.productSubNotEnoughQtyBackorderMessage:ow.state.productSubNotEnoughQtyRegularMessage:"backorder"===a.online?ow.state.productSubOOSBackorderMessage:ow.state.productSubOOSRegularMessage:ow.state.productSubOOSRegularMessage,a&&(t.parentProductId=a.parentProductId,t.online=r.online,t.deliveryTitle=r.deliveryTitle,t.deliveryMsg=$("<textarea />").html(r.deliveryMsg).val(),t.store=r.store,t.clickcollect=r.clickcollect,t.clickAndCollectMsg=$("<textarea />").html(r.clickAndCollectMsg).val(),t.channel=r.channel,t.allowaddtocart=r.allowaddtocart,t.storetitle=r.storetitle,t.shipfromstore=r.shipfromstore,t.introMessage=a.introMessage?$("<div/>").html(a.introMessage+" "+r.deliveryMsg.replace("Dispatched","dispatched")+" or "+r.clickAndCollectMsg.replace("Collect","collected from store")+".").text():"")})})},a.populateSubstitutesWithPrice=function(e){var t=[],a=$.map(r.all("productSubCache"),function(e){return e.substituteProductId}),o=_.pick(r.all("priceCache"),a);return $.each(o,function(r,a){e[a.productId]&&$.each(e[a.productId],function(e,r){var o=$.Deferred();t.push(o),"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getDisplayGSTExclusive(function(e){e?(r.price=a.priceExcludeTax,r.priceRange=a.priceRangeExclTax,r.displayGSTExclusiveFlag=e):(r.price=a.price,r.priceRange=a.priceRange),o.resolve()}),r.hasContractPrice=a.hasContractPrice})}),$.when.apply($,t)},a.displayProductSubstitutions=function(e){var t=this,r=Handlebars.templates["product-substitution"];$.each(e,function(e,a){$.each(a,function(e,a){if("instock"===a.online){a.uniqueID=a.substituteProductId,a.isSubstitute=!0,a.isSubstituteInShoppingCart=!!ow.state.ShoppingCart,a.compact="compact"===$("#productSub_"+a.parentProductId).data("size")?!0:!1;var o=$("#productSub_"+a.parentProductId);o.html(r(a)),o.hasClass("hidden")&&o.removeClass("hidden");var i=$("#substituteProductModal");i.attr("data-prodsubcontent",a.substituteProductId),$("div").data("priceRange_s_"+a.parentProductId+"_"+a.substituteProductId,t.transformPriceRange(a.priceRange,"s_"+a.parentProductId+"_"+a.substituteProductId)),$('[data-price="default"]').css("display","inline-block"),a.displayGSTExclusiveFlag&&$(".gst.excl-gst-msg-display").show()}})}),$(document).trigger("contentloaded")},a.transformPriceRange=function(e,t){if(e){for(var r=[],a=0;a<e.length;a++){var o=e[a],i={},n=o.minimumQuantity;n&&(n=Number(n));var s=o.maximumQuantity;s&&(s=Number(s)),i.minQty=n,i.maxQty=s,i.price=o.value.value,i.catentryid=t,r.push(i)}return r}},a.updateProductSubDetails=function(e){var a=$.Deferred();if(ow.url.productSubEnabled)try{var o=this,i=e.productId.split(","),n=r.all("outOfStockProduct"),s=i.filter(function(e){return!_.has(n,e)}),c=({productId:s.join(",")},o.getProductSubtitutionURL());s.length>0?($.each(s,function(e,t){r.put("outOfStockProduct",t,"")}),t.ajaxGetJSON(c,e,o.handleFetchSubstituteProductsResponse).done(function(){a.resolve()}).fail(function(){a.reject()})):o.handleFetchSubstituteProductsResponse().done(function(){a.resolve()}).fail(function(){a.reject()})}catch(l){a.reject()}else a.resolve();return a.promise()},a.handleFetchSubstituteProductsResponse=function(e){var t=$.Deferred(),o=[];e&&$.each(e,function(e,t){"true"===t.replacementProductExists&&null!=t.substituteProductId&&r.put("productSubCache",t.productId,t)});var i=r.all("productSubCache");return $.each(i,function(e,t){o.push(t.substituteProductId)}),o.length>0?a.prodSubInventoryCheck(o).done(function(){t.resolve()}).fail(function(){t.reject()}):t.resolve(),t.promise()},a.getInventoryCheckURL=function(e,t){ow.state.isRegistered="R"===e.userType,ow.state.isThirtyDayAcnt=e.thirtyDayAccountEnabled;var r=$.cookie("FFMCenter");if(r){var a=[];$.each(t,function(e,t){a.push(t+"|1")}),-1!=r.indexOf(",")&&(r=r.replace(",","-"),$.cookie("FFMCenter",r,{path:"/"}));var o=r.split("-")[0],i=r.split("-")[1],n=ow.state.cachedHttpRequest+"GetInventory?storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId+"&ffmcenterId="+o+"&storeffmcenterId="+i+"&nc=true&iscartPage=false&catentryId="+a.join(",")+"&usertypecachebust="+ow.state.isRegistered+"-"+ow.state.isThirtyDayAcnt;return n}},a.getProductSubtitutionURL=function(){var e=$.cookie("PREFERRED_STORE_ID")||"",t=ow.url.absoluteURL+"OfficeworksSA/Api/ProductSubstitutions.jsp?storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId+"&physicalStoreId="+e;return t},a.getPriceCheckURL=function(e){var t=($.cookie("PREFERRED_STORE_ID")||"",$.cookie("OW_PRICE_FETCH")||ow.state.customPriceFetchEnabled);if("undefined"!=typeof e&&"BUSINESS"===e.customerType){var r=ow.url.absoluteURL+(t?"OWGetPriceBusiness?":"OWPriceViewBusiness?");r+="business=true&"}else var r=ow.url.absoluteURL+(t?"OWGetPrice?":"OWPriceView?");return r=r+"storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId},a.removeFromCacheIfExists=function(e){r.remove("productSubCache",e)},a}(),ow.utils.richrelevance=function(){function e(){this.recsDeferred=$.Deferred(),this.recsDeferredPromise=this.recsDeferred.promise()}function t(e){this.el=e,this.identifier=e.data("identifier")}function r(){ow.state.richRelevanceEnabled&&!s&&(s=new e,s.init())}function a(e){var r;e.data("_"+p.PAGE_CONF_SELECTORS)instanceof t||(r=new t(e),r.register(s),e.data("_"+p.PAGE_CONF_SELECTORS,r),e.trigger("componentloaded",[p.PAGE_CONF_SELECTORS,r]))}function o(e){try{return e(this)}catch(t){console.error("RichRelevance Error:",new Error(t))}}function i(e){this.el=$(e),this.clickThroughUrl=e.data(p.CLICK_THRU),this.url=e.attr("href")}function n(){$("[data-"+p.PAGE_PLACEMENT_SELECTORS+"]").each(function(){var e=$(this);s&&a(e)}),$("[data-"+p.CLICK_THRU+"]").each(function(){var e=$(this);if(!(e.data("_"+p.CLICK_THRU)instanceof i)){var t=new i(e);t.bind(),e.data("_"+p.CLICK_THRU,t)}})}var s,c=ow.utils.wc.customerinfoutil,l=$.Deferred(),d=(l.promise(),$.Deferred());$(document).ready(function(){d.resolve("ready")});var u={RECS_LOADED:"RR_RECOMENDATIONS",NOTIFY_USER_INFO:"RR_USER_INFO",NOTIFY_PAGE_CONFIG:"RR_PAGE_CONFIG"},p={PAGE_CONF_SELECTORS:"rr-page-config",PAGE_PLACEMENT_SELECTORS:"rr-placement",CLICK_THRU:"rr-click-thru"};e.prototype={init:function(){this.loadRecommendationsConfig(),this.notifyUserInfo()},registerPlacement:function(e){return this.recsDeferredPromise.then(this.filterRecsForPlacement.bind(this,e.identifier))},setRecommendations:function(e){this.recsDeferred.resolve(e)},notifyPageRecConfig:function(e){$.when(d).then(function(){$.publish(u.NOTIFY_PAGE_CONFIG,e)})},notifyUserInfo:function(){$.when(c.promiseUserData(),d).then(function(e){$.publish(u.NOTIFY_USER_INFO,e)})},filterRecsForPlacement:function(e,t){var r;return t.placements&&(r=t.placements.filter(function(t){return t.placementId===e})[0]),r?$.Deferred().resolve(r):$.Deferred().reject({err:"Placements not configured.",identifier:e})},loadRecommendationsConfig:function(){var e={emsName:"recommendations_page_config",template:"OWContentDisplayNoDiv"};$.ajax({context:this,type:"GET",url:ow.url.dynamicEspotURL,data:e,success:function(e){var t=$(e).text();if(t&&""!==t.trim()){var r=JSON.parse(t.trim());this.notifyPageRecConfig(r)}else this.recsDeferred.reject("No Recs Configured")}.bind(this),error:function(){this.recsDeferred.reject("Err retrieving Recs Configuration")}})}},t.prototype={register:function(e){e.registerPlacement(this).done(this.render.bind(this)).fail(this.failed.bind(this))},render:function(e){if("recommend"===ow.state.richRelevanceMode.toLowerCase()||"recommend"===$.cookie("owRichRelevanceMode")){var t=e.items.filter(function(e){var t=owPageContext&&owPageContext.product&&owPageContext.product.partNumber?owPageContext.product.partNumber:"";return e.partNumber!==t}).map(function(e){return e.partNumber}),r=e.placement_name.split(".").join("_");this.el.attr("id",r);var a={SKUs:t.join(","),targetDivId:r,templateName:e.template,espotTitle:e.message};e.numOfProductsPerSlide&&(a.numOfProductsPerSlide=e.numOfProductsPerSlide);var o=ow.controls.productCarouselControl;o.initialiseCarousel(a).then(o.getProductData.bind(o,a.targetDivId)).then(function(e,t){if(t&&t.products){var r=t.products.map(function(t){var r=e.items.filter(function(e,t){return e.partNumber===t.partNumber}.bind(void 0,t)).map(function(e){return e.linkURL})[0];return t.rrClickThruUrl=r,t}),i={products:r};o.renderCarousel(i,a.targetDivId)}}.bind(this,e))}},failed:function(){}},i.prototype={bind:function(){this.el.click(this.execute.bind(this)),this.el.on("contextmenu",this.openContextMenu.bind(this)),this.el.blur(this.closeContextMenu.bind(this))},openContextMenu:function(){this.el.attr("href",this.clickThroughUrl)},closeContextMenu:function(){this.el.attr("href",this.url)},execute:function(){$.publish("RecommendationClickThrough",{url:this.clickThroughUrl})}},$(document).on(u.RECS_LOADED,function(e,t){o(s.setRecommendations.bind(s,t))}),$(document).on("espotLoaded",n),$(document).on("contentloaded",n),$(function(){n()}),r()}(),ow.utils.wc.store=function(){var e=ow.utils.wc.owutils,t={};return t.isGoogleBotSession=function(){return null!==navigator.userAgent.match(/googlebot/i)||null!==navigator.userAgent.match(/adsbot/i)||null!==navigator.userAgent.match(/yandexbot/i)?!0:!1},t.isLocationSet=function(){return"true"===$.cookie("LOCATION_IDENTIFIED")},t.getStore=function(){var e=$.cookie("PREFERRED_STORE");if(e)try{return JSON.parse(e)}catch(t){return null}else try{return JSON.parse(ow.utils.localStorageUtil.sessionStorage("PREFERRED_STORE"))}catch(t){return null}},t.setStore=function(r,a){if(!this.isGoogleBotSession()){var o=e.noCommentURL(ow.url.setPreferredStoreCmdURL+"&stid="+r);$.ajax({type:"GET",url:o,success:function(e){var r=e.nearestStore;t.setStoreDataAmplify(r),a(r)}})}},t.setStoreAndDeliverLocation=function(r,a,o,i){if(!this.isGoogleBotSession()){var n=e.noCommentURL(ow.url.setPreferredStoreCmdURL+"&stid="+r+"&deliverSuburb="+o+"&deliverPostcode="+a);$.ajax({type:"GET",url:n,success:function(e){var r=e.nearestStore;t.setStoreDataAmplify(r),"function"==typeof i&&i(r)}})}},t.findNearestStore=function(r){if(!this.isGoogleBotSession()){var a=e.getUrlParameter("ip"),o=e.getUrlParameter("lat"),i=e.getUrlParameter("long"),n={};n.ip=a||null,n.lat=o||null,n["long"]=i||null;var s=e.appendParams(ow.url.ajaxDefaultStoreLocatorResolveCmd,n);$.ajax({type:"GET",url:s,success:function(e){var a=e.nearestStore;t.setStoreDataAmplify(a),r(a)}})}},t.reloadStore=function(r){if(!this.isGoogleBotSession()){var a={};a.reload="true";var o=e.appendParams(ow.url.ajaxDefaultStoreLocatorResolveCmd,a);$.get(o).always(function(e){var a=e.nearestStore;t.setStoreDataAmplify(a),r&&r(a)})}},t.setStoreDataAmplify=function(e){console.debug("Setting data to Ampilfy storage");var t=JSON.stringify(e);ow.utils.localStorageUtil.sessionStorage("PREFERRED_STORE",t),ow.utils.localStorageUtil.sessionStorage("LOCATION_IDENTIFIED","true")},t}(),ow.utils.wc.availability=function(){var e="accurate"===$.cookie("OW_AVAILABILITY")||ow.state.isAvailabilityApiEnabled;if(e){var t=ow.utils.wc.eventbus,r=ow.utils.wc.owutils,a=ow.utils.wc.commonUtils,o=ow.utils.wc.productsubutils,i=(ow.utils.wc.store,["DIGITAL_DOWNLOAD"]),n=["pbs"],s={};return $(document).ready(function(){r.modals.storeModal(),s.getTodaysDate()}),s.isSearchPage=!1,s.isDigital=function(e,t){return"undefined"!=typeof $(t).data("producttype")&&($.inArray($(t).data("producttype"),i)>=0||"GENERAL_SERVICE"===$(t).data("producttype")&&$.inArray($(t).data("productsubtype"),n)>=0)},s.prepareInventoryDetailsForProdSub=function(e){var t={};t.parentProductId=e.productId,t.online=e.online,t.deliveryTitle=e.deliveryTitle,t.availableQty=e.stockQty,t.backOrderQty=e.backOrderQty,t.deliveryMsg=e.deliveryMsg,t.introMessage=e.introMessage,$("div").data("noStock_"+e.productId,t),ow.utils.globalvariablecache.has("inventoryCache",e.productId)||ow.utils.globalvariablecache.put("inventoryCache",e.productId,e)},s.update=function(){var e=$.Deferred(),t=$.Deferred(),r=$.Deferred(),a=$.Deferred(),o=[],i=[],n=$("[data-inventory]").filter(function(e,t){return!(ow.utils.globalvariablecache.has("inventoryCache",$(t).data("id"))&&ow.utils.globalvariablecache.has("priceCache",$(t).data("id")))});n=$(n).filter(function(e,t){return!$(t).data("shellproduct")}),n.length>0&&n.each(function(){var e=$(this).data("id"),t=$(this).data("partnumber");s.isMailmanPYO(t)&&(t=s.getMailmanCorrespondingPartNumber(t));$("#quantity_"+e).val();o.indexOf(t)<0&&(o.push(t),i.push(e))});var c=$("[data-addonprice]");c.length>0&&c.each(function(){var e=$(this).data("id"),t=$(this).data("partnumber");s.isMailmanPYO(t)&&(t=s.getMailmanCorrespondingPartNumber(t)),o.indexOf(t)<0&&(o.push(t),i.push(e))});var l=$("[data-addon-id]");if(l.length>0&&l.each(function(){var e=$(this).data("addon-id"),t=$(this).data("partnumber");s.isMailmanPYO(t)&&(t=s.getMailmanCorrespondingPartNumber(t)),o.indexOf(t)<0&&(o.push(t),i.push(e))}),o.length>0){for(var d=[],u=[],p=100;o.length>0;)d.push(o.splice(0,p)),u.push(i.splice(0,p));for(var f=[],h=d.length,m=0;h>m;m++){var v=d[m];f.push(s.loadbatch(v,u[m]))}$.when.apply($,f).done(function(){e.resolve(),t.resolve(),r.resolve(),a.resolve()}).fail(function(){e.reject(),t.reject(),r.reject(),a.reject()})}else{s.updateInventoryWithResponse();var g=[],y=$("[data-inventory]").filter(function(e,t){return!s.isDigital(e,t)});y.length>0&&y.each(function(){var e=$(this).data("id");g.push(e)}),"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(t){s.checkRestrictedRange(t,null,{partNumbersOrderedQty:null,catentryIds:g}).done(function(){e.resolve()}).fail(function(){e.reject()})});var b=function(){s.checkProductSubstitutes().done(function(){r.resolve()}).fail(function(){r.reject()})},w=s.getShellProductCatentryIds(),I=s.getDigitalCatentryIds();I=$.merge(w,I),I.length>0?ow.utils.wc.customerinfoutil.getUserData(function(e){s.fetchPrices(e,I).always(function(){s.updatePriceWithResponse().done(function(){t.resolve()}).fail(function(){t.reject()}).always(b)})}):s.updatePriceWithResponse().done(function(){t.resolve()}).fail(function(){t.reject()}).always(b)}return $(document).ready(function(){$("[data-inventory]").filter(function(e,t){return s.isDigital(e,t)}).each(function(e,t){var r={productType:$(t).data("producttype"),productSubType:$(t).data("productsubtype")};s.applyAvailabilityMessages(t,r)}),$(document).trigger("contentloaded"),a.resolve()}),s.showClickAndCollectStoreForPrintAndCopy(),$.when(e,t,r,a)},s.getDigitalCatentryIds=function(){return $("[data-inventory]").filter(function(e,t){return s.isDigital(e,t)}).map(function(e,t){return $(t).data("id")
})},s.getShellProductCatentryIds=function(){return $("[data-inventory]").filter(function(e,t){return $(t).data("shellproduct")}).map(function(e,t){return $(t).data("id")})},s.updateSingle=function(e){var t=[],r=[];t.push(e+"|1"),isNaN(e)||(r.push(parseInt(e)),s.executeFunctionAfterCheckingRestrictedRange(s.loadbatch,{partNumbersOrderedQty:t,catentryIds:r}))},s.executeCheckRestrictedRangeAfterLoadBatch=function(e,t){return s.loadbatch(e,t)},s.executeFunctionAfterCheckingRestrictedRange=function(e,t){"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(r){s.checkRestrictedRange(r,e,t)})},s.loadbatch=function(e,t){var r=this,i=$.Deferred();return"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),r.batchCatentryIds=t,ow.utils.wc.customerinfoutil.getUserData(function(n){var c=s.getInventoryCheckURL(n,e);o.resetAllDisplayedSubstitutionsFor(),s.noStockList||(s.noStockList=[]);var l=$.Deferred();e.length>0?s.inventoryCallPromise=a.ajaxGetJSON(c,"",function(t){s.updateInventoryWithResponse(e,t),s.checkRestrictedRange(n,null,{partNumbersOrderedQty:e,catentryIds:r.batchCatentryIds}).done(function(){l.resolve()}).fail(function(){l.reject()})},function(r,a){s.inventoryCallFailureResponseHandler(r,a,e,t),l.reject()}):(s.updateInventoryWithResponse(),s.checkRestrictedRange(n,null,{partNumbersOrderedQty:e,catentryIds:t}).done(function(){l.resolve()}).fail(function(){l.reject()}));var d=s.getDigitalCatentryIds();t=$.merge(d,t);var u=s.getShellProductCatentryIds();s.pricePromise=s.fetchPrices(n,$.merge(u,t)),s.showClickAndCollectStoreForPrintAndCopy(),$.when(s.pricePromise,l).done(function(){i.resolve()}).fail(function(){i.reject()})}),i.promise()},s.inventoryCallFailureResponseHandler=function(e,t,r,a){var o=Handlebars.templates.defaultAvailability,i=$.cookie("OW_STORE_POSTCODE")||"3000",n=$.cookie("OW_STORE_NAME")||"W301",c={postcode:i,ffc:n,store:n,partNumbers:r},l=o(c);s.updateInventoryWithResponse(a,JSON.parse(l)),s.showInventoryAndAddToCartButton(),$.publish("InventoryFailedToUpdate")},s.fetchPrices=function(e,t){if(t.length){var r=s.getPriceCheckURL(e),o={productId:$.map(t,function(e){return e.toString()}).join(",")},i=function(){$('[data-price="default"]').css("display","inline-block")};return a.ajaxGet(r,o,s.updatePriceWithResponse,i)}return $.Deferred(function(e){s.updatePriceWithResponse().done(function(){e.resolve()}).fail(function(){e.reject()})}).promise()},s.checkProductSubstitutes=function(){var e=$.Deferred();if(s.noStockList&&s.noStockList.length>0){s.noStockList=_.uniq(s.noStockList);var t={productId:s.noStockList.join(",")};o.updateProductSubDetails(t).done(function(){e.resolve()}).fail(function(){e.reject()})}else e.resolve();return e.promise()},s.checkRestrictedRangeWithoutProductSub=function(e,t,r){s.checkRestrictedRange(e,t,r,!0)},s.checkRestrictedRange=function(e,t,r,a){var o=$.Deferred();return"R"===e.userType&&"BUSINESS"===e.customerType&&!0===e.restrictedRangeActive?s.fetchRestrictedRange(e,r,a).done(function(){s.renderRestrictedRange(t,r,a).done(function(){o.resolve()}).fail(function(){o.reject()})}):("undefined"!=typeof a&&a||s.checkProductSubstitutes(),o.resolve()),o.promise()},s.fetchRestrictedRange=function(e,t){var a=$.Deferred(),o=[];for(var i in t.catentryIds){var n=t.catentryIds[i];ow.utils.globalvariablecache.has("restrictedRangeCache",n)||o.push(n)}return o.length>0?$.ajax({method:"POST",url:r.noCommentURL(ow.url.absoluteURL+"ValidateRestrictedRange?action=CR&catentryIds="+o),complete:function(e){var t=e.responseJSON;if("undefined"!=typeof t)if("undefined"!=typeof t.status&&"SUCCESS"===t.status)for(var r in o){var i=o[r],e={type:0,productId:i};ow.utils.globalvariablecache.put("restrictedRangeCache",i,e)}else if("undefined"!=typeof t.response)for(var r in o){var i=o[r],e=t.response[i];"undefined"==typeof e&&(e={type:0,productId:i}),ow.utils.globalvariablecache.put("restrictedRangeCache",i,e)}a.resolve()},error:function(){a.reject()}}):a.resolve(),a.promise()},s.renderRestrictedRange=function(e,t,r){var a=$.Deferred(),o=[],i=ow.utils.globalvariablecache.all("restrictedRangeCache");return $.each(i,function(e,t){"undefined"!=typeof t&&$('[data-catentryid="'+t.productId+'"]').length>0&&(2==t.type?!$('[data-price="default"][data-id="'+t.productId+'"]').find(".icon-ow-contractprice").length>0&&($('.ow-product-panel[data-catentryid="'+t.productId+'"]').addClass("is-restricted"),$('.ow-product-tile[data-catentryid="'+t.productId+'"]').addClass("is-restricted"),$('.ow-product-details[data-catentryid="'+t.productId+'"]').addClass("is-restricted"),$('.ow-add-to-cart[data-catentryid="'+t.productId+'"] :parent').popover({html:!0,content:"Your Administrator has requested that you be prevented from purchasing this product.",trigger:"hover",placement:"bottom",container:"body"}),$('.ow-add-to-cart[data-catentryid="'+t.productId+'"]').attr("disabled","disabled"),$('.ow-add-to-cart[data-catentryid="'+t.productId+'"] [title]').html("Restricted Item")):1==t.type&&($('.ow-product-panel[data-catentryid="'+t.productId+'"]').addClass("is-restricted"),$('.ow-product-tile[data-catentryid="'+t.productId+'"]').addClass("is-restricted"),$('.ow-product-details[data-catentryid="'+t.productId+'"]').addClass("is-restricted"),$('.ow-add-to-cart[data-catentryid="'+t.productId+'"] :parent').popover({html:!0,content:"Your Administrator has requested that you be prevented from purchasing this product.",trigger:"hover",placement:"bottom",container:"body"}),$('.ow-add-to-cart[data-catentryid="'+t.productId+'"]').attr("disabled","disabled"),$('.ow-add-to-cart[data-catentryid="'+t.productId+'"] [title]').html("Restricted Item")),o.push(t.productId))}),"function"==typeof e&&e(t.partNumbersOrderedQty,t.catentryIds),s.showInventoryAndAddToCartButton(),$.each(o,function(e,t){s.noStockList=jQuery.grep(s.noStockList,function(e){return e!=t})}),"undefined"!=typeof r&&r?a.resolve():"undefined"!=typeof s.inventoryCallPromise&&"undefined"!=typeof s.pricePromise?$.when(s.inventoryCallPromise,s.pricePromise).done(function(){s.checkProductSubstitutes().done(function(){a.resolve()}).fail(function(){a.reject()})}):s.checkProductSubstitutes().done(function(){a.resolve()}).fail(function(){a.reject()}),a.promise()},s.showClickAndCollectStoreForPrintAndCopy=function(){$(".printandcopy-click-and-collect").length&&$(".printandcopy-click-and-collect").html(s.getDefaultStoreTitle)},s.showInventoryAndAddToCartButton=function(){$('[data-cart="add"]').css("display","block"),s.isBrowseAvailabilityPreferencesEnabled()||$("[data-inventory]").filter("div [data-always-hidden!='true']").css("display","block"),r.modals.availabilityModal(),$(".add-to-cart").show().promise().done(function(){t.trigger("initAddToMyList")})},s.getInventoryCheckURL=function(e,t){ow.state.isRegistered="R"===e.userType,ow.state.isThirtyDayAcnt=e.thirtyDayAccountEnabled;var r=$.cookie("FFMCenter");if(r){var a=!1;$("#checkout").length>0&&(a=!0),-1!=r.indexOf(",")&&(r=r.replace(",","-"),$.cookie("FFMCenter",r,{path:"/"}));var o=r.split("-")[0],i=r.split("-")[1];if(a)var n=ow.state.cachedHttpRequest+"GetInventoryCheckOut?storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId+"&ffmcenterId="+o+"&storeffmcenterId="+i+"&iscartPage="+a+"&nc=true&catentryId="+catentryIds.join(",")+"&usertypecachebust="+ow.state.isRegistered+"-"+ow.state.isThirtyDayAcnt;else{var c=$.cookie("OW_STORE_POSTCODE")||"3000",l=$.cookie("OW_STORE_NAME")||"W301";s.isBrowseAvailabilityPreferencesEnabled()&&(c=$.cookie("OW_DELIVER_POSTCODE")||"3000",l=$.cookie("OW_STORE_NAME")||"W311");var n=ow.url.apiAvailabilityUrl+"/store/"+l+"/deliver/"+c+"?partNumber="+t.join("|");ow.state.isThirtyDayAcnt&&(n+="&demandType=30DY")}return n}},s.getPriceCheckURL=function(e){var t=$.cookie("PREFERRED_STORE_ID")||"",r=$.cookie("OW_PRICE_FETCH")||ow.state.customPriceFetchEnabled;if("undefined"!=typeof e&&"BUSINESS"===e.customerType){var a=ow.url.absoluteURL+(r?"OWGetPriceBusiness?":"OWPriceViewBusiness?");a+="business=true&"}else var a=ow.url.absoluteURL+(r?"OWGetPrice?":"OWPriceView?");return a=a+"storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId+"&physicalStoreId="+t},s.getArrayFromResponse=function(e){var t;return"string"==typeof e&&(t=JSON.parse(e)),"object"==typeof e&&(t=e),t},s.updatePriceWithResponse=function(e){var a=Handlebars.templates.price,o=$.Deferred(),i=[],n=$.cookie("OW_PRICE_FETCH")||ow.state.customPriceFetchEnabled;if(e=n&&e&&e.prices?e.prices:e)for(var c=0;c<e.length;c++){var l=e[c];l&&l.productId&&(ow.utils.globalvariablecache.has("priceCache",l.productId)||ow.utils.globalvariablecache.put("priceCache",l.productId,l))}"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(e){var n=$('[data-price="default"]');for(var c in ow.utils.globalvariablecache.all("priceCache")){var l=ow.utils.globalvariablecache.get("priceCache",c);n.filter('[data-id="'+l.productId+'"]').each(function(t,r){if("undefined"!=typeof l.price){var o=$.extend({displayGSTExclusiveFlag:e.displayGSTExclusive,hideContractPriceIndicator:e.hideContractPriceIndicator},l);$(r).html(a(o))}else $(r).html("N/A"),$('[data-cart="add"][data-id="'+l.productId+'"]').attr("disabled","disabled"),$('[data-cart="add"][data-catentryid="'+l.productId+'"]').attr("disabled","disabled");0==$(r).closest(".ow-price").find(".excl-gst-msg-display").length&&$(r).closest(".ow-price").append('<small class="gst text-muted excl-gst-msg-display" style="display: none;">excl. GST</small>'),l.hasContractPrice&&!e.hideContractPriceIndicator&&$(r).closest(".ow-price").addClass("ow-price--contract-price")});var d=($(".price[data-id="+l.productId+"]"),$("#add-to-cart_"+l.productId)),u=$("#add-to-cart_"+l.productId).closest(".ow_bulk_buy"),p=$("#BulkbuyFindOutMore_"+l.productId);if(l.bulkbuy){if(d.length>0){var f=$.Deferred();i.push(f),s.updateBulkbuyDisplay(l,u).done(function(){f.resolve()}).fail(function(){f.reject()})}}else $(".ow-bulk-buy").filter('[data-id="'+l.productId+'"]').empty(),p.hide();0!==$("#unit-price-display").length&&"undefined"!=typeof l.price&&(e.displayGSTExclusive?s.updateUnitPriceDisplay($("#unit-price-display"),l.priceExcludeTax,l.productId):s.updateUnitPriceDisplay($("#unit-price-display"),l.price,l.productId))}e.displayGSTExclusive?$(".excl-gst-msg-display").show():$(".excl-gst-msg-display").hide(),t.trigger("price:update"),o.resolve(),r.loader("hide",".ow-product-panel__actions, .ow-product-tile__inner")});var d=[];return d.push(o),d.push.apply(d,i),t.trigger("price:loaded"),$.when.apply($,d)},s.updateUnitPriceDisplay=function(e,t,r){var a=window.navigator.userAgent,o=a.indexOf("MSIE "),i={};o>0?(i.productid=e.attr("data-productid"),i.totalunit=e.attr("data-totalunit"),i.unitmeasure=e.attr("data-unitmeasure"),i.perunitdisplaysuffix="undefined"!=typeof e.attr("data-perunitdisplaysuffix")&&"undefined"!=typeof e.attr("data-unitmeasure")?e.attr("data-perunitdisplaysuffix").replace("(s)",1==e.attr("data-unitmeasure")?"":"s"):e.attr("data-perunitdisplaysuffix")):i=e.data();var n=i.productid,s=t;if("undefined"!=typeof n&&"undefined"!=typeof r&&n==r){var c=parseFloat(i.totalunit),l=i.unitmeasure,d=i.perunitdisplaysuffix,u=Number(s.replace(/[^0-9\.]+/g,""));if(c>0){var p=u*l/c;p=Math.round(p*Math.pow(10,2))/Math.pow(10,2);var f="$"+p+" "+d;e.text(f),e.show()}}},s.applyAvailabilityMessages=function(e,t){var a=$(e).data("inventory")||"default",o=($(e).data("producttype")||"default",$(e).data("hideavailability"));if(t.platformLogos=$(e).data("platformlogos")||!1,t.isOnProductListPage=$("#productList").length>0,t.allowaddtocart?$(".product[data-catentryid="+t.productId+"] .ow-dinkus.Ribbon_Preorder").show():$(".product[data-catentryid="+t.productId+"] .ow-dinkus.Ribbon_Preorder").hide(),o)return void r.loader("hide",e);var i=Handlebars.templates["inventory-"+a];"undefined"!=typeof i&&$(e).html(i(t)),r.loader("hide",e)},s.updateInventoryWithResponse=function(e,r){var a=this,i=$("[data-inventory]");r&&e&&_.each(r,function(e){var t=e.partNumber;0===$('[data-partnumber="'+t+'"][data-inventory]').length&&s.isMailman(t)&&!s.isMailmanPYO(t)&&(t=s.getMailmanCorrespondingPartNumber(t));var r=$('div[data-partnumber="'+t+'"][data-inventory]').data("id");ow.utils.globalvariablecache.put("inventoryCache",r,e)});var n=ow.utils.globalvariablecache.all("inventoryCache");$.each(n,function(e,r){s.getTodaysDate(function(e){if(r=s.updatemessaging(r)){s.noStockList||(s.noStockList=[]);var n=r.partNumber;0===$('[data-partnumber="'+n+'"][data-inventory]').length&&s.isMailman(n)&&!s.isMailmanPYO(n)&&(n=s.getMailmanCorrespondingPartNumber(n)),r.hideinventory||(i.filter('[data-partnumber="'+n+'"][data-inventory]').each(function(e,t){s.applyAvailabilityMessages(t,r)}),t.trigger("refreshstoreavailabilityfrom"));var c=r.productId;if($.inArray(r.online,o.productSubDisplayStatuses)>-1){var l=jQuery.inArray(c,s.noStockList);0>l&&s.noStockList.push(c),s.prepareInventoryDetailsForProdSub(r)}var d=$('[data-cart="add"][data-catentryid="'+c+'"]'),u=$('.ow-quantity[data-catentryid="'+c+'"]'),p="undefined"!=typeof ow.state.ordertemplatepage&&ow.state.ordertemplatepage,f=void 0!=d.attr("disabled"),h=d.find("span").text(),m=void 0!=h&&null!=h.match(/restricted/i);if(!f&&!m)if(p||r.allowaddtocart){var v;v="DONATION"==r.productType?"DONATE":r.thirdParty?"Customise":a.isPreorderProduct(r,e)?"Preorder: add to cart":"Add to Cart",d.removeAttr("disabled").find("span").text(v),u.show()}else{var v="Unavailable Online";a.isPreorderProduct(r,e)&&(v="Preorder: unavailable"),d.prop("disabled","disabled").attr("data-channel",r.channel).find("span").text(v),u.hide()}}})}),(new ow.controls.shellproductcontrol).loadShellProductAvailability(),$("#cartContainer").length>0&&($(".product").each(function(){$(this).find("div.deliver-to-door").length>0&&"outofstock"==$(this).find("div.deliver-to-door").attr("class").split(" ")[2]&&($(this).addClass("unavailable"),$(this).find(".price.total").removeClass("price total").addClass("text-error").html("Temporarily <br/> out of stock")),$(this).find("div.deliver-to-door").length>0&&"unavailable"==$(this).find("div.deliver-to-door").attr("class").split(" ")[2]&&($(this).addClass("unavailable"),$(this).find(".quantity-control").remove(),$(this).find(".price.total").removeClass("price total").addClass("text-error").html("Temporarily <br/> unavailable"))}),$(".product.unavailable").length>0&&$("html,body").stop().animate({scrollTop:$(".product.unavailable").first().offset().top-30},"swing")),s.showInventoryAndAddToCartButton(),$(document).trigger("contentloaded"),$.publish("InventoryUpdated")},s.isPreorderProduct=function(e,t){if(e.isPreorderProduct&&"string"==typeof e.preorderReleaseDate){var r=e.preorderReleaseDate.split("-"),a=new Date(r[0],r[1]-1,r[2]);if(a>t)return!0}return!1},s.updateBulkbuyDisplay=function(e,t){var r=$.Deferred(),a=ow.utils.localStorageUtil.sessionStorage("options"),i=a.pageView;return"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getDisplayGSTExclusive(function(a){if(bulkPriceRange=a?e.priceRangeExclTax:e.priceRange,!(t.find(".ow-bulk-buy").size()>0)){$("div").data("priceRange_"+e.productId,o.transformPriceRange(bulkPriceRange,e.productId)),e.bulkPriceRange=bulkPriceRange.slice(1);var n=Handlebars.templates.bulkBuyTemplate;"list"==i&&(e["class"]="ow-bulk-buy--narrow",$("#ow_bulk_buy_"+e.productId).replaceWith(n(e))),$(".bulkbuys-table").filter('[data-id="'+e.productId+'"]').html(n(e)),r.resolve()}}),r.promise()},s.formatCurrency=function(e){return parseFloat(e,10).toFixed(2)},s.getyourstore=function(){var e=ow.utils.localStorageUtil.sessionStorage("PREFERRED_STORE");if(!$.isEmptyObject(e))try{return JSON.parse(e)}catch(t){return{}}},s.getDefaultStoreTitle=function(){var e=s.getyourstore();return e&&e.name?(e.name=e.name.replace(/%2C/g,","),e.name.replace("Officeworks","")):void 0},s.isNextBusinessDay=function(e,t){if(("true"===$.cookie("OW_DCOT_AVAILABILITY_ENABLED")||ow.state.dcotAvailabilityEnabled===!0)&&e.deliveryOption)return"STD_NEXT_DAY"===e.deliveryOption;var r=new Date(e.availableDate);r.setHours(0,0,0,0);var a=new Date(t.getTime());return a.setHours(0,0,0,0),a.setDate(5===a.getDay()?a.getDate()+3:6===a.getDay()?a.getDate()+2:a.getDate()+1),r>t&&a>=r},s.getOnlineTitle=function(e,t){var r="";if(("true"===$.cookie("OW_DCOT_AVAILABILITY_ENABLED")||ow.state.dcotAvailabilityEnabled===!0)&&e&&e.deliveryOption&&"STD_NEXT_DAY"===e.deliveryOption&&(r="Next business day delivery"),""===r&&e&&e.availableDate){var a=new Date(e.availableDate);a.setHours(0,0,0,0);var o=new Date(t.getTime());o.setDate(5===o.getDay()?o.getDate()+3:6===o.getDay()?o.getDate()+2:o.getDate()+1);var i=new Date(t.getTime());i.setDate(o.getDate()+7),r=o>=a?"Next business day delivery":a>o&&i>=a?"Delivery":"Extended delivery"}return r},s.getOnlineMsg=function(e){var t=e&&e.deliveryDate?"Estimated "+(s.isBrowseAvailabilityPreferencesEnabled()?"":"delivery ")+"on "+e.deliveryDate:"";return"STOREONLY"==e.channel?(t=s.isBrowseAvailabilityPreferencesEnabled()?$("#productList").length>0?"Delivery not available":"Delivery not available to:":"Only Available In Store",e.online="outofstock"):"outofstock"==e.online&&(t="outofstock"!=e.store?"Try your nearest Officeworks store":"Out of stock"),t},s.isAllowQuickCollect=function(e){var t="true"===$.cookie("OW_QUICK_COLLECT_MSG_ENABLED")||ow.state.isQuickCollectEnabled;return t&&e.isQuickCollectAvailable&&"outofstock"!=e.store&&e.storeQty>=ow.state.quickCollectThreshold},s.getCollectMsg=function(e){var t=e&&e.collectDate?"Estimated collection on "+e.collectDate:" ";return this.isAllowQuickCollect(e)&&(t="Estimated collection in 2 hours"),"STOREONLY"==e.channel?(t="Not available to Click &amp; Collect",e.clickcollect="outofstock"):"outofstock"==e.clickcollect&&(t="Not available to Click &amp; Collect"),t},s.getStoreMsg=function(e){var t="Available in store <mark>NOW</mark>";return"ONLINEONLY"==e.channel?(t="Only available online",e.store="outofstock"):"limitedstock"==e.store?(t="Call to confirm",this.isBrowseAvailabilityPreferencesEnabled()&&(t="Limited stock in store")):"outofstock"==e.store&&(t="Out of stock in store"),t},s.getAvailabilityStatus=function(e,t,r){if("ONLINEONLY"===r&&"inStore"===e)return"outofstock";if("STOREONLY"===r&&"inStore"!==e)return"outofstock";var a=ow.state.limitedStockLimit;return"undefined"==typeof a&&(a=5),t>a?"instock":t>0?s.isBrowseAvailabilityPreferencesEnabled()&&"clickAndCollect"===e?"limitedstock":"inStore"===e?"limitedstock":"instock":"outofstock"},s.isMailmanPYO=function(e){return"undefined"==typeof ow.state.mailmanPyoPartNumbers?!1:ow.state.mailmanPyoPartNumbers.indexOf(e)>=0},s.getMailmanCatEntryId=function(e){return"undefined"==typeof ow.state.mailmanPartNumberToCatEntryIdMap?null:ow.state.mailmanPartNumberToCatEntryIdMap[e]},s.isMailman=function(e){return"undefined"!=typeof ow.state.mailmanPartNumberMap&&"undefined"!=typeof ow.state.mailmanPartNumberMap[e]},s.getMailmanCorrespondingPartNumber=function(e){return"undefined"==typeof ow.state.mailmanPartNumberMap||"undefined"==typeof ow.state.mailmanPartNumberMap[e]?e:ow.state.mailmanPartNumberMap[e]},s.isBrowseAvailabilityPreferencesEnabled=function(){return"true"===$.cookie("OW_BROWSE_AVAILABILITY_PREFERENCES")||ow.state.browseAvailabilityPreferencesEnabled},s.isAllBrowseAvailabilityPreferencesSet=function(){return!("undefined"==typeof $.cookie("OW_DELIVER_POSTCODE")||"undefined"==typeof $.cookie("OW_DELIVER_SUBURB")||"undefined"==typeof $.cookie("LOCATION_IDENTIFIED"))},s.updatemessaging=function(e,t){var r=this,a=this.getDefaultStoreTitle(),o=$('[data-partnumber="'+e.partNumber+'"][data-inventory]');if(0===o.length)if(s.isMailman(e.partNumber))s.isMailmanPYO(e.partNumber)||(o=$('[data-partnumber="'+s.getMailmanCorrespondingPartNumber(e.partNumber)+'"][data-inventory]'));else if(!t)return null;var i={digitalcontent:!1,partNumber:e.partNumber,productId:$(o).data("id"),storetitle:a,allowaddtocart:!0,channel:$(o).data("channel"),isAlwaysAvailable:$(o).data("isalwaysavailable"),shippingModeId:$(o).data("shippingmodeid"),productType:$(o).data("producttype"),productSubType:$(o).data("productsubtype"),online:$(o).data("isalwaysavailable")?"instock":"outofstock",deliveryDate:"",clickcollect:"outofstock",collectDate:"",store:"outofstock",shipfromstore:"",hideAvailabilityMsg:!1,isPreorderProduct:$(o).data("isPreorderProduct"),preorderReleaseDate:$(o).data("preorderReleaseDate")};r.isSearchPage&&i.isPreorderProduct&&(i.hideAvailabilityMsg=!0);var n=!1;e.options&&e.options.length>0?$.each(e.options,function(e,t){s.getTodaysDate(function(e){"deliverToDoor"===t.type?(i.online=r.getAvailabilityStatus(t.type,t.qty,i.channel),"outofstock"!==i.online&&(i.deliveryTitle=s.getOnlineTitle(t,e)),n=s.isNextBusinessDay(t,e),i.hideDeliveryMsg=n,i.deliveryDate=t&&t.availableDate?$.datepicker.formatDate("DD, MM d, yy",new Date(t.availableDate)):"","STOREONLY"!==i.channel&&"true"===t.isShipFromStore&&(i.shipfromstore="shipfromstore",s.isBrowseAvailabilityPreferencesEnabled()&&(i.hideDeliveryMsg=!1))):"clickAndCollect"===t.type?(i.clickcollect=r.getAvailabilityStatus(t.type,t.qty,i.channel),i.collectDate=t&&t.availableDate?$.datepicker.formatDate("DD, MM d, yy",new Date(t.availableDate)):"",i.isQuickCollectAvailable=t.isQuickCollectAvailable?t.isQuickCollectAvailable:!1):"inStore"===t.type&&(i.store=r.getAvailabilityStatus(t.type,t.qty,i.channel),i.storeQty=t.qty)})}):(i.online=r.getAvailabilityStatus("deliverToDoor",0,null),i.clickcollect=r.getAvailabilityStatus("clickAndCollect",0,null),i.store=r.getAvailabilityStatus("inStore",0,null)),"outofstock"===i.online&&(i.clickcollect="outofstock"),i.deliveryMsg=s.getOnlineMsg(i),i.clickAndCollectMsg=s.getCollectMsg(i),i.storeMsg=s.getStoreMsg(i),i.shipfromstore.length>0&&(i.deliveryMsg=s.isBrowseAvailabilityPreferencesEnabled()?n?"Local Delivery":"Local Delivery, "+i.deliveryMsg.slice(0,1).toLowerCase()+i.deliveryMsg.slice(1):i.deliveryMsg+" <span>Local Delivery</span>"),"outofstock"===i.online&&"outofstock"===i.clickcollect&&(i.allowaddtocart=!1),i.deliveryMsg||(i.hideAvailabilityMsg=!0);var a=r.getyourstore();return a?(i.checkstoresmessage="Check stock in other stores",i.checkstoresmessagelong="Check other stores"):(i.checkstoresmessage="Set your store",i.checkstoresmessagelong="Set your store for stock levels"),o.data("shellproduct")&&(i.allowaddtocart=!0,i.isAlwaysAvailable=!0,i.online="instock",i.clickcollect="instock",i.store="instock",i.deliveryMsg=s.getOnlineMsg(i),i.clickAndCollectMsg=s.getCollectMsg(i),i.storeMsg="..."),i},s.getTodaysDate=function(e){var t=new Date;t.setHours(0,0,0,0),t&&s.serverDate&&t.getTime()===s.serverDate.getTime()?e&&"function"==typeof e&&e(s.serverDate):$.ajax({type:"HEAD",url:ow.url.jsassetsdir+"javascript/ow/ow.tp.min.js",complete:function(r){var a=r.getResponseHeader("date");a?(a=new Date(a),a.setHours(0,0,0,0),s.serverDate=a,e&&"function"==typeof e&&e(s.serverDate)):e&&"function"==typeof e&&e(t)}})},s}}(),ow.utils.wc.deliverygroup=function(){var e=(ow.utils.wc.eventbus,ow.utils.wc.inventory),t=(ow.utils.wc.store,ow.utils.wc.commonUtils),r=(ow.utils.wc.owutils,ow.utils.wc.customerinfoutil,{DOOR_TO_DOOR:"20000",COLLECT:"10000"}),a={getCustomerInfoUtil:function(){var e=$.Deferred();return"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(t){e.resolve(t)}),e.promise()},getDeliveryEstimate:function(e,t){var a=this,o=$.Deferred(),i=e.postCode,n=e.selectedShipModeId,s="W301";try{var c=e.storeName;c.match(/[W-w]\d{4}/)&&(s=c)}catch(l){}return a.getCustomerInfoUtil().done(function(e){var c=a.getOrderPartNumbers(t).join();""===c?o.reject():(deliveryEstimateUrl=n===r.COLLECT?ow.url.apiCollectUrl+"/"+s+"?partNumber="+c:ow.url.apiDeliveryUrl+"/"+i+"?partNumber="+c,e.thirtyDayAccountEnabled&&(deliveryEstimateUrl+="&isThirtyDayCustomer=true"),$.get(deliveryEstimateUrl).done(function(e){o.resolve(a.setDeliveryDataFromApi(t,e,n))}).fail(function(){o.reject()}))}),o.promise()},findItemFromOrder:function(e,t){for(i=0;i<e.length;i++)if(e[i].partNumber==t)return e[i].isAvailabilityApiEnabled=!0,e[i];return null},deliveryGroupTypes:{STANDARD:"standard",OUT_OF_STOCK:"outOfStock",BACK_ORDER:"backorder",ONLINE:"online",NO_DELIVERY:"nodelivery",OPS:"ops",OTHER:"other"},createDeliveryGroup:function(e,t,r){return{deliveryMessage:t,groupType:r,orderItemList:e,displayable:!0,commandContext:null,printAndCopyJob:null,deliveryPage:!0}},createOutOfStockDeliveryGroup:function(e){return{displayable:!0,commandContext:null,printAndCopyJob:null,orderItemList:e,groupType:this.deliveryGroupTypes.OUT_OF_STOCK,deliveryMessage:"Temporarily out of stock, please remove from your cart",deliveryPage:!0}},setDeliveryDataFromApi:function(e,t,a){var o=this,i={},n=1,s=o.getInvaliItemsFromTransferOrder(),c=[],i={};return _.each(t.deliveries,function(t){if(a===r.COLLECT)var l="Estimated collection on "+$.datepicker.formatDate("DD, MM d, yy",new Date(t.estDeliveryDate));else var l="Estimated delivery on "+$.datepicker.formatDate("DD, MM d, yy",new Date(t.estDeliveryDate));var d;d=o.isOutOfStockDeliveryGroup(t)?o.createOutOfStockDeliveryGroup([]):o.isBackOrderDeliveryGroup(t)?o.createDeliveryGroup([],l,o.deliveryGroupTypes.BACK_ORDER):o.createDeliveryGroup([],l,o.deliveryGroupTypes.STANDARD),d.estDeliveryDate=t.estDeliveryDate,_.each(t.items,function(t){var n=o.findItemFromOrder(e,t.partNumber);null!=n&&(d.groupType===o.deliveryGroupTypes.OUT_OF_STOCK?n.inventoryMap=o.createInventoryStatusMap(n,"outofstock",t):d.groupType===o.deliveryGroupTypes.BACK_ORDER?n.inventoryMap=o.createInventoryStatusMap(n,"backorder",t):o.isItemAlreadyGrouped(i,n)?o.setSplitInventoryStatusMap(d,i,n,t):t.deliveryQty<t.orderedQty?(n.inventoryMap=o.createInventoryStatusMap(n,"outofstock",t),n.inventoryMap.deliveryMsg=d.deliveryMessage,n.inventoryMap.outOfStockMsg="We only have "+t.deliveryQty+" unit(s) of this product in stock. Please reduce the quantity you are ordering or remove this item."):(n.inventoryMap=o.createInventoryStatusMap(n,"instock",t),n.inventoryMap.deliveryMsg=d.deliveryMessage),_.contains(s,n.catEntryId)?c.push(n):o.isItemAlreadyGrouped(i,n)||(a===r.COLLECT&&t.isQuickCollectAvailable&&(d.deliveryMessage="Estimated collection in 2 hours"),d.orderItemList.push(n)))}),_.isEmpty(d.orderItemList)||(i[n]=d,n++)}),i=o.setNonStandardItemDeliveryGroup(i,e),i=o.appendItemsToOutOfStockGroup(i,c),o.setInvalidItemsFromDeliveryService(e,t),i},isItemAlreadyGrouped:function(e,t){var r=!1;return _.each(e,function(e){"undefined"!=typeof _.findWhere(e.orderItemList,{orderItemId:t.orderItemId})&&(r=!0)}),r},isOutOfStockDeliveryGroup:function(e){return void 0!=e.estDeliveryDate&&""===e.estDeliveryDate.trim()},isBackOrderDeliveryGroup:function(e){return void 0!=e.estDeliveryDate&&e.backorder},setSplitInventoryStatusMap:function(e,t,r,a){var o=this;_.each(t,function(t){var i=_.findWhere(t.orderItemList,{orderItemId:r.orderItemId});if("undefined"!=typeof i){var n=i.inventoryMap.deliveryMsg,s=i.inventoryMap.deliveryStockQty,c=i.inventoryMap.totalDeliveryQty,l=c+a.deliveryQty;i.inventoryMap.deliveryBackOrderQty=a.deliveryQty,l<a.orderedQty?(i.inventoryMap=o.createInventoryStatusMap(r,"outofstock",a),i.inventoryMap.deliveryMsg="We only have "+l+" unit(s) of this product in stock. Please reduce the quantity you are ordering or remove this item.",i.inventoryMap.totalDeliveryQty=l):(i.inventoryMap=o.createInventoryStatusMap(r,"backorder_partial",a),i.inventoryMap.totalDeliveryQty=c,i.inventoryMap.deliveryMsg=n,i.inventoryMap.deliveryBackOrderMsg=e.deliveryMessage,i.inventoryMap.deliveryBackOrderQty=i.inventoryMap.deliveryStockQty,i.inventoryMap.deliveryStockQty=s)}})},setInvalidItemsFromDeliveryService:function(e,t){var r=this,a=new Array;return void 0!==t.partsInError&&(_.each(t.partsInError,function(t){var o=r.findItemFromOrder(e,t.partNumber);null!=o&&(o.inventoryMap=r.createInventoryStatusMap(o,"outofstock",t),a.push(o))}),a.length>0)?r.appendItemsToOutOfStockGroup(orderData,a):void 0},appendItemsToOutOfStockGroup:function(e,t){var r=this,a=!1;if(t.length>0){var o;Object.keys(e).forEach(function(i){("undefined"==typeof o||Number(o)<Number(i))&&(o=i),a||e[i].id!=r.deliveryGroupTypes.OUT_OF_STOCK||(e[i].orderItemList=e[i].orderItemList.concat(t),a=!0)}),a||(sortedOrderItemsMap["undefined"==typeof o?"1":Number(o)+1]=r.createOutOfStockDeliveryGroup(t))}return e},getInvaliItemsFromTransferOrder:function(){var e=[];return"undefined"!=typeof ow.state.invalidItemList&&(e=ow.state.invalidItemList.substring(1,ow.state.invalidItemList.length-1).split("|")),e},setNonStandardItemDeliveryGroup:function(e,t){var r=this,a=[],o=[],n=[],s=[];for(i=0;i<t.length;i++){var c=t[i],l=c,d=l.productType;r.isNoneInventoryCatEntry(l)&&(c.isAvailabilityApiEnabled=!0,c.inventoryMap=r.createInventoryStatusMap(c,"instock",{deliveryQty:0}),l.printAndCopy?(l.printAndCopyJob||l.thirdPartyDetailsMap)&&n.push(c):l.swmsProduct||l.digitalDownload||r.isMailmanPyoPartNumber(l.partNumber)||l.pbsProduct?a.push(c):_.contains(ow.state.noDeliveryNeededProductTypes,d)&&!_.contains(ow.state.notDisplayedIndependentlyProductTypes,d)?o.push(c):_.contains(ow.state.notDisplayedIndependentlyProductTypes,d)||s.push(c))}var u=0;"object"!==$.type(e)&&(e={}),a.length&&(e[u]=r.createDeliveryGroup(a,"Online Delivery",r.deliveryGroupTypes.ONLINE));var p=_.keys(e).length+(a.length?0:1);return n.length&&(e[p++]=r.createDeliveryGroup(n,ow.state.printAndCopyCartGroupMsgForApiAvailability,r.deliveryGroupTypes.OPS)),o.length&&(e[p++]=r.createDeliveryGroup(o,"Non Deliverable these items do not require delivery",r.deliveryGroupTypes.NO_DELIVERY)),s.length&&(e[p++]=r.createDeliveryGroup(s,"Other",r.deliveryGroupTypes.OTHER)),e},getOrderPartNumbers:function(e,t){var r=this,a=new Array;return _.isArray(e)&&_.each(e,function(e){var o=e;if(!r.isNoneInventoryCatEntry(o)){var i=e.partNumber,n=e.quantity.value;a.push(t?i:i+"|"+n)}}),a},isMailmanPyoPartNumber:function(e){return _.contains(ow.state.mailmanPyoPartNumbers,e)},isNoneInventoryCatEntry:function(e){var t=this;return e.pbsProduct||e.swmsProduct||e.digitalDownload||t.isMailmanPyoPartNumber(e.partNumber)||e.printAndCopy||_.contains(ow.state.noDeliveryNeededProductTypes,e.productType)},getItemChannel:function(e){var t="ALL";return e.rangedOnlineOnly?t="ONLINEONLY":e.rangedInstoreOnly&&(t="STOREONLY"),t},createInventoryStatusMap:function(e,t,r){var a,o=this,i=e,n=ow.state.mailmanItems||"";return n.indexOf(i.catEntryId)>=0?a="mailman":e.swmsProduct?a="swms":e.pbsProduct&&(a="pbs"),{sourcedFromAvailabilityApi:!0,productType:i.productType,digitalcontent:i.digitalDownload,partNumber:i.partNumber,productId:i.catEntryId,storetitle:"",allowaddtocart:"instock"==t,channel:o.getItemChannel(i),isAlwaysAvailable:i.alwaysAvailable,showTruckIcon:ow.state.isAvailabilityApiEnabled&&"true"===ow.state.isAvailabilityApiEnabled,online:t,deliveryMsg:"",clickcollect:"",clickAndCollectMsg:"",clickAndCollectBackOrderMsg:"",clickAndCollectStockQty:"",clickAndCollectBackOrderQty:"",store:"instock",storeMsg:"",productSubType:a,swmsProduct:i.swmsProduct,pbsProduct:i.pbsProduct,digitalDownload:i.digitalDownload,platformLogos:i.platformLogos,shipfromstore:r.isShipFromStore===!0?"shipfromstore":"",deliveryStockQty:r.deliveryQty,totalDeliveryQty:r.deliveryQty,totalCollectQty:""}},getAvailability:function(r,a){var o=this,i=$.Deferred(),n=o.getOrderPartNumbers(a,!0);return o.getCustomerInfoUtil().done(function(r){var a=e.getInventoryCheckURL(r,n);n.length>0?e.inventoryCallPromise=t.ajaxGetJSON(a,"",function(e){i.resolve(e)},function(e,t){i.reject(t)}):i.reject("Empty partNumbers")}),i},getDeliveryMessageChangesFromAvailability:function(e,t){var r=this,a=$.Deferred(),o=e.selectedShipModeId,i=r.getDeliveryEstimate(e,t),n=r.getAvailability(o,t),s={owOrderBean:{sortedOrderItemsMap:{}}};
return $.when(n,i).done(function(e,t){$.each(t,function(t,a){var i=$.extend({},a);i.orderItemList=[];var n=a.estDeliveryDate;$.each(a.orderItemList,function(a,c){r.isConflictDeliveryDate(o,e,c.partNumber,n)&&(void 0===s.owOrderBean.sortedOrderItemsMap[t]&&(s.owOrderBean.sortedOrderItemsMap[t]=i),s.owOrderBean.sortedOrderItemsMap[t].orderItemList.push(c))})}),a.resolve(s)}),a},isConflictDeliveryDate:function(e,t,r,a){var o=this,i=!1;return $.each(t,function(t,n){if(n.partNumber===r){var s=o.getDateFromAvailabilityOptions(n.options,e);try{availabilityDate=new Date(s),estDeliveryDate=new Date(a)}catch(c){}return(estDeliveryDate>availabilityDate||a.length<1)&&(i=!0),!1}}),i},getDateFromAvailabilityOptions:function(e,t){var a,o="deliverToDoor";return t===r.COLLECT&&(o="clickAndCollect"),$.each(e,function(e,t){return t.type===o?(a=t.availableDate,!1):void 0}),a}};return a}(),ow.utils.wc.inventory=function(){var e="accurate"===$.cookie("OW_AVAILABILITY")||ow.state.isAvailabilityApiEnabled;if(e)return ow.utils.wc.availability;var t=ow.utils.wc.eventbus,r=ow.utils.wc.owutils,a=ow.utils.wc.commonUtils,o=ow.utils.wc.productsubutils,i=(ow.utils.wc.store,["DIGITAL_DOWNLOAD"]),n={};return $(document).ready(function(){r.modals.storeModal()}),n.isDigital=function(e,t){return"undefined"!=typeof $(t).data("producttype")&&$.inArray($(t).data("producttype"),i)>=0},n.prepareInventoryDetailsForProdSub=function(e){var t={};t.parentProductId=e.productId,t.online=e.online,t.availableQty=e.stockQty,t.backOrderQty=e.backOrderQty,t.deliveryMsg=e.deliveryMsg,t.introMessage=e.introMessage,$("div").data("noStock_"+e.productId,t),ow.utils.globalvariablecache.has("inventoryCache",e.productId)||ow.utils.globalvariablecache.put("inventoryCache",e.productId,e)},n.update=function(){var e=$.Deferred(),t=$.Deferred(),r=$.Deferred(),a=$.Deferred(),o=[],i=[],s=$("[data-inventory]").filter(function(e,t){return!(n.isDigital(e,t)||ow.utils.globalvariablecache.has("inventoryCache",$(t).data("id"))&&ow.utils.globalvariablecache.has("priceCache",$(t).data("id")))});s.length>0&&s.each(function(){var e=$(this).data("id"),t=$("#quantity_"+e).val();o.push(t?e+"|"+t.trim():$(".quantity_"+e).val()?e+"|"+t.trim():e+"|0"),i.push(e)});var c=$("[data-addonprice]");c.length>0&&c.each(function(){var e=$(this).data("id");o.push(e+"|0"),i.push(e)});var l=$("[data-addon-id]");if(l.length>0&&l.each(function(){var e=$(this).data("addon-id");o.push(e+"|0"),i.push(e)}),o.length>0){for(var d=[],u=[],p=100;o.length>0;)d.push(o.splice(0,p)),u.push(i.splice(0,p));for(var f=[],h=d.length,m=0;h>m;m++){var v=d[m];f.push(n.executeCheckRestrictedRangeAfterLoadBatch(v,u[m]))}$.when.apply($,f).done(function(){e.resolve(),t.resolve(),r.resolve(),a.resolve()}).fail(function(){e.reject(),t.reject(),r.reject(),a.reject()})}else{n.updateInventoryWithResponse();var g=[],y=$("[data-inventory]").filter(function(e,t){return!n.isDigital(e,t)});y.length>0&&y.each(function(){var e=$(this).data("id");g.push(e)}),"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(t){n.checkRestrictedRange(t,null,{catentryIdsOrderedQty:null,catentryIds:g}).done(function(){e.resolve()}).fail(function(){e.reject()})});var b=function(){n.checkProductSubstitutes().done(function(){r.resolve()}).fail(function(){r.reject()})},w=n.getDigitalCatentryIds();w.length>0?ow.utils.wc.customerinfoutil.getUserData(function(e){n.fetchPrices(e,w).always(function(){n.updatePriceWithResponse().done(function(){t.resolve()}).fail(function(){t.reject()}).always(b)})}):n.updatePriceWithResponse().done(function(){t.resolve()}).fail(function(){t.reject()}).always(b)}return $(document).ready(function(){$("[data-inventory]").filter(function(e,t){return n.isDigital(e,t)}).each(function(e,t){var r={productType:$(t).data("producttype"),productSubType:$(t).data("productsubtype")};n.applyAvailabilityMessages(t,r)}),$(document).trigger("contentloaded"),a.resolve()}),n.showClickAndCollectStoreForPrintAndCopy(),$.when(e,t,r,a)},n.getDigitalCatentryIds=function(){return $("[data-inventory]").filter(function(e,t){return n.isDigital(e,t)}).map(function(e,t){return $(t).data("id")})},n.updateSingle=function(e){var t=[],r=[];t.push(e+"|1"),isNaN(e)||(r.push(parseInt(e)),n.executeFunctionAfterCheckingRestrictedRange(n.loadbatch,{catentryIdsOrderedQty:t,catentryIds:r}))},n.executeCheckRestrictedRangeAfterLoadBatch=function(e,t){return n.loadbatch(e,t)},n.executeFunctionAfterCheckingRestrictedRange=function(e,t){"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(r){n.checkRestrictedRange(r,e,t)})},n.loadbatch=function(e,t){var r=$.Deferred();return"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(i){var s=n.getInventoryCheckURL(i,e);o.resetAllDisplayedSubstitutionsFor(),n.noStockList||(n.noStockList=[]);var c=$.Deferred();e.length>0?n.inventoryCallPromise=a.ajaxGetJSON(s,"",function(r){n.updateInventoryWithResponse(t,r),n.checkRestrictedRange(i,null,{catentryIdsOrderedQty:e,catentryIds:t}).done(function(){c.resolve()}).fail(function(){c.reject()})},function(e,t){n.inventoryCallFailureResponseHandler(e,t),c.reject()}):(n.updateInventoryWithResponse(),n.checkRestrictedRange(i,null,{catentryIdsOrderedQty:e,catentryIds:t}).done(function(){c.resolve()}).fail(function(){c.reject()}));var l=n.getDigitalCatentryIds();n.pricePromise=n.fetchPrices(i,$.merge(l,t)),n.showClickAndCollectStoreForPrintAndCopy(),$.when(n.pricePromise,c).done(function(){r.resolve()}).fail(function(){r.reject()})}),r.promise()},n.inventoryCallFailureResponseHandler=function(){n.showInventoryAndAddToCartButton(),$.publish("InventoryFailedToUpdate")},n.fetchPrices=function(e,t){if(t.length){var r=n.getPriceCheckURL(e),o={productId:$.map(t,function(e){return e.toString()}).join(",")},i=function(){$('[data-price="default"]').css("display","inline-block")};return a.ajaxGet(r,o,n.updatePriceWithResponse,i)}return $.Deferred(function(e){n.updatePriceWithResponse().done(function(){e.resolve()}).fail(function(){e.reject()})}).promise()},n.checkProductSubstitutes=function(){var e=$.Deferred();if(n.noStockList&&n.noStockList.length>0){n.noStockList=_.uniq(n.noStockList);var t={productId:n.noStockList.join(",")};o.updateProductSubDetails(t).done(function(){e.resolve()}).fail(function(){e.reject()})}else e.resolve();return e.promise()},n.checkRestrictedRangeWithoutProductSub=function(e,t,r){n.checkRestrictedRange(e,t,r,!0)},n.checkRestrictedRange=function(e,t,r,a){var o=$.Deferred();return"R"===e.userType&&"BUSINESS"===e.customerType&&!0===e.restrictedRangeActive?n.fetchRestrictedRange(e,r,a).done(function(){n.renderRestrictedRange(t,r,a).done(function(){o.resolve()}).fail(function(){o.reject()})}):("undefined"!=typeof a&&a||n.checkProductSubstitutes(),o.resolve()),o.promise()},n.fetchRestrictedRange=function(e,t){var a=$.Deferred(),o=[];return $.each(t.catentryIds,function(e,t){ow.utils.globalvariablecache.has("restrictedRangeCache",t)||o.push(t)}),o.length>0?$.ajax({method:"POST",url:r.noCommentURL(ow.url.absoluteURL+"ValidateRestrictedRange?action=CR&catentryIds="+o),complete:function(e){var t=e.responseJSON;if("undefined"!=typeof t)if("undefined"!=typeof t.status&&"SUCCESS"===t.status)for(var r in o){var i=o[r],e={type:0,productId:i};ow.utils.globalvariablecache.put("restrictedRangeCache",i,e)}else if("undefined"!=typeof t.response)for(var r in o){var i=o[r],e=t.response[i];"undefined"==typeof e&&(e={type:0,productId:i}),ow.utils.globalvariablecache.put("restrictedRangeCache",i,e)}a.resolve()},error:function(){a.reject()}}):a.resolve(),a.promise()},n.renderRestrictedRange=function(e,t,r){var a=$.Deferred(),o=[];for(var i in t.catentryIds){var s=t.catentryIds[i],c=ow.utils.globalvariablecache.get("restrictedRangeCache",s);"undefined"!=typeof c&&$('[data-catentryid="'+c.productId+'"]').length>0&&(2==c.type?(!$('[data-price="default"][data-id="'+c.productId+'"]').find(".icon-ow-contractprice").length>0&&($('.ow-product-panel[data-catentryid="'+c.productId+'"]').addClass("is-restricted"),$('.ow-product-tile[data-catentryid="'+c.productId+'"]').addClass("is-restricted"),$('.ow-product-details[data-catentryid="'+c.productId+'"]').addClass("is-restricted"),$('.ow-add-to-cart[data-catentryid="'+c.productId+'"] :parent').popover({html:!0,content:"Your Administrator has requested that you be prevented from purchasing this product.",trigger:"hover",placement:"bottom",container:"body"}),$('.ow-add-to-cart[data-catentryid="'+c.productId+'"]').attr("disabled","disabled"),$('.ow-add-to-cart[data-catentryid="'+c.productId+'"] [title]').html("Restricted Item")),o.push(c.productId)):1==c.type&&($('.ow-product-panel[data-catentryid="'+c.productId+'"]').addClass("is-restricted"),$('.ow-product-tile[data-catentryid="'+c.productId+'"]').addClass("is-restricted"),$('.ow-product-details[data-catentryid="'+c.productId+'"]').addClass("is-restricted"),$('.ow-add-to-cart[data-catentryid="'+c.productId+'"] :parent').popover({html:!0,content:"Your Administrator has requested that you be prevented from purchasing this product.",trigger:"hover",placement:"bottom",container:"body"}),$('.ow-add-to-cart[data-catentryid="'+c.productId+'"]').attr("disabled","disabled"),$('.ow-add-to-cart[data-catentryid="'+c.productId+'"] [title]').html("Restricted Item"),o.push(c.productId)))}return"function"==typeof e&&e(t.catentryIdsOrderedQty,t.catentryIds),n.showInventoryAndAddToCartButton(),$.each(o,function(e,t){n.noStockList=$.grep(n.noStockList,function(e){return e!=t})}),"undefined"!=typeof r&&r?a.resolve():"undefined"!=typeof n.inventoryCallPromise&&"undefined"!=typeof n.pricePromise?$.when(n.inventoryCallPromise,n.pricePromise).done(function(){n.checkProductSubstitutes().done(function(){a.resolve()}).fail(function(){a.reject()})}):n.checkProductSubstitutes().done(function(){a.resolve()}).fail(function(){a.reject()}),a.promise()},n.showClickAndCollectStoreForPrintAndCopy=function(){$(".printandcopy-click-and-collect").length&&$(".printandcopy-click-and-collect").html(n.getDefaultStoreTitle)},n.showInventoryAndAddToCartButton=function(){$('[data-cart="add"]').css("display","block"),$("[data-inventory]").filter("div [data-always-hidden!='true']").css("display","block"),r.modals.availabilityModal(),$(".add-to-cart").show().promise().done(function(){t.trigger("initAddToMyList")})},n.getInventoryCheckURL=function(e,t){ow.state.isRegistered="R"===e.userType,ow.state.isThirtyDayAcnt=e.thirtyDayAccountEnabled;var r=$.cookie("FFMCenter");if(r){var a=!1;$("#checkout").length>0&&(a=!0),-1!=r.indexOf(",")&&(r=r.replace(",","-"),$.cookie("FFMCenter",r,{path:"/"}));var o=r.split("-")[0],i=r.split("-")[1];if(a)var n=ow.state.cachedHttpRequest+"GetInventoryCheckOut?storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId+"&ffmcenterId="+o+"&storeffmcenterId="+i+"&iscartPage="+a+"&nc=true&catentryId="+t.join(",")+"&usertypecachebust="+ow.state.isRegistered+"-"+ow.state.isThirtyDayAcnt;else var n=ow.state.cachedHttpRequest+"GetInventory?storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId+"&ffmcenterId="+o+"&storeffmcenterId="+i+"&iscartPage="+a+"&nc=true&catentryId="+t.join(",")+"&usertypecachebust="+ow.state.isRegistered+"-"+ow.state.isThirtyDayAcnt;return n}},n.getPriceCheckURL=function(e){var t=($.cookie("PREFERRED_STORE_ID")||"",$.cookie("OW_PRICE_FETCH")||ow.state.customPriceFetchEnabled);if("undefined"!=typeof e&&"BUSINESS"===e.customerType){var r=ow.url.absoluteURL+(t?"OWGetPriceBusiness?":"OWPriceViewBusiness?");r+="business=true&"}else var r=ow.url.absoluteURL+(t?"OWGetPrice?":"OWPriceView?");return r=r+"storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId},n.getArrayFromResponse=function(e){var t;return"string"==typeof e&&(t=JSON.parse(e)),"object"==typeof e&&(t=e),t},n.updatePriceWithResponse=function(e){var a=Handlebars.templates.price,o=$.Deferred(),i=[],s=$.cookie("OW_PRICE_FETCH")||ow.state.customPriceFetchEnabled;if(e=s&&e&&e.prices?e.prices:e)for(var c=0;c<e.length;c++){var l=e[c];l&&l.productId&&(ow.utils.globalvariablecache.has("priceCache",l.productId)||ow.utils.globalvariablecache.put("priceCache",l.productId,l))}"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(e){var s=$('[data-price="default"]');for(var c in ow.utils.globalvariablecache.all("priceCache")){var l=ow.utils.globalvariablecache.get("priceCache",c);s.filter('[data-id="'+l.productId+'"]').each(function(t,r){if("undefined"!=typeof l.price){var o=$.extend({displayGSTExclusiveFlag:e.displayGSTExclusive,hideContractPriceIndicator:e.hideContractPriceIndicator},l);$(r).html(a(o))}else $(r).html("N/A"),$('[data-cart="add"][data-id="'+l.productId+'"]').attr("disabled","disabled"),$('[data-cart="add"][data-catentryid="'+l.productId+'"]').attr("disabled","disabled");0==$(r).closest(".ow-price").find(".excl-gst-msg-display").length&&$(r).closest(".ow-price").append('<small class="gst text-muted excl-gst-msg-display" style="display: none;">excl. GST</small>'),l.hasContractPrice&&!e.hideContractPriceIndicator&&$(r).closest(".ow-price").addClass("ow-price--contract-price")});var d=($(".price[data-id="+l.productId+"]"),$("#add-to-cart_"+l.productId)),u=$("#add-to-cart_"+l.productId).closest(".ow_bulk_buy"),p=$("#BulkbuyFindOutMore_"+l.productId);if(l.bulkbuy){if(d.length>0){var f=$.Deferred();i.push(f),n.updateBulkbuyDisplay(l,u).done(function(){f.resolve()}).fail(function(){f.reject()})}}else $(".ow-bulk-buy").filter('[data-id="'+l.productId+'"]').empty(),p.hide();0!==$("#unit-price-display").length&&"undefined"!=typeof l.price&&(displayGSTExclusiveFlag?n.updateUnitPriceDisplay($("#unit-price-display"),l.priceExcludeTax,l.productId):n.updateUnitPriceDisplay($("#unit-price-display"),l.price,l.productId))}e.displayGSTExclusive?$(".excl-gst-msg-display").show():$(".excl-gst-msg-display").hide(),t.trigger("price:update"),o.resolve(),r.loader("hide",".ow-product-panel__actions, .ow-product-tile__inner")});var d=[];return d.push(o),d.push.apply(d,i),t.trigger("price:loaded"),$.when.apply($,d)},n.updateUnitPriceDisplay=function(e,t,r){var a=window.navigator.userAgent,o=a.indexOf("MSIE "),i={};o>0?(i.productid=e.attr("data-productid"),i.totalunit=e.attr("data-totalunit"),i.unitmeasure=e.attr("data-unitmeasure"),i.perunitdisplaysuffix="undefined"!=typeof e.attr("data-perunitdisplaysuffix")&&"undefined"!=typeof e.attr("data-unitmeasure")?e.attr("data-perunitdisplaysuffix").replace("(s)",1==e.attr("data-unitmeasure")?"":"s"):e.attr("data-perunitdisplaysuffix")):i=e.data();var n=i.productid,s=t;if("undefined"!=typeof n&&"undefined"!=typeof r&&n==r){var c=parseFloat(i.totalunit),l=i.unitmeasure,d=i.perunitdisplaysuffix,u=Number(s.replace(/[^0-9\.]+/g,""));if(c>0){var p=u*l/c;p=Math.round(p*Math.pow(10,2))/Math.pow(10,2);var f="$"+p+" "+d;e.text(f),e.show()}}},n.applyAvailabilityMessages=function(e,t){{var a=$(e).data("inventory")||"default";$(e).data("producttype")||"default"}t.platformLogos=$(e).data("platformlogos")||!1;var o=Handlebars.templates["inventory-"+a];"undefined"!=typeof o&&$(e).html(o(t)),r.loader("hide",e)},n.updateInventoryWithResponse=function(e,a){var i=$("[data-inventory]");a&&a.inventory&&(a=a.inventory),a&&e&&$.each(a,r.partial(function(e,t,r){"undefined"!=typeof r&&!isNaN(t)&&$.inArray(parseInt(t),e)>-1&&(n.updatemessaging(r),ow.utils.globalvariablecache.put("inventoryCache",r.productId,r))},e));var s=$.extend(!0,{},ow.utils.globalvariablecache.all("inventoryCache"));ow.state.listingpage||_.each(ow.utils.globalvariablecache.all("restrictedRangeCache"),function(e,t){"undefined"!=typeof s[t]&&0!==e.type&&delete s[t]}),$.each(s,function(e,r){if(r){if(n.noStockList||(n.noStockList=[]),r.hideinventory||(i.filter('[data-id="'+r.productId+'"]').each(function(e,t){n.applyAvailabilityMessages(t,r)}),t.trigger("refreshstoreavailabilityfrom")),$.inArray(r.online,o.productSubDisplayStatuses)>-1){var a=jQuery.inArray(r.productId,n.noStockList);0>a&&n.noStockList.push(r.productId),n.prepareInventoryDetailsForProdSub(r)}var s=$('[data-cart="add"][data-catentryid="'+r.productId+'"]'),c=$('.ow-quantity[data-catentryid="'+r.productId+'"]'),l=$("#add2CartBtn_"+r.productId).data("shellproductactiontext"),d="undefined"!=typeof ow.state.ordertemplatepage&&ow.state.ordertemplatepage;if(d||r.allowaddtocart){var u;c.hide(),"DONATION"==r.productType?u="DONATE":r.thirdParty?u="Customise":l?u=l:(u="Add to Cart",c.show()),s.removeAttr("disabled").find("span").text(u)}else{var u="Unavailable Online";s.prop("disabled","disabled").attr("data-channel",r.channel).find("span").text(u),c.hide()}}}),$("#cartContainer").length>0&&($(".product").each(function(){$(this).find("div.deliver-to-door").length>0&&"outofstock"==$(this).find("div.deliver-to-door").attr("class").split(" ")[2]&&($(this).addClass("unavailable"),$(this).find(".price.total").removeClass("price total").addClass("text-error").html("Temporarily <br/> out of stock")),$(this).find("div.deliver-to-door").length>0&&"unavailable"==$(this).find("div.deliver-to-door").attr("class").split(" ")[2]&&($(this).addClass("unavailable"),$(this).find(".quantity-control").remove(),$(this).find(".price.total").removeClass("price total").addClass("text-error").html("Temporarily <br/> unavailable"))}),$(".product.unavailable").length>0&&$("html,body").stop().animate({scrollTop:$(".product.unavailable").first().offset().top-30},"swing")),n.showInventoryAndAddToCartButton(),$(document).trigger("contentloaded"),$.publish("InventoryUpdated")},n.updateBulkbuyDisplay=function(e,t){var r=$.Deferred(),a=ow.utils.localStorageUtil.sessionStorage("options"),i=a.pageView;return"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getDisplayGSTExclusive(function(a){if(bulkPriceRange=a?e.priceRangeExclTax:e.priceRange,!(t.find(".ow-bulk-buy").size()>0)){$("div").data("priceRange_"+e.productId,o.transformPriceRange(bulkPriceRange,e.productId)),e.bulkPriceRange=bulkPriceRange.slice(1);var n=Handlebars.templates.bulkBuyTemplate;"list"==i&&(e["class"]="ow-bulk-buy--narrow",$("#ow_bulk_buy_"+e.productId).replaceWith(n(e))),$(".bulkbuys-table").filter('[data-id="'+e.productId+'"]').html(n(e)),r.resolve()}}),r.promise()},n.formatCurrency=function(e){return parseFloat(e,10).toFixed(2)},n.getyourstore=function(){var e=ow.utils.localStorageUtil.sessionStorage("PREFERRED_STORE");if(!$.isEmptyObject(e))try{return JSON.parse(e)}catch(t){return{}}},n.getDefaultStoreTitle=function(){var e=n.getyourstore();return e&&e.name?(e.name=e.name.replace(/%2C/g,","),e.name.replace("Officeworks","")):void 0},n.updatemessaging=function(e){if(e){var t=this.getyourstore();if(t){if(e.storeshorttitle="Store availability",e.storetitle=this.getDefaultStoreTitle(),e.storemessage="",e.checkstoresmessage="Check stock in other stores",e.checkstoresmessagelong="Check other stores","instock"==e.store)e.storemessage="Available in store";else if("outofstock"==e.store)e.storemessage="";else if("limitedstock"==e.store){var a=(ow.url.storeLocatorViewURL,"");"undefined"!=typeof t.telephone&&t.telephone.length>0&&(a=t.telephone),e.storemessage=a.length>0?'Call to confirm <a href="'+r.appendParams(ow.url.storeLocatorViewURL,{selectedStoreId:$.cookie("PREFERRED_STORE_ID")})+'">'+a+"</a>":'<a href="'+r.appendParams(ow.url.storeLocatorViewURL,{selectedStoreId:$.cookie("PREFERRED_STORE_ID")})+'">Contact store</a> for availability'}}else e.storetitle="Shop At",e.storeshorttitle="Store availability",e.storemessage="No store selected",e.store="nostore",e.checkstoresmessage="Set your store",e.checkstoresmessagelong="Set your store for stock levels";if(e.onlinetitle="Deliver to Door",e.isclickandcollect=!1,e.splitmessage=!1,e.availableQtyMsgCheckout="",ow.url.shoppingCartURL&&(e.shoppingcarturl=ow.url.shoppingCartURL),e.backOrderQty>0){var o=$(".quantity_"+e.productId).val(),i=o-e.backOrderQty;e.splitmessage=!0,e.availableQty=i,e.availableStatus=i>0?!0:!1}return"ONLINEONLY"==e.channel?(e.storeshorttitle="Store availability",e.checkstoresmessage="",e.checkstoresmessagelong=""):"STOREONLY"==e.channel&&(e.isclickandcollect=!0),e.storeMsg=$("<textarea />").html(e.storeMsg).val(),e.deliveryMsg&&(e.deliveryMsg=$("<textarea />").html(e.deliveryMsg).val()),e.clickAndCollectMsg&&(e.clickAndCollectMsg=$("<textarea />").html(e.clickAndCollectMsg).val()),e.deliveryBackOrderMsg&&(e.deliveryBackOrderMsg=$("<textarea />").html(e.deliveryBackOrderMsg).val()),e.clickAndCollectBackOrderMsg&&(e.clickAndCollectBackOrderMsg=$("<textarea />").html(e.clickAndCollectBackOrderMsg).val()),e}},n}(),ow.controls.thirtydayaccountcontrol=function(){var e=ow.utils.wc.owutils,t=Backbone.Model.extend({defaults:{isNegativeBalance:!1,availableCredit:"",afterPurchaseBalance:""}}),r=Backbone.View.extend({el:"body",events:{"click #refresh-credit-link, #refresh-credit":"refreshCreditBalance"},refreshCreditBalance:function(t){"undefined"!=typeof t&&(t.preventDefault(),e.loader("show","#30DayAccount"));var r=this;$.ajax({type:"POST",url:e.noCommentURL(ow.url.absoluteURL+"OWCreditCheckCmd"),success:function(t){r.render(t),e.loader("hide","#30DayAccount")}})},initialize:function(){var e=this;$(document).ready(function(){if($("#currentBalanceTemplate").length>0){var t=$("#currentBalanceTemplate").html();e.currentBalanceTemplate=Handlebars.compile(t),e.refreshCreditBalance()}else $("#cfpNewCreditDisplayEnabled").length>0&&e.refreshCreditBalance();_.bindAll(e)})},render:function(e){var r=$("#orderTotalValue").val(),a=e.creditCheckStatus&&e.creditCheckStatus.creditLimitAvailable?e.creditCheckStatus.creditLimitAvailable:void 0,o=parseFloat(a)-parseFloat(r);if(o=Math.round(100*o)/100,$("#cfpNewCreditDisplayEnabled").length>0&&"true"===$("#cfpNewCreditDisplayEnabled").val()){var i=$("#creditLimit").val(),n=0>a?0:a,s=n/i*100,c=33>s?"#d7122d":s>66?"#108600":"#ffcb05";$("#current-balance").html("$ "+a.formatMoney(2,",",".")),$("#current-balance-h3").css("color",c);var l=0>o?0:o,d=l/i*100,u=33>d?"#d7122d":d>66?"#108600":"#ffcb05";$("#creditBalanceAfterPurchaseAmt").html("$ "+o.formatMoney(2,",",".")),$("#creditBalanceAfterPurchaseAmt-h3").css("color",u),$("#creditBalanceAfterPurchaseProgressBar").prop("aria-valuenow",d),$("#creditBalanceAfterPurchaseProgressBar").css("width",d+(d>0?"%":"px")),$("#creditBalanceAfterPurchaseProgressBar").css("background-color",u),0>o?$("#negativeBalanceInfo").removeClass("hidden"):$("#negativeBalanceInfo").addClass("hidden")}else{var p=new t;p.availableCredit=a?a.formatMoney(2,",","."):"",0>o?($("#creditBalanceAfterPurchaseAmt").removeClass("ow-price--positive"),$("#creditBalanceAfterPurchaseAmt").addClass("ow-price--negative"),$("#creditBalanceAfterPurchaseAmt .ow-price__amount").html("$ -"+(-1*o).formatMoney(2,",",".")),$("#negativeBalanceInfo").removeClass("hidden")):($("#creditBalanceAfterPurchaseAmt").removeClass("ow-price--negative"),$("#creditBalanceAfterPurchaseAmt").addClass("ow-price--positive"),$("#creditBalanceAfterPurchaseAmt .ow-price__amount").html("$ "+o.formatMoney(2,",",".")),$("#negativeBalanceInfo").addClass("hidden"));var f=this.currentBalanceTemplate(p);$(".current-balance").html(f)}}});return Number.prototype.formatMoney=function(e,t,r){var a=this,e=isNaN(e=Math.abs(e))?2:e,r=void 0==r?".":r,t=void 0==t?",":t,o=0>a?"-":"",i=parseInt(a=Math.abs(+a||0).toFixed(e))+"",n=(n=i.length)>3?n%3:0;return o+(n?i.substr(0,n)+t:"")+i.substr(n).replace(/(\d{3})(?=\d)/g,"$1"+t)+(e?r+Math.abs(a-i).toFixed(e).slice(2):"")},r}(),ow.controls.abncheckcontrol=function(){var e=ow.utils.wc.owutils,t=null,r=null,a=Backbone.View.extend({events:{"keyup #abnNumberInput":"validateABNWithDelay","keyup #acnInputField":"validateACNWithDelay","keyup #sftaxPayerId":"validateAbnFunction","change #abnList":"resetOrganizationName"},form:null,initialize:function(){_.bindAll(this),this.showLabel=this.options.showLabel,this.abnData={abnDetails:[]},this.template=Handlebars.templates.abnTemplate,1===$("#abnNumberInput").length&&($("#abnNumberInput").val().length>0?this.checkAbnFunction($("#abnNumberInput").val()):this.initAbnList()),1===$("#acnInputField").length&&$("#acnInputField").val().length>0&&this.checkAcnFunction(this),$("#thankyou #abnNumberInput").length>0&&$("#thankyou #abnNumberInput").val().length>0&&11!=$("#thankyou #abnNumberInput").val().length&&$('<label class="error">Please enter an eleven digit number to verify your ABN.</label>').insertAfter($("#abnNumberInput"))},validateABN:function(e){var t=$(e.currentTarget);if(1!=t.attr("readonly")&&"true"!=t.attr("readonly")&&"readonly"!=t.attr("readonly")){this.clearError(t);var r=t.val().trim().replace(/\s/g,"");if(r.match(/[^\d]/g)||r.length>11)return this.clearError(t),$('<label class="error">Please enter an eleven digit number only.</label>').insertAfter(t),this.initAbnList(),!1;r.length<11&&this.initAbnList(),11==r.length&&this.checkAbnFunction(r)}},validateABNWithDelay:function(e){var t=this;null!=r&&clearTimeout(r),r=setTimeout(function(){r=null,t.validateABN(e)},200)},validateACNWithDelay:function(e){var r=this;null!=t&&clearTimeout(t),t=setTimeout(function(){t=null,r.validateACN(e)},200)},validateACN:function(e){var t=$(e.currentTarget);if(1!=t.attr("readonly")&&"true"!=t.attr("readonly")&&"readonly"!=t.attr("readonly")){this.clearError(t);var r=t.val().trim().replace(/\s/g,"");return r.match(/[^\d]/g)||r.length>9||r.length<9?($('<label id="acnInputField-error" class="error" for="acnInputField">Please enter a nine digit number only.</label>').insertAfter(t),$("#companyName").val(""),!1):9==r.length?this.checkAcnFunction(r):void 0}},trim:function(e){var t="";return e&&(t=e.val().replace(/\s/g,"")),t},clearError:function(e){e.removeClass("error"),e.nextAll("label.error").remove()},checkAbnFunction:function(t){if(this.initAbnList(),void 0!=ow.url.abnCheckUrl){var r=this,a=$("#abnNumberInput"),o=ow.url.abnCheckUrl+"?abn="+t;0===this.abnData.abnDetails.length?($("#abnNumberInput").val(t),this.form=a.closest("form"),e.loader("show","#abnWrapper"),$.post(e.noCommentURL(o)).done(function(t){if(e.loader("hide","#abnWrapper"),void 0!=t){if(void 0==t.abn||"Network Error"===t.abn[0])return r.clearError(a),$('<label class="error">Error retrieving company information for your ABN.</label>').insertAfter(a),!1;if(void 0==t.abn[0]||"Invalid ABN"===t.abn[0])return r.clearError(a),$('<label class="error">Unable to find a match for your ABN. Please check the number you have entered.</label>').insertAfter(a),!1;for(var o=0;o<t.abn.length;o++){var i={tradingName:_.unescape(t.abn[o])};r.abnData.abnDetails.push(i)}}r.abnData.showLabel=r.showLabel,$("#organizationName").val(t.abn[0])}).fail(function(){r.hideLoading(),$('<label class="error">Connection error encountered while attempting to verify your ABN.</label>').insertAfter(a)})):this.initAbnList()}},checkAcnFunction:function(t){if(void 0!=ow.url.acnCheckUrl){var r=this,a=$("#acnInputField"),o=e.noCommentURL(ow.url.absoluteURL+"CompanyBusinessRetriveOrgDetailsCmd?acn="+t);if(!this.validACN(t))return $('<label id="acnInputField-error" class="error" for="acnInputField">Invalid ACN format. Please check the number you have entered.</label>').insertAfter(a),$("#acnInputField").addClass("error"),$("#companyName").val(""),!1;$("#acnInputField").val(t),this.form=a.closest("form"),"function"==typeof ow.pages.thirtydayregisterpage&&(ow.utils.wc.owutils.loader("show","#companyApplication"),this.clearError($("#companyName")),$("#companyName").removeClass("error")),$.get(e.noCommentURL(o)).done(function(e){return void 0!=e?"FAILURE"===e.returnCode?($("#acnInputField").addClass("error"),$('<label id="acnInputField-error" class="error" for="acnInputField">Error getting information</label>').insertAfter(a),$("#companyName").val(""),!1):"SUCCESS"!==e.returnCode||void 0!==e.OrgIdResult&&void 0!==e.OrgIdResult.isValid&&e.OrgIdResult.isValid!==!1?(r.clearError(a),$("#companyName").val(_.unescape(e.OrgIdResult.legalName)),!0):($("#acnInputField").addClass("error"),$('<label id="acnInputField-error" class="error" for="acnInputField">Unable to find a match for your ACN. Please enter ACN of an active company.</label>').insertAfter(a),$("#companyName").val(""),!1):void 0}).always(function(){"function"==typeof ow.pages.thirtydayregisterpage&&ow.utils.wc.owutils.loader("hide","#companyApplication")})}},initAbnList:function(){this.abnData={abnDetails:[]},this.abnData.showLabel=this.showLabel,$("#abnList-placeholder").html(this.template(this.abnData)),$("#abnList").length>0&&$("#abnList").change()},validACN:function(e){for(var t=0,r=0;r<e.length-1;r++){var a=e[r]*(e.length-1-r);t+=a}var o=10-t%10;return 10==o&&(o=0),e[e.length-1]==o},resetOrganizationName:function(){$("#organizationName").val($("#abnList").val()?$("#abnList").val().substring(0,40):"")},validateAbnFunction:function(){var e=$("#sftaxPayerId");this.clearError(e);var t=this.trim(e);$("#sftaxPayerId").val(t)}});return a}(),ow.controls.addressselectioncontrol=function(){var e=ow.utils.wc.eventbus,t=ow.utils.wc.owutils,r=ow.utils.wc.owaddressvalidateutil,a=(ow.controls.qascheckcontrol,Backbone.View.extend({addressChanged:!1,events:{"click .find-address":"addressEntry",'click input[name="optionBusiness"]':"abnEntry","change #invoiceCheck":"invoiceEntry","click .change-address-button":"changeAddressForm","click .address-save":"updateAddress","click .choose-address.shipping-details .dropdown-menu li a":"selectDeliveryAddress","click .choose-address.contact-details .dropdown-menu li a":"selectDeliveryAddress","click .choose-address.billing-details .dropdown-menu li a":"selectInvoiceAddress","focus #address1_address1":"focusDeliveryAddress1","blur #address1taxPayerId":"blurAbnLookup","change #address-fields input, #address-fields select":"checkIfAddressChanged","change .postcode-autocomplete, .suburbs-autocomplete-input, .suburbs-autocomplete-select, .state-autocomplete":"clearPostcodeSuburbStateCombinationError"},clearPostcodeSuburbStateCombinationError:function(){$(".postcodesuburbstate-combination-error").text("").addClass("hidden")},checkIfAddressChanged:function(){this.addressChanged=!0},focusDeliveryAddress1:function(){if(!elementTagFiredAddress1)try{elementTagFiredAddress1=!0}catch(e){}},blurAbnLookup:function(){if(!elementTagFiredABN)try{elementTagFiredABN=!0}catch(e){}},addressEntry:function(e){$(e.currentTarget).parent().find(".address-entry").toggle()},changeAddressForm:function(e){existingAddressId=$(e.currentTarget).data("addressId"),targetModal=$(e.currentTarget).data("target"),addressTitle=$(e.currentTarget).data("addressTitle"),checkoutRelatedAddressId=$(e.currentTarget).data("checkoutRelatedAddressId"),addressType=$(e.currentTarget).data("addressType");var t=$(document.body),r=t.innerWidth();t.css("overflow","hidden"),t.width(r)},initValidations:function(){$(".address-form").each(function(e,r){jQuery.validator.addMethod("phoneRegex",t.phoneValidateMethod,"Enter numbers only."),$(this).validate({ignore:":hidden",rules:{organizationUnitName:{required:!0,number:!0},organizationName:{required:!0},personTitle:{required:!0},firstName:{required:!0,maxlength:128},lastName:{required:!0,maxlength:128},email1:{required:!0,email:!0},address2:{maxlength:40},address1:{required:!0,maxlength:60},city:{required:!0},state:{required:!0,remote:{param:{url:t.noCommentURL(ow.url.absoluteURL+"OWAddressValidateCmd"),type:"POST",data:{postcode:function(){return $(r).find(".postcode-autocomplete").val()},suburb:function(){var e=$(r).find("select.suburbs-autocomplete-select").val();return(null==e||""==e)&&(e=$(r).find(".suburbs-autocomplete-input").val()),e},state:function(){return $(r).find(".state-autocomplete").val()}},dataFilter:function(e){try{var t=$.parseJSON(e);t.validAddress||$(document).trigger("alert",{type:"danger",html:"<strong>Warning!</strong> Invalid combination of Postcode, Suburb &amp; State",dismissible:!1,trackState:!1,id:"noSuburbsFound",insert:{method:"insertBefore",selector:".postcodesuburbstate-combination-error"}})
}catch(r){return!0}}},depends:function(){return""!==$(".suburbs-autocomplete-select").val()}}},zipCode:{required:!0,number:!0,maxlength:4,minlength:4},phone1:{required:!0,phoneRegex:!0,maxlength:20},mobilePhone1:{ausMobPhone:!0}},messages:{organizationUnitName:"Enter your ABN",organizationName:"Enter your Business Name",personTitle:"Select Title",firstName:{required:"Enter your First Name",maxlength:"Maximum of 128 characters"},lastName:{required:"Enter your Last Name",maxlength:"Maximum of 128 characters"},email1:{required:"Enter your Email Address",email:"Email address format only"},addressEntry:"Enter your Address",deliveryAddress:"Enter your Delivery Address",address2:{maxlength:"Maximum of 40 characters"},address1:{required:"Enter your Address",maxlength:"Maximum of 60 characters"},city:"Enter your City or Suburb",state:{required:"Select State"},zipCode:{required:"Enter Postcode",number:"Numbers only",maxlength:"4 numbers only",minlength:"4 numbers required"},phone1:{required:"Enter your Phone Number",phoneRegex:"Enter numbers only",maxlength:"Maximum of 20 characters"},mobilePhone1:{digits:"Enter numbers only"}},invalidHandler:function(e,t){!t.numberOfInvalids()}})})},selectDeliveryAddress:function(r){var a,o=($(r.currentTarget),$(r.currentTarget).data("value")),i=$("#address-shipping-"+o),n=$("#UpdateShipInfoForm"),s=$("textarea[name=shippingInstructions]").val();n&&(a=n.find("input[name=orderItemId]").val()),$.post(t.noCommentURL(i.attr("action")),i.serialize()).done(function(t){self.addressChanged=!1;var r=t.addressId[0];e.trigger("DeliveryUpdate",{addressId:r,shippingInstruction:s,orderItemId:a})}).error(function(r){var o;try{if(o=$.parseJSON(r.responseText),o&&o.errorCode&&"5006"===o.errorCode){var n="AjaxPersonChangeServiceAddressAdd";i.find("input[name=addressId]").attr("disabled",!0),i.find("input[name=nickName]").attr("disabled",!1),$.post(t.noCommentURL(n),i.serialize()).done(function(t){self.addressChanged=!1;var r=t.addressId[0];e.trigger("DeliveryUpdate",{addressId:r,shippingInstruction:s,orderItemId:a})})}}catch(c){console.log("Error parsing exception data "+r)}})},selectInvoiceAddress:function(r){var a,o=($(r.currentTarget),$(r.currentTarget).data("value")),i=$("#address-billing-"+o),n=$("#UpdateShipInfoForm"),s=$("textarea[name=shippingInstructions]").val();n&&(a=n.find("input[name=orderItemId]").val()),$.post(t.noCommentURL(i.attr("action")),i.serialize()).done(function(t){self.addressChanged=!1;var r=t.addressId[0];e.trigger("InvoiceUpdate",{addressId:r,shippingInstruction:s,orderItemId:a})}).error(function(r){var o;try{if(o=$.parseJSON(r.responseText),o&&o.errorCode&&"5006"===o.errorCode){var n="AjaxPersonChangeServiceAddressAdd";i.find("input[name=addressId]").attr("disabled",!0),i.find("input[name=nickName]").attr("disabled",!1),$.post(t.noCommentURL(n),i.serialize()).done(function(t){self.addressChanged=!1;var r=t.addressId[0];e.trigger("InvoiceUpdate",{addressId:r,shippingInstruction:s,orderItemId:a})})}}catch(c){console.log("Error parsing exception data "+r)}})},updateAddress:function(e){var t=$(e.currentTarget),r=$(t).parents("form:first"),a=t.data("modalTarget"),o=($(r).attr("action"),this),i=(r.find("input[name=addressType]").val(),r.find("input[name=mode]").val()),n=(r.find("input[name=shippingBilling]").is(":checked"),r.find("input[name=primaryCheck]").is(":checked"));r.find("input[name=primary]").val(n);var s=$(r).find(".postcode-autocomplete").val(),c=$(r).find(".suburbs-autocomplete-select").val();(null==c||""==c)&&(c=$(r).find(".suburbs-autocomplete-input").val());var l=$(r).find(".state-autocomplete").val();r.valid()&&$.when(this.owAddressValidateUtil.checkPostcodeSuburbState(s,c,l)).done(function(e){e.validAddress?1==o.qasCheckControl.qasEnabled&&1==o.addressChanged?o.qasCheckControl.addressCheck(r,function(){o.submtAddressFormAfterQasCheck(r,i,a)}):o.submtAddressFormAfterQasCheck(r,i,a):$(document).trigger("alert",{type:"danger",html:"<strong>Warning!</strong> Sorry, no suburbs found for the postcode entered",dismissible:!1,id:"noSuburbFoundError",trackState:!1,floating:ow.breakpoints.isSmall(),insert:{method:"insertAfter",selector:"#postcodeEntryWrapper"}})})},submtAddressFormAfterQasCheck:function(r,a){var o,i,n,s,c=this,l=$($.find("#UpdateShipInfoForm"));l&&(o=l.find("input[name=addressId]").val(),i=l.find("input[name=selectedInvoiceAddress]").val(),n=$("textarea[name=shippingInstructions]").val(),s=l.find("input[name=orderItemId]").val()),$.post(t.noCommentURL(r.attr("action")),r.serialize(),function(t){c.addressChanged=!1;var r=t;$("#addressForm").innerHTML=r.message,!t.lastIndexOf||!t.lastIndexOf("errorCode")>0?(addressId=r.addressId[0],"Shipping"==a?(e.trigger("DeliveryUpdate",{addressId:addressId,updateRelatedAddress:!0,refreshPanels:!0,shippingInstruction:n,orderItemId:s}),i===o&&e.trigger("InvoiceUpdate",{addressId:addressId,updateRelatedAddress:!0,refreshPanels:!0,shippingInstruction:n,orderItemId:s})):(e.trigger("InvoiceUpdate",{addressId:addressId,updateRelatedAddress:!0,refreshPanels:!0,shippingInstruction:n,orderItemId:s}),i===o&&e.trigger("DeliveryUpdate",{addressId:addressId,updateRelatedAddress:!0,refreshPanels:!0,shippingInstruction:n,orderItemId:s}))):t.lastIndexOf("_ERR_USER_AUTHORITY")>0||t.lastIndexOf("_ERR_DIDNT_LOGON")>0?(alert("your session has timed out, please login again to continue"),window.location.href=ow.url.relogonFormURL):alert("An unexpected error occurred processing the request. Please contact customer care who will help you place your order.")})},abnEntry:function(e){var t=$(e.currentTarget).data("choice");t?$(".abn-entry").show():$(".abn-entry").hide()},invoiceEntry:function(e){$(e.currentTarget).is(":checked")?$(".invoice-entry").hide():$(".invoice-entry").show()},initialize:function(){this.owAddressValidateUtil=new r,this.qasCheckControl=this.options.qasCheckControl,this.initValidations(),e.on("ReinitAddressValidations",this.initValidations),$("#editAddressModal").on("hidden",function(){var e=$(document.body);e.css("overflow","auto"),e.width("auto")}),elementTagFiredAddress1=!1,elementTagFiredABN=!1}}));return a}(),ow.controls.addtocartcontrol=function(){var e,t=ow.utils.wc.owutils,r=ow.utils.wc.eventbus,a=ow.utils.wc.inventory,o=ow.utils.wc.checkoututil,i=0,n=["GENERAL_SERVICE","DIGITAL_DOWNLOAD","DONATION","ONLINE_PRINT"],s=Backbone.View.extend({miniCartTimer:null,currentProduct:null,events:{"click [data-cart=add]":"addToCartClick","click [data-cart=addAssembly]":"addAssemblyFromCart","click [data-cart=addExtraCover]":"addExtraCoverFromCart","click [data-cart=addProductInsurance]":"addProductInsuranceFromCart","click [data-cart=productSub]":"addProductSubToCart","click [data-cart=addFromOrdHistory]":"addFromOrderHistory","change input.extra_cover_checkbox":"selectExtraCover","change input.assembly_checkbox":"selectAssembly","change input.product_insurance_checkbox":"selectProductInsurance","click .minicart-checkout-button":"continueToDeliveryPage","change input[name^=mailmanLabelType]":"updateSelectedProductInfo","click .mailman-labeltype-label":"setCurrentProduct","panelopened #shopping-cart":"miniCartEnter","click [data-cart=shellProduct]":"forwardToShellProduct"},miniCartEnter:function(){$(".ow-shopping-cart .ow-shopping-cart-loading").hasClass("ow-loading")||0===$("#widget_minishopcart li").length&&0===$("#minicart-not-loaded").length&&this.updateMiniCart()},mainContentLoader:function(e){var t=$(".content");"show"==e?t.find(".loader").show():t.find(".loader").hide()},continueToDeliveryPage:function(e){e.preventDefault(),"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(e){if(e.isCustomerServiceRep&&!e.isCustomerServiceRepActingAsCustomer)$("#miniShopCartModalBody").html("<p>You are not authorised to place an order. You must log in as a customer.</p>"),$("#miniShopCartModal").appendTo("body").modal("show");else{var r=ow.state.currentOrderIdInMiniCart;$.ajax({method:"POST",url:t.noCommentURL("OWPaymentInstructionCleanupCmd?orderId="+r),success:function(){window.location.href=ow.url.checkoutURLInMiniCart},error:function(){window.location.href=ow.url.checkoutURLInMiniCart}})}})},selectExtraCover:function(e){var t=$(e.currentTarget),r=t.attr("data-productid"),a=t.attr("data-extracoveritemid"),o=$("#add2CartBtn_"+r);"undefined"!=typeof r&&"undefined"!=typeof a&&(t.prop("checked")?o.attr("data-extracoveritemid",a):o.removeAttr("data-extracoveritemid"))},selectAssembly:function(e){var t=$(e.currentTarget),r=t.attr("data-productid"),a=t.attr("data-assemblyitemid"),o=$("#add2CartBtn_"+r);"undefined"!=typeof r&&"undefined"!=typeof a&&(t.prop("checked")?o.attr("data-assemblyitemid",a):o.removeAttr("data-assemblyitemid"))},selectProductInsurance:function(e){if(ow.state.productInsuranceEnabled){var t=$(e.currentTarget),r=t.attr("data-productid"),a=t.attr("data-productinsuranceitemid"),o=$("#add2CartBtn_"+r);"undefined"!=typeof r&&"undefined"!=typeof a&&(t.prop("checked")?o.attr("data-productinsuranceitemid",a):o.removeAttr("data-productinsuranceitemid"))}},cmCartViewTag:function(e){var r=this;$.ajax({type:"post",url:t.noCommentURL(ow.url.AnalyticsShopcartViewUrl),data:e,dataType:"json",success:function(e){r.publishCustomCartViewTag(e)}})},publishCustomCartViewTag:function(e){void 0==e&&(e=ow.tagging.cmCartViewData);var t=[],a=0;for(a=0;a<e.length;a++){var o=e[a],i=o.productId,n=o.productName,s=o.quantity,c=o.price,l=o.category,d=o.categoryIdentifier,u=(o.extraparms,o.rrRecPlacement,$.cookie("cmAddToCartSessionCookie")),p=o.espotName+","+o.pageType+","+o.category,f=new Object;if(f[i]=p,u&&!$.isEmptyObject(u)){var h=JSON.parse(u);if(h.length<owTaggingConfig.CoremetricsAddToCartTrackingCount){for(var m=!1,v=0;v<h.length;v++){var g=Object.keys(h[v])[0];g==i&&(m=!0)}m||h.push(f),$.cookie.raw=!0,$.cookie("cmAddToCartSessionCookie",JSON.stringify(h),{path:"/"}),$.cookie.raw=!1}}else{var y=[];y.push(f),$.cookie.raw=!0,$.cookie("cmAddToCartSessionCookie",JSON.stringify(y),{path:"/"}),$.cookie.raw=!1}var b={partNumber:i,name:n,quantity:s,price:c,category:l,extCategoryId:d};$.extend(b,o),t.push(b)}var w={product:{item:t}};r.trigger("ItemAddedToCart",w)},setProductSubCookie:function(e,t){var r=$.cookie("productSubCookie"),a={};if(a.productSubId=t,r){for(var o=JSON.parse(r),i=!1,n=0;n<o.length;n++){var s=o[n].productSubId;s==t&&(i=!0)}i||o.push(a),$.cookie("productSubCookie",JSON.stringify(o),{path:"/"})}else{var c=[];c.push(a),$.cookie("productSubCookie",JSON.stringify(c),{path:"/"})}},setCurrentProduct:function(e){var t=this;t.currentProductId=$(e.currentTarget).attr("data-othercatentryid")},updateSelectedProductInfo:function(e){var t=this,r=$(e.currentTarget).val();$("#search_"+t.currentProductId).attr("data-id",r),$("#search_"+t.currentProductId).attr("id","search_"+r),$("#productdetail_"+t.currentProductId).attr("data-id",r),$("#productdetail_"+t.currentProductId).attr("id","productdetail_"+r),$("#price_"+t.currentProductId).attr("data-id",r),$("#price_"+t.currentProductId).attr("id","price_"+r),$("#add-to-cart_"+t.currentProductId).attr("id","add-to-cart_"+r),$("#quantity-section_"+t.currentProductId).attr("data-catentryid",r),$("#quantity-section_"+t.currentProductId).attr("id","quantity-section_"+r),$("#add2CartBtn_"+t.currentProductId).attr("data-id",r),$("#add2CartBtn_"+t.currentProductId).attr("data-catentryid",r),$("#add2CartBtn_"+t.currentProductId).attr("id","add2CartBtn_"+r),$("#addon-minus_"+t.currentProductId).attr("data-for","quantity_"+r),$("#addon-minus_"+t.currentProductId).attr("id","addon-minus_"+r),$("#quantity_"+t.currentProductId).attr("data-for","add2CartBtn_"+r),$("#quantity_"+t.currentProductId).attr("data-catentryid",r),$("#quantity_"+t.currentProductId).attr("name","quantity_"+r),$("#quantity_"+t.currentProductId).attr("id","quantity_"+r),$("#addon-plus_"+t.currentProductId).attr("data-for","quantity_"+r),$("#addon-plus_"+t.currentProductId).attr("id","addon-plus_"+r),a.updateSingle(r)},getURLParameter:function(e){for(var t=window.location.search.substring(1),r=t.split("&"),a=0;a<r.length;a++){var o=r[a].split("=");if(o[0]==e)return o[1]}},isShowLocationModalOnAddToCart:function(){return e.isBrowseAvailabilityPreferencesEnabled()&&!e.isUserLocationSet()},isAddToCartLocationDisplayed:function(){return $.cookie("addToCartLocationDisplayed")},addToCartClick:function(t){var r=$(t.currentTarget),a=this;if(a.btn=r,a.isShowLocationModalOnAddToCart()&&a.isInventoryItem(r)&&!a.isAddToCartLocationDisplayed()){var o=new Date;o.setTime(o.getTime()+72e5),$.cookie("addToCartLocationDisplayed","true",{path:"/",expires:o}),e.displaySuburbLocationModal(!0,!0,function(t){e.setLocationOnSearchOrPDP(t).always(function(){a.validateAvailabilityAfterLocationSet(r.data("id")).done(function(){a.performAddToCartClick(a.btn)})})},function(){a.performAddToCartClick(a.btn)})}else a.performAddToCartClick(r)},isInventoryItem:function(e){var t=e.data("id"),r=$('[data-inventory][data-id="'+t+'"]').data("producttype"),a=r||"STANDARD";return $.inArray(a,n)>=0?!1:!0},performAddToCartClick:function(e){if(!e.attr("disabled")||"disabled"!=e.attr("disabled")){var t=(e.attr("id"),e.attr("data-catentryid")),r=(e.attr("data-productid"),$("#"+e.attr("data-quantity-input-id"))),a=1;r.length>0&&(a=$(r).val());var o=e.attr("data-thirdparty");if(o&&"true"==o)return void this.customiseThirdPartyProduct(t);var i=$(".assembly_checkbox").is(":checked"),n=!1,s=!1,c=e.attr("data-parentproductid"),l=ow.state.currentOrderId;if(void 0!=t){var d=e.attr("data-extracoveritemid"),u=e.attr("data-assemblyitemid");if(ow.state.productInsuranceEnabled)var p=e.attr("data-productinsuranceitemid")}var f=new Array,h=new Array;f[0]=t,h[0]=a;var m=$.extend({},ow.state.orderItemAddBaseParams);void 0!=d&&(f[f.length]=d,h[h.length]=a,m["addon-extraCoverFor"]=d+"_"+t,n=!0),ow.state.productInsuranceEnabled&&void 0!=p&&(f[f.length]=p,h[h.length]=a,m["addon-productInsuranceFor"]=p+"_"+t,s=!0),void 0!=u&&(f[f.length]=u,h[h.length]=a,m["addon-assemblyFor"]=u+"_"+t,assemblyItemSelected=!0),void 0!=c&&(m["addon-productSubFor"]=c);for(var v=0;v<f.length;v++)m["catEntryId_"+(v+1)]=f[v],m["quantity_"+(v+1)]=h[v];m.orderId=void 0!=l&&null!=l?l:".";var g=e.closest("[data-rr-placement]").attr("id"),y=e.closest("[data-reczone]").data("reczone"),b=e.closest("[data-espotname]").parent("[data-espotname]").data("espotname"),w="productSub"===e.closest("[data-cart]").data("cart"),I=e.data("sitesection"),C=e.closest("[data-product-comparison]").length>0,S=e.data("pagetype"),P=!1;"undefined"!=typeof ow.state.searchpage&&(P=ow.state.searchpage.isSEOTypeABrand());var k=this.getURLParameter("source"),A="";"undefined"!=typeof w&&w?A="Product Substitution":void 0!==typeof P&&P===!0?A="Brand URL":null!=b||void 0!=b?A=b:null!=I||void 0!=I?A=ow.tagging.siteSection?ow.tagging.siteSection:b:k?A=k:C&&(A="Product Comparison"),S=S?"unknown":ow.tagging.cmPageType,"undefined"!=typeof coremetricsData&&(A=coremetricsData.cmSiteSection,S=coremetricsData.pageType);var T=$("#price_"+t+" .price-text .price-ele ").html(),R={cmProductId:t,cmQty:a,cmRecZone:y,rrRecPlacement:g,cmPageType:S,cmIsEspot:null===b||y?"false":"true",cmSiteSection:null===A?"":A,cmCategoryName:ow.tagging.cmCategoryName,cmAssembleIt:i,cmExtraCover:n,cmCatEntryPrice:T,productFindingMethod:e.data("productfindingmethod")};ow.state.productInsuranceEnabled&&(R.cmProductInsurance=s);var L=$.param(R),D=$.param(m,!0);this.addItemToCart(D,L,e)}},validateAvailabilityAfterLocationSet:function(e){var t=$("#add2CartBtn_"+e),r=$.Deferred(),o=t.data("catentryid"),i=$("#"+t.attr("data-quantity-input-id")),n=1;return i.length>0&&(n=$(i).val()),t.attr("disabled")?"disabled"==t.attr("disabled")&&("function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(e){var t=a.getPriceCheckURL(e);$.when($.get(t,{productId:o.toString()}),$.get(ow.url.ajaxCatalogEntryViewURL+"&productId="+o)).done(function(e,t){e=e[0],t=t[0];var a=Handlebars.templates.cantAddToCartModal,i=a({catEntryId:o,partNumber:t.partNumber,thumbNailImage:t.mainImage,seoURL:t.productDisplayUrl,name:t.productName,quantity:{value:n},itemPrice:e.prices[0].price}),s=$("#cantAddToCartModal");s.length?s.replaceWith(i):$("body").append(i);var c=$("#cantAddToCartModal");c.modal("show"),r.reject()})})):r.resolve(),r},customiseThirdPartyProduct:function(e){var r={};r.catEntryId=e;var a=$.param(r,!0),o=this;$.ajax({type:"POST",url:t.noCommentURL(ow.url.apiGetThirdPartyProductDataURL),data:a,dataType:"json",success:function(e){o.getAuthToken(e)}})},getAuthToken:function(e){var r=e.tpClientId,a=e.tpJobRequestUrl,o=e.partNumber,i=this;$.ajax({method:"GET",xhrFields:{withCredentials:!0},cache:!1,async:!1,url:t.noCommentURL(ow.url.apiGetThirdPartyTokenURL+r),success:function(e){null!=e.authToken&&(window.location.href=i.constructJobRequestUrl(a,e.authToken,o))},error:function(e){console.log(e.message)}})},constructJobRequestUrl:function(e,t,r){var a=e.indexOf("?")>-1?"&":"?";return e+a+"partNumber="+r+"&token="+t},addExtraCoverFromCart:function(e){var t=this;t.mainContentLoader("show");var a=$(e.currentTarget).attr("data-catentryid"),i=$(e.currentTarget).attr("data-associatedparentid"),n=$(e.currentTarget).attr("data-associatedqty"),s=1;null!=n&&void 0!=n&&(s=parseInt(n));var c=new Array,l=new Array;c[0]=a,l[0]=s;var d=$.extend({},ow.state.orderItemAddBaseParams);d["addon-extraCoverFor"]=a+"_"+i,d.catEntryId_1=a,d.quantity_1=s;var u=ow.utils.localStorageUtil.sessionStorage("currentOrderId");($.isEmptyObject(u)||"."==u)&&(u=ow.state.currentOrderId),d.orderId=u;var p=$.param(d,!0),f=$.param({cmProductId:a,cmQty:s,cmRecZone:"",cmPageType:"Shopping Cart",cmIsEspot:"false",cmSiteSection:"",cmCategoryName:"",productFindingMethod:"Cart"}),p=$.param(d,!0);o.addItemInCart(p,function(){t.cmCartViewTag(f),r.trigger("ShoppingCart:UpdateCart")})},addProductInsuranceFromCart:function(e){var t=this;if(ow.state.productInsuranceEnabled){t.mainContentLoader("show");var a=$(e.currentTarget).attr("data-catentryid"),i=$(e.currentTarget).attr("data-associatedparentid"),n=$(e.currentTarget).attr("data-associatedqty"),s=1;null!=n&&void 0!=n&&(s=parseInt(n));var c=new Array,l=new Array;c[0]=a,l[0]=s;var d=$.extend({},ow.state.orderItemAddBaseParams);d["addon-productInsuranceFor"]=a+"_"+i,d.catEntryId_1=a,d.quantity_1=s;var u=ow.utils.localStorageUtil.sessionStorage("currentOrderId");($.isEmptyObject(u)||"."==u)&&(u=ow.state.currentOrderId),d.orderId=u;var p=$.param({cmProductId:a,cmQty:s,cmRecZone:"",cmPageType:"Shopping Cart",cmIsEspot:"false",cmSiteSection:"",cmCategoryName:"",productFindingMethod:"Cart"}),f=$.param(d,!0);o.addItemInCart(f,function(){t.cmCartViewTag(p),r.trigger("ShoppingCart:UpdateCart")})}},addAssemblyFromCart:function(e){var t=this;t.mainContentLoader("show");var a=$(e.currentTarget).attr("data-catentryid"),i=$(e.currentTarget).attr("data-associatedparentid"),n=$(e.currentTarget).attr("data-associatedqty"),s=1;null!=n&&void 0!=n&&(s=parseInt(n));var c=new Array,l=new Array;c[0]=a,l[0]=s;var d=$.extend({},ow.state.orderItemAddBaseParams);d["addon-assemblyFor"]=a+"_"+i,d.catEntryId_1=a,d.quantity_1=s;var u=ow.utils.localStorageUtil.sessionStorage("currentOrderId");($.isEmptyObject(u)||"."==u)&&(u=ow.state.currentOrderId),d.orderId=u;var p=$.param({cmProductId:a,cmQty:s,cmRecZone:"",cmPageType:"Shopping Cart",cmIsEspot:"false",cmSiteSection:"",cmCategoryName:"",productFindingMethod:"Cart"}),f=$.param(d,!0);o.addItemInCart(f,function(){t.cmCartViewTag(p),r.trigger("ShoppingCart:UpdateCart")})},addProductSubToCart:function(e){var a=this,o=$(e.currentTarget),i=o.attr("data-catentryid"),n=o.attr("data-associatedparentid");if(0==$("#itemDetails").length)return a.addToCartClick(e),void a.setProductSubCookie(e,i);a.mainContentLoader("show");var s=(o.attr("id"),$(o.closest(".ow-product-panel, .ow-product-details, .ow-product-tile__inner")).find(".quantity_input")),c=1;s.length>0&&(c=$(s).val());var l=(new Array,new Array,$.extend({},ow.state.orderItemAddBaseParams));l.catEntryId_1=i,l.quantity_1=c;var d=ow.utils.localStorageUtil.sessionStorage("currentOrderId");($.isEmptyObject(d)||"."==d)&&(d=ow.state.currentOrderId),l.orderId=d,l["addon-productSubFor"]=n;var u=o.attr("data-reczone"),p=o.closest("[data-espotname]").data("espotname"),f="productSub"===o.closest("[data-cart]").data("cart"),h=("productComparison"===ow.tagging.cmPageType,"");void 0!=f||f?h="Product Substitution":(null!=p||void 0!=p)&&(h=p);var m=$.param({cmProductId:i,cmQty:c,cmRecZone:u,cmPageType:ow.tagging.cmPageType,cmIsEspot:null===p||u?"false":"true",cmSiteSection:null===h?"":h,cmCategoryName:ow.tagging.cmCategoryName}),v=$.param(l,!0);$.ajax({type:"POST",url:t.noCommentURL(ow.url.orderItemAddURL),data:v,dataType:"text",success:function(){a.cmCartViewTag(m),r.trigger("ShoppingCart:UpdateCart")},complete:function(){$(".ow-product-substitute__modal").modal("hide"),$(s).val("1"),o.removeClass("is-pending")}})},updateCartView:function(){if(0==ow.state.totalItemsInCart)document.location.href=ow.url.orderCalculateURL;else{var e=this;$.ajax({type:"POST",url:ow.url.orderCalculateURL,complete:function(){e.mainContentLoader("hide"),$.get(ow.url.shoppingCartRefreshViewURL).done(function(t){$("#cart").html(t),ow.utils.wc.inventory.update(),e.mainContentLoader("hide")}),$.get(ow.url.shoppingCartSummaryRefreshViewURL).done(function(e){$("#OWOrderSummary").html(e)})}})}},addItemToCart:function(e,a,o){var i=this,n=$(".myorders .message");$.ajax({type:"POST",url:t.noCommentURL(ow.url.orderItemAddURL),data:e,dataType:"json",success:function(e){var t=e.orderId[0];null!=t&&(ow.state.currentOrderId=t),a&&i.cmCartViewTag(a),n.fadeIn("slow"),i.updateMiniCart(o,i.showMiniCart),e.orderItemId.length<i.totalItems&&(n.html("<strong>Error Adding Some Items to Cart</strong>"),n.show().addClass("alert-error"));var s=function(){void 0!=ow.pages.shoppingcart&&void 0!=e.orderItemId&&e.orderItemId.length>0&&$("html,body").stop().animate({scrollTop:$("div.ow-cart__row[data-orderitemid='"+e.orderItemId[0]+"']").offset().top-($(".ow-header--minimal").height()+$(".ow-cart__section__heading").height())})},c=function(){o.trigger("buttoncomplete"),setTimeout(s,500)};r.trigger("ShoppingCart:UpdateCart",c)},error:function(e){"undefined"!=typeof e.responseJSON&&"_ERR_INVALID_COOKIE"==e.responseJSON.errorMessageKey&&(location.href=ow.url.relogonFormURL),$(document).trigger("alert",{type:"danger",html:"<strong>Item could not be added to cart!</strong>",dismissible:!0,scrollTo:!0,trackState:!1,floating:!0,timeout:2500,insert:{method:"prependTo",selector:"body"}}),$(o).trigger("buttonfailed")}}),setTimeout(function(){n.fadeOut("slow")},3e3)},updateMiniCart:function(e,r){if($("#shopping-cart").length>0){var a=this;"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil);var o=ow.utils.wc.customerinfoutil.getUserActivityIdFromCookie();if("-1002"===o||"undefined"==typeof o){var n={itemCount:0},s=Handlebars.templates.miniShopCartTemplate,c=s(n);return $("#shopping-cart").html(c),$(".ow-header__navigation").data("_smart-menu",null),$(document).trigger("contentloaded"),void a.storeMinicartPreview()}t.loader("show",".ow-shopping-cart-loading"),$.post(t.noCommentURL(ow.url.miniCartRefreshURL),{isItemList:!0,isGSTExclusivePrice:!0,nc:!0}).done(function(o){if("undefined"!==o){var n=o.owOrderBean,s="undefined"!=typeof n&&"undefined"!=typeof n.itemCount?n.itemCount:0,c=Handlebars.templates.miniShopCartTemplate;i=s;var l=c(o);$("#shopping-cart").html(l),$(".ow-header__navigation").data("_smart-menu",null),$(document).trigger("contentloaded"),a.storeMinicartPreview()}$(e).trigger("buttoncomplete"),"function"==typeof r&&r(),t.loader("hide",".ow-shopping-cart"),$(document).trigger("contentloaded")}).fail(function(){var e=Handlebars.templates.miniShopCartTemplate,r={};r.error=!0,r.errormessage="An error occured,<br/> please refresh the page and try again.",r.itemcount="?";var o=e(r);$("#shopping-cart").html(o),t.loader("hide",".ow-shopping-cart"),$(".ow-header__navigation").data("_smart-menu",null),$(document).trigger("contentloaded"),a.storeMinicartPreview()})}},updateMiniCartNoShow:function(){var e=this;"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil);var r=ow.utils.wc.customerinfoutil.getUserActivityIdFromCookie();if("-1002"===r||"undefined"==typeof r){var a={itemCount:0},o=Handlebars.templates.miniShopCartTemplate,n=o(a);return $("#shopping-cart").html(n),$(".ow-header__navigation").data("_smart-menu",null),$(document).trigger("contentloaded"),void e.storeMinicartPreview()}$.post(t.noCommentURL(ow.url.miniCartRefreshURL),{isItemList:!0,isGSTExclusivePrice:!0,nc:!0}).done(function(t){if("undefined"!==t){var r=Handlebars.templates.miniShopCartTemplate,a=r(t);i=0===t.itemCount?t.itemCount:void 0!=t.owOrderBean&&void 0!=t.owOrderBean.itemCount?t.owOrderBean.itemCount:0,$("#shopping-cart").html(a).promise().done(function(){$(".ow-header__navigation").data("_smart-menu",null),$(document).trigger("contentloaded")}),e.storeMinicartPreview()}}).fail(function(e){var r=Handlebars.templates.miniShopCartTemplate,a={};if(a.error=!0,a.errormessage="An error occured,<br/> please refresh the page and try again.",e&&"undefined"!=typeof e&&e.responseText&&"undefined"!=typeof e.responseText){var o=JSON.parse(e.responseText);o&&"undefined"!=typeof o&&(a.errorMessage=o.errorMessage)}a.itemcount="?";var i=r(a);$("#shopping-cart").html(i),t.loader("hide",".ow-shopping-cart"),$(".ow-header__navigation").data("_smart-menu",null),$(document).trigger("contentloaded"),t.loader("hide","#shopping-cart")})},showMiniCart:function(){var e=this;clearTimeout(e.miniCartTimer),$("#widget_minishopcart li").length>0&&(ow.breakpoints.isMedium()&&t.isVisible("#minicart",!0)||ow.breakpoints.isLarge()?($("#shopping-cart").trigger("openpanel"),$("#shopping-cart").one("mouseenter",function(){clearTimeout(e.miniCartTimer)}),this.miniCartTimer=setTimeout(this.hideMiniCart,3e3)):setTimeout(function(){$(document).trigger("alert",{type:"success",html:"<strong>Item added to cart</strong>",dismissible:!0,scrollTo:!1,trackState:!1,floating:!0,timeout:3e3,insert:{method:"prependTo",selector:"main"}})},1e3))},storeMinicartPreview:function(){0==$(".checkout-label-ShoppingCart").length&&$("#ow-shopping-cart-count").length>0?($.cookie("minicart",i,{path:"/"}),$("#ow-shopping-cart-count").html(i)):this.resetMinicartFlag()},initMiniCartQtyFromStorage:function(){"thankyou"===ow.state.page&&$.cookie("minicart","0",{path:"/"});var e=$.cookie("minicart");ow.state.cartpage&&"reset"!==e?this.resetMinicartFlag():ow.state.cartpage||void 0!==e&&"reset"!=e&&void 0==e.match(/Cart/)?$("#ow-shopping-cart-count").length>0&&$("#ow-shopping-cart-count").html(e):this.updateMiniCartNoShow()},resetMinicartFlag:function(){$.cookie("minicart","reset",{path:"/"})},hideMiniCart:function(){$("#shopping-cart").trigger("closepanel")},getJsonFromCommentFilter:function(e){var t=e.indexOf("/*"),r=e.lastIndexOf("*/");return $.parseJSON(e.substring(t+2,r))},getMiniShopCartData:function(){var e={};return $.ajax({url:ow.url.miniCartRefreshURL,success:function(t){var r=$("<div/>").html(t).contents();r.find(".data-catentryid-to-orderitemid").each(function(){var t=$(this).attr("id"),r=$(this).text(),a=r.split(","),o=a[0],i=a[1];o&&(e[t]={orderItemId:o,orderItemQty:i})})}}),e},orderitemupdate:function(e,r){for(var a=$.param(ow.state.orderItemUpdateBaseParams),o=0;o<e.length;o++)a=a+"&orderItemId_"+(o+1)+"="+e[o],a=a+"&quantity_"+(o+1)+"="+r[o];var i=ow.url.orderItemUpdateURL+"?"+a;$.post(t.noCommentURL(i)).done(function(){$.get(ow.url.miniCartRefreshURL).done(function(e){$("#shopping-cart").html(e),$(".ow-header__navigation").data("_smart-menu",null),$(document).trigger("contentloaded"),self.showMiniCart()})})},addFromOrderHistory:function(){$(".ajax-loader").show();var e=this,t=0,r=ow.state.currentOrderId,a=ow.pages.myorderspage.data,o=$.extend({},ow.state.orderItemAddBaseParams);if(a&&a.items){for(var i=e.filterHiddenSkus(a.items),n=1,s=0;s<a.items.length;s++)a.items[s].deliveryFee?t+=1:$.inArray(a.items[s].productId,i)>=0&&(o["partNumber_"+n]=a.items[s].productId,o["quantity_"+n]=a.items[s].qty,n+=1,e.addFromOrderHistoryTagging(a.items[s]));o.numItems=a.items.length,e.totalItems=a.items.length-t}o.orderId=void 0!=r&&null!=r?r:".",o.fromOrderHistory=!0;var c=$.param(o,!0);e.addItemToCart(c)},filterHiddenSkus:function(e){for(var r=ow.url.absoluteURL+"OfficeworksSA/Api/Selector.jsp?storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId+"&resp=item&partNumbers=",a="",o=0;o<e.length;o++)a+=e[o].productId,o!=e.length-1&&(a+="|");var i=r+a,n=[];return $.ajax({type:"GET",url:t.noCommentURL(i),success:function(e){e.items.forEach(function(e){n.push(e.partNumber)})},dataType:"json",async:!1}),n},addFromOrderHistoryTagging:function(e){var t=this,r=$.param({cmPartNumber:e.productId,cmQty:e.qty,cmPageType:ow.tagging.cmPageType});t.cmCartViewTag(r)},forwardToShellProduct:function(e){e.preventDefault();var t=$(e.currentTarget),r=t.data("id"),a=$("#CatalogEntryViewDetailsLink_"+r).attr("href");void 0===a&&(a=$(productdisplayurl_curItemId).attr("href")),window.location.href=a},cmTagOPSAddToCart:function(){var e=ow.pages.printandcopysuccesspage.cmData;void 0!==e&&this.cmCartViewTag(e)},initialize:function(){_.bindAll(this);return this.checkoutPage=ow.state.CheckoutPage,void 0!==r&&(r.on("updateMiniCart",this.updateMiniCart,this),r.on("displayMiniCart",this.showMiniCart,this),r.on("publishCartViewTag",this.publishCustomCartViewTag,this),r.on("initMiniCartQtyFromStorage",this.initMiniCartQtyFromStorage,this),r.on("cmTagOPSAddToCart",this.cmTagOPSAddToCart,this)),e=new ow.controls.userlocationcontrol({el:$(document)}),this}});return $(function(){new s({el:$(document)})}),s}(),ow.controls.afterpaycontrol=function(){function e(e,t,r){this.el=e,this.imagePath=ow.imagePath,this.price=t,this.total=t,this.restricted=r,this.min=parseFloat(d),this.max=parseFloat(u)}function t(e,t){this.el=e,this.imagePath=ow.imagePath,this.min=parseFloat(d),this.max=parseFloat(u),this.restricted=t}function r(e,t){this.el=e,this.emsName=t,this.initialised=!1,$("#afterpayLearnMoreModal").on("shown.bs.modal",this.fetchContent.bind(this))}function a(e,t,r){this.el=e,this.restricted=t,this.price=r,this.max=parseFloat(u),this.imagePath=ow.imagePath}function o(e,t){this.el=e,this.total=parseFloat(t),this.payments=4}var i="[data-afterpay-product]",n="[data-afterpay-summary]",s="[data-afterpay-info]",c="[data-afterpay-cart-item]",l="[data-afterpay-schedule]",d=ow.state.afterpayMin,u=ow.state.afterpayMax,p=(ow.utils.wc.checkoututil,ow.utils.wc.eventbus);e.prototype={render:function(){this.el.find(".ow-price-line.afterpay-summary").remove(),this.el.append(Handlebars.templates["afterpay-summary"](this)),this.el.addClass("afterpay-summary")},get price(){return this._price},set price(e){this._price=e/4},get valid(){return!this.restricted&&this.total<this.max&&this.total>this.min},set valid(e){},get min(){return this._min},set min(e){this._min=parseFloat(e)},get max(){return this._max},set max(e){this._max=parseFloat(e)}},t.prototype={render:function(){this.el.html(Handlebars.templates["afterpay-pdp"](this)),this.el.removeClass("hide")},set priceRange(e){this._priceRange=e,this.qty||(this.qty=1)},get priceRange(){return this._priceRange},get qty(){return this._qty},set qty(e){this._qty=e,this.priceRange&&(this.price=this.priceRange.reduce(this.rangedPrice.bind(this),this.price))},rangedPrice:function(e,t){return this.qty>=parseInt(t.minimumQuantity)?t.value.value:e},get price(){return this._price},set price(e){this._price=isNaN(e)?parseFloat(e.replace("$","").replace(",","").replace(" ","").trim()):e?e:0},get restricted(){return this._restricted},set restricted(e){this._restricted=e},get min(){return this._min},set min(e){this._min=parseFloat(e)
},get max(){return this._max},set max(e){this._max=parseFloat(e)},get belowMin(){return this.price<this.min},get overMax(){return this.price>this.max},get apPrice(){return this.price/4},set apPrice(e){},set belowMin(e){},set overMax(e){}},r.prototype={render:function(e){this.el.html(e),this.initialised=!0},error:function(e){console.log("unable to populate Afterpay Info Modal",e)},fetchContent:function(){if(!this.initialised){var e={emsName:this.emsName};$.ajax({type:"GET",url:ow.url.dynamicEspotURL,data:e,success:this.render.bind(this),error:this.error.bind(this)})}}},a.prototype={render:function(){this.el.html(Handlebars.templates["afterpay-cart-item"](this)),this.el.removeClass("hide")},get price(){return this._price},set price(e){this._price=isNaN(e)?parseFloat(e.replace("$","").replace(",","").replace(" ","").trim()):e?e:0},get reachedPriceLimit(){return this.max<this.price},set reachedPriceLimit(e){}},o.prototype={render:function(){this.el.html(Handlebars.templates["afterpay-schedule"](this)),this.el.removeClass("hide")},get payment(){return this.round(this.total/this.payments,2)},round:function(e,t){var r=Math.pow(10,t),a=e*r,o=Math.round(a);return o/r},get last(){return this.payment+(this.total-4*this.payment)}},$(document).on("contentloaded",function(){ow.utils.wc.customerinfoutil.getUserData(function(d){var u=$.cookie("nativeAppDevice")?!0:!1,f=$.cookie("WC_KIOSK_STORE_ID")?!0:!1,h=d.afterpayEnabled;afterpayEnabled=ow.state.afterpayEnabled&&h||!1,u&&(afterpayEnabled=ow.state.afterpayAppEnabled||!1),f&&(afterpayEnabled=ow.state.afterpayKioskEnabled||!1),afterpayEnabled=$.cookie("ow.afterpay.enabled")||afterpayEnabled||!1,afterpayEnabled&&($(i).each(function(){var e,r=$(this);if(!(r.data("_afterpayProduct")instanceof t)){var a=r.data("id"),o=r.data("restricted");e=new t(r,o),p.on("price:loaded",function(){var t=ow.utils.globalvariablecache.get("priceCache",a);t&&t.price&&(e.price=t.price,e.render()),t&&t.priceRange&&(e.priceRange=t.priceRange,p.on("qty:update",function(t){t&&t.val()&&(e.qty=t.val(),e.render())}))}),r.data("_afterpayProduct",e),r.trigger("componentloaded",["afterpayProduct",e])}}),$(n).each(function(){var t,r=$(this),a=r.data("total"),o=r.data("restricted");r.data("_afterpaySummary")instanceof e||(t=new e(r,a,o),t.render(),r.data("_afterpaySummary",t),r.trigger("componentloaded",["afterpaySummary",t]))}),$(s).each(function(){var e,t=$(this),a=t.data("afterpay-info");t.data("_afterpayInfo")instanceof r||(e=new r(t,a),t.data("_afterpayInfo",e),t.trigger("componentloaded",["afterpayInfo",e]))}),$(l).each(function(){var e,t=$(this);if(!(t.data("_afterpaySchedule")instanceof o)){var r=t.data("total");e=new o(t,r),e.render(),t.data("_afterpaySchedule",e),t.trigger("componentloaded",["afterpaySchedule",e])}}),$(c).each(function(){var e,t=$(this),r=t.data("restricted"),o=t.data("price");t.data("_afterpayCartItem")instanceof a||(e=new a(t,r,o),e.render(),t.data("_afterpayCartItem",e),t.trigger("componentloaded",["afterpayCartItem",e]))}))})})}(),ow.controls.analytics=function(){Backbone.View.extend({appLinksEventId:"App Link Buttons",socialEventId:"Social Sharing Buttons",socialAndAppsCategory:"Social and Apps",events:{"click #android-app-link":"androidAppLink","click #iphone-app-link":"iphoneApplink","click .blog":"socialSharingLink","click .twitter":"socialSharingLink","click .facebook":"socialSharingLink"},initialize:function(){_.bindAll(this),this.initAddThis()},initAddThis:function(){"undefined"!=typeof addthis&&addthis.addEventListener("addthis.menu.share",this.shareLinkClick)},shareLinkClick:function(e){var t=$(".share-links").data("sku");this.cmConversionTag(this.socialEventId+e.data.service,this.socialAndAppsCategory,t)},androidAppLink:function(){this.cmConversionTag(this.appLinksEventId,this.socialAndAppsCategory)},iphoneApplink:function(){this.cmConversionTag(this.appLinksEventId,this.socialAndAppsCategory)},socialSharingLink:function(){this.cmConversionTag(this.socialEventId,this.socialAndAppsCategory)},cmConversionTag:function(){}});$(function(){})}(),ow.controls.attributeselectorcontrol=function(){var owutils=ow.utils.wc.owutils,bus=ow.utils.wc.eventbus,AttributeSelectorControl=Backbone.View.extend({el:"#main-product-details",events:{"click .attribute button":"attributeSelect"},initialize:function(){_.bindAll(this)},attributeSelect:function(e){var t=$(e.currentTarget).data("name");$(e.currentTarget).parents(".attribute").find(".title span").text(t),$(e.currentTarget).parents(".attribute").find("button").removeClass("active"),$(e.currentTarget).addClass("active");var r=this.getActiveAttributes(),a=r[0].productId,o=this.getCatEntryId(r);this.loadItem(o,a)},loadItem:function(e,t){var r=this,a={};a.storeId=ow.state.storeId,a.langId=ow.state.langId,a.catalogId=ow.state.catalogId,a.catalogEntryId=e,a.productId=t;var o=ow.url.absoluteURL+"GetCatalogEntryDetailsByIDView";$.post(owutils.noCommentURL(o),a).done(function(e){var a=r.getJsonFromCommentFilter(e);r.updateAttributes(a,t),bus.trigger("attribute:change",a)})},updateAttributes:function(e,t){$(this.el).find("#catalogue_number").html(e.catalogEntry.catalogEntryIdentifier.externalIdentifier.partNumber),$(this.el).find("#price_display_"+t).find(".price").html(e.catalogEntry.offerPrice),void 0!=e.catalogEntry.extraCoverItem&&($(this.el).find("#extra_cover_price_"+t).find(".extracover_price").html("$"+e.catalogEntry.extraCoverItem.price[0].value.value),$(this.el).find("#extra_cover_price_"+t).find(".extra_cover_checkbox").attr("data-extracoveritemid",e.catalogEntry.extraCoverItem.uniqueID),$(this.el).find("#add2CartBtn").attr("data-extracoveritemid",e.catalogEntry.extraCoverItem.uniqueID),$(this.el).find("#add2CartBtn").attr("data-productid",t)),ow.state.productInsuranceEnabled&&void 0!=e.catalogEntry.productInsuranceItem&&($(this.el).find("#product_insurance_price_"+t).find(".productinsurance_price").html("$"+e.catalogEntry.productInsuranceItem.price[0].value.value),$(this.el).find("#product_insurance_price_"+t).find(".product_insurance_checkbox").attr("data-productinsuranceitemid",e.catalogEntry.productInsuranceItem.uniqueID),$(this.el).find("#add2CartBtn").attr("data-productinsuranceitemid",e.catalogEntry.productInsuranceItem.uniqueID),$(this.el).find("#add2CartBtn").attr("data-productid",t)),$(this.el).find("#add2CartBtn").attr("data-catentryid",e.catalogEntry.catalogEntryIdentifier.uniqueID),$(this.el).find("#unit-measure-display").html(e.catalogEntry.productUnitOfMeasureDisplay),$(this.el).find("#unit-price-display").html(e.catalogEntry.productUnitOfMeasure),$("#feature-description").html(e.catalogEntry.description[0].longDescription)},getCatEntryId:function(data){var productId=data[0].productId,entitledItemId="#entitledItem_"+productId,entitledItems=eval("("+$(entitledItemId).text()+")"),catentry_id="";for(x in entitledItems){var Attributes=entitledItems[x].Attributes;if(this.dataInAttributes(data,Attributes)){catentry_id=entitledItems[x].catentry_id;break}}return catentry_id},dataInAttributes:function(e,t){for(var r=0;r<e.length;r++)if(!(e[r].attributeName in t))return!1;return!0},getJsonFromCommentFilter:function(e){var t=e.indexOf("/*"),r=e.lastIndexOf("*/");return $.parseJSON(e.substring(t+2,r))},getActiveAttributes:function(){var e=new Array;return $(this.el).find(".attributes").find(".active").each(function(t,r){var a=$(r).data("productid"),o=$(r).data("attributename");a&&o&&(e.push({attributeName:o,productId:a}),$(r).parents(".attribute").find(".title span").text($(r).data("name")))}),e},setDefaultAttribute:function(){var e=this.getActiveAttributes();if(e.length>0){var t=e[0].productId,r=this.getCatEntryId(e);this.loadItem(r,t)}}});return AttributeSelectorControl}(),ow.controls.categorymenu=function(){var e=ow.utils.wc.owutils,t=Backbone.View.extend({initialize:function(){$(document).on("sideBarLoaded",function(){ow.state.categoryMenu&&ow.state.categoryMenu.loadCategoryTree()})},loadCategoryTree:function(){var e=ow.url.absoluteURL+"OfficeworksSA/V2/Widgets/OWCategoryTree/CategoryTree.jsp",t={};t.storeId=ow.state.storeId,t.catalogId=ow.state.catalogId,ow.state.categoryId&&(t.categoryId=ow.state.categoryId[0].value),$.ajax({type:"get",url:e,contentType:"text/plain",data:t,context:this,xhrFields:{withCredentials:!1},dataType:"text",success:this.renderCategoryTree,error:function(){},traditional:!0})},renderCategoryTree:function(t){var r=1===$("#owCategories").length;r&&(e.loader("show",".ow-sidebar","ow-loading ow-loading--top-aligned ow-loading--blocking"),$("#owCategories").html(t),$(document).trigger("contentloaded"));var a=$("#category-root").data("_accordion-menu"),o="#categoryChild-"+ow.state.categoryId[ow.state.categoryId.length-1].value;void 0!=ow.state.categoryId&&$("#category-root").find(".ow-accordion-menu__item--root").length>0&&(a.setActive(o),r&&(a.toggleFocus(o),a.setActive(o))),e.loader("hide",".ow-sidebar")}});return t}(),ow.controls.changestorecontrol=function(){var e=ow.utils.wc.ondemandgmaputil,t=ow.utils.wc.storelocatorutil,r=ow.utils.wc.eventbus,a=ow.utils.wc.store,o=ow.utils.wc.inventory,i=(ow.utils.wc.owutils,Backbone.View.extend({location:"header",events:{"click .set-my-store-link":"setPreferredStore","click .yourstore .duplicate-suburb-link":"displaySelectedSuburb","click .set-pickup-store-link":"setPickupLocation"},initialize:function(){var r=this;this.storeLocatorUtil=new t,this.onDemandGmap=new e,this.onDemandGmap.initialize(),_.bindAll(this),$(document).on("clickncollectFormIsLoaded",r.initValidations),this.options.location&&(this.location=this.options.location)},initValidations:function(){$("#find-store").validate({rules:{headerstoreinput:{required:!0,maxlength:{param:4,depends:function(e){var t=$.trim($(e).val());return/^\d+$/.test(t)}},minlength:{param:4,depends:function(e){var t=$.trim($(e).val());return/^\d+$/.test(t)}}}},messages:{headerstoreinput:{required:"Enter suburb or postcode",maxlength:"Postcodes must have 4 digits",minlength:"Postcodes must have 4 digits"}},onfocusout:!1,focusInvalid:!1,focusCleanup:!0,onkeyup:function(e,t){13!=t.which&&($(e).popover("destroy"),this.resetForm())},submitHandler:function(){return self.doSubmitFindAddress(),!1}})},setPickupLocation:function(e){e.preventDefault();var t=$(e.currentTarget).data("storeid");r.trigger("DeliveryUpdate",{physicalStoreId:t,shipModeId:1e4})},displaySelectedSuburb:function(e){e.preventDefault();var t=$(e.target).data("suburb"),r=t.indexOf(",");r>0&&(t=t.substring(0,r)),this.findStoresByAddress(t)},doSubmitFindAddress:function(){$("#header .change-store-btn").attr("disabled",!0),this.showAnimation();var e=$(".input-postcode").val();return""===e?void $(".input-postcode").focus():void this.findStoresByAddress(e)},findStoresByAddress:function(e){var t=this;$.when(this.storeLocatorUtil.findNearbyStoresByAddress(e)).done(function(e){if(void 0!=e.suburbs)t.showSuburbSelection(e);else{var r=t.storeLocatorUtil.getOWStores(e);t.render(null!=r&&r.length>0?r:null)}})},showSuburbSelection:function(e){this.hideAnimation(),this.multiSuburbTemplate=Handlebars.templates.changeStoreLocationsTemplate;var t=this.multiSuburbTemplate(e);$(".change-store .stores-list").empty(),this.$el.find(".change-store-menu").append(t),$("#header .change-store-btn").attr("disabled",!1)},render:function(e){var t=this;null!=e&&$.each(e,function(){this.header="header"==t.location?!0:!1,this.storeLocatorViewURL=ow.url.storeLocatorViewURL.replace(/&amp;/g,"&")}),this.hideAnimation(),this.template=Handlebars.templates.changeStoreTemplate;var r=this.template(e);$(".change-store .stores-list").empty(),this.$el.find(".change-store-menu").append(r),$("#header .change-store-btn").attr("disabled",!1)},setPreferredStore:function(e){this.$el.find(".change-store").removeClass("open"),e.preventDefault();var t=$(e.target).data("storeid");a.setStore(t,function(e){e&&(r.trigger("setPrefStore",e),o.update()),$(".loader").length>0&&setTimeout(function(){$(".loader").hide()},1e3)}),$(".stores-list").empty(),$(".find-store .input-postcode").val("")},showAnimation:function(){$(".stores-list").remove(),$(".setting-store-msg").hide(),!this.$el.find(".change-store-menu .change-store-searching").length>0&&this.$el.find(".change-store-menu").append('<ul class="change-store-searching"><li>Searching for stores...</li></ul>')},hideAnimation:function(){$(".change-store-searching").remove()}}));return i}(),ow.controls.checkoutquantitycontrol=function(){var e=ow.utils.wc.eventbus,t=Backbone.View.extend({minimum:0,maximum:999,events:{"click .quantity-control .chplus":"clickPlus","click .quantity-control .chminus":"clickMinus","keydown .quantity-control input.quantity_input":"validate","blur .quantity-control input.quantity_input":"validateAndSubmit"},initialize:function(){_.bindAll(this);var e=this;$("input.quantity_input").each(function(){$(this).attr("maxlength",e.maximum.toString().length)})},setValue:function(t,r,a,o,i,n,s,c,l){t.val(r);var d=t.data("orderitem_id"),u="addon-productInsuranceFor";if(!a){var p={orderitem_id:d,quantity:r,source:this,extraCoverLabel:o,extraCoverForQty:i,assemblyLabel:c,assemblyQty:l};ow.state.productInsuranceEnabled&&(p[u]=n,p[s]=s),e.trigger("QuantityControl:change",p)}},clickPlus:function(e){var t=e.currentTarget,r=($(t).data("name"),$(t).data("orderitem_id"),$(t).data("catentryid")),a=$(t).data("extracoverfor"),o=$(t).data("extracoverforqty"),i="",n="";ow.state.productInsuranceEnabled&&(i=$(t).data("productinsurancefor"),n=$(t).data("productinsuranceforqty"));var s=$(t).data("assemblyfor"),c=$(t).data("assemblyforqty");if(this.updateCMAddToCartCookie(t),!$(t).hasClass("disabled")){var l=$(t).data("ismodal"),d=$("#"+$(t).data("for")).val();d=Math.min(this.maximum,++d),this.setValue($("#"+$(t).data("for")),d,l,r+"_"+a,o,r+"_"+i,n,r+"_"+s,c)}},clickMinus:function(e){var t=e.currentTarget,r=($(t).data("name"),$(t).data("orderitem_id"),$(t).data("catentryid")),a=$(t).data("extracoverfor"),o=$(t).data("extracoverforqty"),i="",n="";ow.state.productInsuranceEnabled&&(i=$(t).data("productinsurancefor"),n=$(t).data("productinsuranceforqty"));var s=$(t).data("assemblyfor"),c=$(t).data("assemblyforqty");if(this.updateCMAddToCartCookie(t),!$(t).hasClass("disabled")){var l=$(t).data("ismodal"),d=""!=$(t).data("maxquantity")?$(t).data("maxquantity"):"";if(d)this.setValue($("#"+$(t).data("for")),d,l,r+"_"+a,o,r+"_"+i,n,r+"_"+s,c);else{var u=$("#"+$(t).data("for")).val();u=Math.max(this.minimum,--u),this.setValue($("#"+$(t).data("for")),u,l,r+"_"+a,o,r+"_"+i,n,r+"_"+s,c)}}},updateCMAddToCartCookie:function(e){var t=$.cookie("cmAddToCartSessionCookie");if(t&&!$.isEmptyObject(t)){for(var r=JSON.parse(t),a=$(e).attr("data-partNumber"),o=0;o<r.length;o++){var i=Object.keys(r[o])[0];if(i==a){var n=r[o][i].split(",");n[0]="Shopping Cart",n[1]="Shopping Cart",r[o][i]=n.join()}}$.cookie.raw=!0,$.cookie("cmAddToCartSessionCookie",JSON.stringify(r),{path:"/"}),$.cookie.raw=!1}},validate:function(e){var t=e.originalEvent,r=e.currentTarget;46==t.keyCode||8==t.keyCode||9==t.keyCode||27==t.keyCode||13==t.keyCode||65==t.keyCode&&t.ctrlKey===!0||t.keyCode>=35&&t.keyCode<=39||((t.shiftKey||(t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105))&&t.preventDefault(),$(r).val()<this.minimum&&$(r).val(this.minimum),$(r).val()>this.maximum&&$(r).val(this.maximum))},validateAndSubmit:function(t){var r=t.currentTarget;if(!$(t.currentTarget).attr("data-ismodal")&&1!=$(r).parents(".prod-sub").length){this.validate(t);var a=$(r).data("orderitem_id"),o=$(r).val(),i=$(r).data("catentryid"),n=$(r).data("extracoverfor"),s=$(r).data("extracoverforqty"),c="",l="";ow.state.productInsuranceEnabled&&(c=$(r).data("productinsurancefor"),l=$(r).data("productinsuranceforqty"));var d=$(r).data("assemblyfor"),u=$(r).data("assemblyforqty");1==!$(r).parents(".prod-sub").length&&e.trigger("QuantityControl:change",{orderitem_id:a,quantity:o,source:this,extraCoverLabel:i+"_"+n,extraCoverForQty:s,productInsuranceLabel:i+"_"+c,productInsuranceForQty:l,assemblyLabel:i+"_"+d,assemblyQty:u})}}});return t}(),ow.controls.comparecontrol=function(){function e(e){this.el=e,this.bindEvents(e)}var t={added:{addClass:"btn-primary",removeClass:"btn-default",txt:"Added to Compare"},notAdded:{addClass:"btn-default",removeClass:"btn-primary",txt:"Add to Compare"}},r=ow.utils.compareUtils,a=ow.utils.wc.eventbus;return e.prototype={bindEvents:function(){$(this.el).on("click","button.ow-add-to-compare",this.addProduct.bind(this)).on("click",".ow-compare-remove",this.removeProduct.bind(this)).on("click",".ow-compare-removeAll",this.removeAll.bind(this)),a.on("notifyExpired",this.removeAll.bind(this))},render:function(){if("undefined"!=typeof ow.state.productComarisonEnabled&&"true"===ow.state.productComarisonEnabled&&$(this.el).hasClass("ow-compare-button")){var e=this.el.attr("data-identifier"),t=this.el.attr("data-img-src"),a=r.getCompareProducts(),o=r.hasCompareProduct(e,a.products),i=Handlebars.templates.compareButtonTemplate;this.el.html(i({identifier:e,image:t}));var n=this.el.find(".ow-add-to-compare");o?this.updateState(n,"added"):this.updateState(n,"notAdded")}},updateState:function(e,r){var a=t[r];"undefined"!=typeof e&&"undefined"!=typeof a&&(e.removeClass(a.removeClass).addClass(a.addClass),e.find("span").html(a.txt))},addProduct:function(e){var t=$(e.currentTarget),o=t.attr("data-identifier"),i=t.attr("data-img-src"),n=r.getCompareProducts({notifyExpired:!0});if("undefined"!=typeof n.expired&&n.expired&&(r.notifyExpired(),a.trigger("notifyExpired")),r.hasCompareProduct(o,n.products))t.trigger("buttonfailed");else if(n.products||(n.products=[]),n.products.length<5){n.products.push({identifier:o,img:i}),r.saveCompareProducts(n),this.updateState(t,"added"),a.trigger("addToCompare");var s=n.products.map(function(e){return e.identifier});r.sendAnalytics("AddToCompare",s,o)}else $(document).trigger("alert",{type:"warning",html:"<strong>Sorry!, you can only compare a maximum of 5 items at a time. To compare another item, please remove one from your list.</strong>",dismissible:!0,scrollTo:!0,trackState:!1,floating:!0,timeout:2500,insert:{method:"prependTo",selector:"body"}}),t.trigger("buttonfailed")},removeAll:function(){r.saveCompareProducts({}),a.trigger("removeFromCompare"),$(".ow-add-to-compare").each(function(e,t){this.updateState($(t),"notAdded")}.bind(this)),r.sendAnalytics("RemoveAllFromCompare")},removeProduct:function(e){var t=$(e.currentTarget),o=t.attr("data-identifier"),i=r.getCompareProducts({notifyExpired:!0});"undefined"!=typeof i.expired&&i.expired&&(r.notifyExpired(),a.trigger("notifyExpired"));var n=r.getCompareProductIndex(o,i.products);n>-1&&(i.products.splice(n,1),r.saveCompareProducts(i));var s=i.products.map(function(e){return e.identifier});a.trigger("removeFromCompare"),$("body").find(".tooltip").remove(),$(".ow-add-to-compare").each(function(e,t){var r=$(t);r.attr("data-identifier")===o&&this.updateState(r,"notAdded")}.bind(this));var c="Page";$(t.parent().hasClass("compare-tray-product"))&&(c="Panel"),r.sendAnalytics("RemoveFromCompare",s,o,c)}},$(document).on("contentloaded",function(){$(".ow-compare-button,#comparetray").each(function(){var t,r=$(this);r.data("_compareControl")instanceof e||(t=new e(r),t.render(),r.data("_compareControl",t),r.trigger("componentloaded",["compareControl",t]))})}),e}(),ow.controls.comparetray=function(){function e(e){this.el=e,this.bindEvents(),this.init()}function t(e){"undefined"==typeof e&&(e=[]);for(var t=e.map(r);t.length<5;)t.push(new a);return t}function r(e){return new a(e)}function a(e){e&&(this.image=e.img,this.identifier=e.identifier)}var o=ow.utils.compareUtils,i=ow.url.productCompareURL,n=ow.utils.wc.eventbus;e.prototype={bindEvents:function(){$(document).on("click",".ow-compare-products",this.navToCompare.bind(this))},init:function(){this.data={},_.bindAll(this),this.update(),n.on("addToCompare",this.update.bind(this)),n.on("removeFromCompare",this.update.bind(this)),n.on("notifyExpired",this.update.bind(this))},update:function(){var e=o.getCompareProducts();this.data.hasProducts=e.products&&e.products.length>0,this.data.canNav=e.products&&e.products.length>1,this.data.count=e.products&&e.products.length>0?e.products.length:0,this.data.products=t(e.products),this.render()},render:function(){if("undefined"!=typeof ow.state.productComarisonEnabled&&"true"===ow.state.productComarisonEnabled){var e=Handlebars.templates.compareTrayTemplate;this.el.html(e(this.data)),this.data.hasProducts?$("body").addClass("ow-compare-tray-active"):$("body").removeClass("ow-compare-tray-active")}},navToCompare:function(){var e=o.getCompareProducts({notifyExpired:!0});"undefined"!=typeof e.expired&&e.expired&&(o.saveCompareProducts({}),o.notifyExpired(),n.trigger("notifyExpired")),e.products&&e.products.length>1&&(window.location=i)}},a.prototype={get hasImage(){return"undefined"!=typeof this.image},get hasIdentifier(){return"undefined"!=typeof this.identifier}},$(document).on("contentloaded",function(){$(".ow-compare-button").length>0&&$("#comparetray").each(function(){var t,r=$(this);r.data("_comparetray")instanceof e||(t=new e(r),r.data("_comparetray",t),r.trigger("componentloaded",["comparetray",t]))})})}(),ow.controls.deliverytoolcontrol=function(){var e=ow.utils.wc.owutils,t=Backbone.View.extend({el:"#delivery",events:{"click #calculateDeliveryButton":"calculateDelivery","keydown #postcode":"validateKeyPress"},initialize:function(){_.bindAll(this)},calculateDelivery:function(){$("#calculateDeliveryForm").find("#postcode").removeClass("error");var t=$("#calculateDeliveryForm").find("#postcode").val(),r=$("#calculateDeliveryForm");if(t.match(/^[0-9]{4}$/)){var a=($("#calculateDeliveryForm").find("#customerType").val(),$("#calculateDeliveryForm").serialize());$.post(e.noCommentURL(ow.url.calculateDeliveryUrl),a).done(function(e){if(void 0==e.result)return $('<label class="error">Error getting information</label>').insertAfter(r),!1;if(void 0!=e.result.error)return $('<label class="error">'+e.result.error+"</label>").insertAfter(r),!1;var t=Handlebars.compile($("#deliveryInfoTemplate").html()),a=t(e.result);$("#delivery").find("#deliveryInfo").html(a)})}else $("#calculateDeliveryForm").find("#postcode").addClass("error")},validateKeyPress:function(e){var t=e.originalEvent;t.which>=48&&t.which<=57||t.which>=96&&t.which<=105||8==t.which||46==t.which||9==t.which||27==t.which||t.which>=35&&t.which<=39||t.preventDefault(),13==t.which&&(t.preventDefault(),this.calculateDelivery())}});$(function(){new t({el:$(document)})})}(),ow.controls.espotProductRecsControl=function(){var e=(ow.controls.productCarouselControl,{});return e.findProductEspotAndDisplay=function(){$("div.product-recommendation-espot").each(function(){var e=$(this).data("product-recommendation-data");if(void 0!=e)try{var t=JSON.parse(e);if($.trim(t.SKUs)){var r=$(this).closest(".ow-espot");if("true"!==r.data("carosel-loaded")){var a=r.attr("id");t.targetDivId=a,ow.controls.productCarouselControl.showProductCarousel(t),r.data("carosel-loaded","true")}}}catch(o){console.log("Error parsing ESPOT product recs data: "+o)}}),$("div.product-external-managed-recs-espot").each(function(){var e=ow.url.absoluteURL+"OWGetProductRecsSettingJson?",t=$(this).attr("data-categoryidentifier"),r={nc:"true",categoryIdentifier:t};e+=$.param(r),$.getJSON(e).done(function(e){if(void 0!=e&&void 0!=e.result&&e.result.length>0)try{var r=e.result[0];if($.trim(r.SKUs)){var a="extCategoryRecs_"+t;r.targetDivId=a,ow.controls.productCarouselControl.showProductCarousel(r)}}catch(o){console.log("Error parsing ESPOT product recs data: "+o)}})})},$(function(){e.findProductEspotAndDisplay()}),e}(),ow.controls.facetcontrol=function(){var e=(ow.utils.wc.owutils,Backbone.View.extend({events:{"click #productsFacets input":"selectFacet"},selectFacet:function(){var e=ow.pages.listingpage.getOptions(),t=[];$(this.el).find("#productsFacets input:checked").each(function(r,a){var o={key:$(a).attr("data-facet"),name:$(a).attr("data-facetname"),value:$(a).attr("data-facetvalue")};t.push(o),e.searchTerm=o.value}),e.facets=t,this.gotoSearchResultPage(e)},gotoSearchResultPage:function(e){ow.utils.localStorageUtil.sessionStorage("options",e),window.location.href=ow.url.subcategorypageSearchDisplayURL+"&searchTerm="+encodeURIComponent(e.searchTerm)},updateFacetCount:function(e){var t=Handlebars.templates.subCategoryFacetTemplate;$(this.el).find("#categoryProductsFacets").html(t(e))},initialize:function(){void 0!=ow.state.updateFacetCount&&this.updateFacetCount(ow.state.updateFacetCount)}}));return e}(),ow.controls.fastPayControl=function(){var e=(ow.utils.wc.eventbus,ow.utils.wc.owutils),t=ow.utils.wc.commonUtils,r=ow.utils.wc.addressUtil,a={storeId:ow.state.storeId,catalogId:ow.state.catalogId,langId:ow.state.langId},o=({fastPayConfig:e.noCommentURL(ow.url.fastPayConfigUrl)},function(){var e=$.Deferred();return $.get(t.noCommentURL(ow.url.ajaxdeliverysectionURL),{isShippingDetails:"True",isAddress:"True"}).done(function(t){e.resolve(t)}).fail(function(t){e.reject(t)}),e}),i=function(){var t=$.Deferred();return $.get(e.noCommentURL(ow.url.fastPayConfigUrl),{action:"getSummary"}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t},n=Backbone.View.extend({events:{},fpConfig:{},initialize:function(){var e=this;_.bindAll(this),$("#fastPayCheckout button").length>0&&$(document).on("contentloadedFP",function(t,r){e.loadFPButton(t,r)}).on("ready",function(){$("#fastPayCheckout button").on("click",function(){e.fastPayCheckout()})})},showFastPayButtonErrorMsg:function(e){$(".checkout-express-pay-errors").hasClass("hidden")&&$(".checkout-express-pay-errors").removeClass("hidden"),$(".checkout-express-pay-errors").find("div.media-body").html(e)},disableFastPayButton:function(){$("#fastPayCheckout button").attr("disabled","disabled")},getAddress:function(e){var t="";return e&&(t=e.clickAndCollect?"<strong>Pick up from: </strong>"+e.phyStoreName:"<strong>Deliver to: </strong>"+e.address.address1),t},loadFPButton:function(){e.loader("show",".ow-well.checkout-express-pay-well","ow-loading--medium");var t=this;$(".checkout-express-pay-errors").hasClass("hidden")||$(".checkout-express-pay-errors").addClass("hidden");var r=$("#fastPayCheckout button").attr("disabled");"undefined"!=typeof r&&r!==!1&&$("#fastPayCheckout button").removeAttr("disabled"),$.when(i(),o()).then(function(r,a){t.fpConfig=r;var o=t.getAddress(r);return $(".checkout-express-pay-well-details").html('<div class="credit-card" data-ellipsis="1">'+r.maskedCard+'</div><div class="address" data-ellipsis="1">'+o+"</div>"),$(document).trigger("contentloaded"),t.isCardExpired(r.expiry)?(t.showFastPayButtonErrorMsg("Expired Credit Card, please change to another saved credit card in your account or save a new credit card on the payment step and update your "+ow.state.fastPayName+" details."),t.disableFastPayButton(),void e.loader("hide",".ow-well.checkout-express-pay-well")):(a.owOrderBean&&a.owOrderBean.orderView?(a.owOrderBean.orderView.containsMailmanPrintYourOwn||a.owOrderBean.orderView.containsOnlineDeliveryProducts||a.owOrderBean.orderView.containsSwmsProduct)&&(t.disableFastPayButton(),t.showFastPayButtonErrorMsg(ow.state.fastPayName+" is unavailable for Mailman and Software Downloads.")):t.disableFastPayButton(),void e.loader("hide",".ow-well.checkout-express-pay-well"))},function(r){e.loader("hide",".ow-well.checkout-express-pay-well");try{var a=JSON.parse(r.responseText);t.showFastPayButtonErrorMsg("_ERR_ADDRENTRY_NOT_FOUND"===a.errorMessageKey?"Your "+ow.state.fastPayName+" address does not match any address in your Address Book.<br/>Please update your "+ow.state.fastPayName+" profile and try again.":"Sorry! "+ow.state.fastPayName+" is not available at this moment. Please use normal checkout.")}catch(o){t.showFastPayButtonErrorMsg("Sorry! "+ow.state.fastPayName+" is not available at this moment. Please use normal checkout.")}t.disableFastPayButton()})},fastPayCheckout:function(){var t=this,r={orderId:ow.state.currentOrderId};return r=$.extend(r,a),e.loader("show","body"),!t.fpConfig.clickAndCollect&&t.shippingAddressContainsPOBox()?(e.loader("hide","body"),void t.showMsg("Your address contains PO Box. Please change your address and then try again.")):void $.post(e.noCommentURL(ow.url.absoluteURL+"FastPayCheckoutCmd"),r).done(function(e){window.location=ow.url.absoluteURL+"OrderShippingBillingConfirmationView?catalogId="+a.catalogId+"&storeId="+a.storeId+"&langId="+a.langId+"&orderId="+e.orderId}).fail(function(r){var a="Sorry! An error has occurred processing your order. Please use normal checkout to place your order at this time.";try{var o=JSON.parse(r.responseText);"_ERR_ADDR_HAS_POBOX"===o.errorMessageKey?a="Sorry! Your address contains PO BOX. Please change your address and try again.":"_ERR_PROD_NOT_ORDERABLE_USING_FASTPAY"===o.errorMessageKey?a="Sorry! Please use normal checkout flow to order Mailman or Downloadable products.":"_ERR_INV_MAX_QTY_EXCEEDED"===o.errorMessageKey?a="Sorry! Requested quantity exceeds maximum orderable quantity. Please reduce the quantity and try again.":"_ERR_PROCESSING_ORDER_ITEM_INVENTORY"===o.errorMessageKey?a="Sorry! Some of the items in your shopping cart are out of stock. Please remove highlighted items and proceed.":"_ERR_ADDRENTRY_NOT_FOUND"===o.errorMessageKey?a="Your "+ow.state.fastPayName+" address does not match any address in your Address Book.<br/>Please update your "+ow.state.fastPayName+" profile and try again.":"_CREDIT_CARD_EXPIRED"===o.errorMessageKey&&(a="Sorry! Your selected "+ow.state.fastPayName+" Credit card has expired. Please setup your "+ow.state.fastPayName+" and try again.")}catch(i){a=a||"Sorry! An error has occurred processing your order. Please use normal checkout to place your order at this time."}e.loader("hide","body"),t.showMsg(a)})},showMsg:function(e){$(document).trigger("alert",{type:"danger",html:"<strong>"+e+"</strong>",dismissible:!0,scrollTo:!0,trackState:!1,floating:!0,timeout:15e3,insert:{method:"prependTo",selector:"body"}})},shippingAddressContainsPOBox:function(){var e=this.fpConfig.address.address1,t=this.fpConfig.address.buildingNumber;return r.addressContainsPOBox(e)||r.addressContainsPOBox(t)?!0:!1},isCardExpired:function(e){var t=new Date("20"+e.split("/")[1],e.split("/")[0]),r=new Date,a=Math.floor((t-r)/864e5);return 0>a?!0:!1}});return n}(),ow.controls.headerlogincontrol=function(){var e=ow.utils.wc.eventbus,t=ow.utils.wc.owutils,r=ow.utils.wc.commonUtils,a=(ow.utils.wc.myaccountUtil,Backbone.View.extend({events:{"click .logout":"clearSessionStorageOptions","click .logOffBehalf":"logOffBehalf"},initialize:function(){var e=this;_.bindAll(e),e.buildHeaderLogonForm(),$(".header-login-form").validate({submitHandler:function(t){var r="https:"+window.location.href.substring(window.location.protocol.length);r=r.replace("#","");var a=$('form input[name="URL"]').val(),o=-1!=r.indexOf("UserRegistrationForm");0==o&&(a=a.replace("URL=officeworks","URL="+r)),$('form input[name="URL"]').val(a),e.clearSessionStorageOptions(),t.submit()}})},buildHeaderLogonForm:function(){"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(e){var t=!("undefined"==typeof e||"undefined"==typeof e.userType||null==e.userType||"G"===e.userType);if(t){var r,a=ow.url.LogoffURL;("true"===$.cookie("fra.catalogue")||"1"===$.cookie("fra_catalogue")||"1"===$.cookie("force_fra_catalogue"))&&(a=a.replace("URL=officeworks","URL=/")),"true"===e.thirtyDayAccountEnabled&&(r=ow.url.myInvoicesURL);var o=Handlebars.templates.headerLoggedIn,i={firstName:e.firstName,lastName:e.lastName,email:e.email,userRegistrationFormURL:ow.url.userRegistrationFormURL,LogoffURL:a,myInvoicesURL:r,trackOrderStatusURL:ow.url.trackOrderStatusURL,userRegistrationFormURL:ow.url.userRegistrationFormURL,interestItemDisplayURL:ow.url.interestItemDisplayURL,MyAccountURL:ow.url.MyAccountURL,OrderTemplateListURL:ow.url.OrderTemplateListURL,langId:ow.state.langId,storeId:ow.state.storeId,catalogId:ow.state.catalogId,myAccountMenuJson:ow.url.customerSidebarURL},n=Handlebars.templates.headerOWTM;
(e.isCustomerServiceRep||e.isCustomerServiceRepActingAsCustomer)&&(e.MemberSearchListURL=ow.url.MemberSearchListURL,e.LogoffURL=a,e.RestoreOriginalUserSetInSessionURL=ow.url.RestoreOriginalUserSetInSessionURL,$(n(e)).insertBefore("#header"),$(document).trigger("contentloaded"));var s=o(i);$("#ow-my-account-header").html(s);var c=Handlebars.templates.headerMobileLoggedIn,l=c(i);$("#ow-my-account-header-mobile").html(l);var d=Handlebars.templates.headerMobileMyAccountLoggedIn,u=d(i);$("#mobileMenuMyAccount").html(u),$("#header-login-label").html("My Account")}else{var o=Handlebars.templates.headerGuestLogon,i={secureLogonURL:ow.url.secureLogonURL,orderMoveURL:ow.url.orderMoveURL,registerURL:ow.url.registerURL,logonFormURL:ow.url.logonFormURL,forgetPasswordURL:ow.url.forgetPasswordURL,langId:ow.state.langId,storeId:ow.state.storeId,catalogId:ow.state.catalogId},s=o(i);$("#ow-my-account-header").html(s);var c=Handlebars.templates.headerMobileGuest,l=c(i);$("#ow-my-account-header-mobile").html(l),$("#header-login-label").html("Log In")}$(document).trigger("headerloaded")})},retrieveCustomerSideBarDetails:function(){0==$("#mobileMyAccountSideMenuLink li").length&&r.ajaxGet(t.noCommentURL(ow.url.customerSidebarURL),{},function(e){e.activePage=ow.state.activeMyAccountPage;var t=Handlebars.templates.headerMobileMyAccountLoggedInSidebar,r=t(e);$("#mobileMyAccountSideMenuLink").html(r),null!==e.activePage?($("#mobile-menu").data("_mobile-menu",null),$(document).trigger("contentloaded"),_.isEmpty(e.activePage)&&$("#mobileMyAccountLink").trigger("click")):$(document).trigger("contentloaded")})},logOffBehalf:function(){var e=this;e.clearSessionStorageOptions(),location.href=t.noCommentURL(ow.url.logoffBehalfURL)},clearSessionStorageOptions:function(){ow.utils.localStorageUtil.sessionStorageRemove("options"),e.trigger("clearUserDataCache")}}));return a}(),ow.controls.imagedisplaycontrol=function(){var e=(ow.utils.wc.eventbus,Backbone.View.extend({el:".product-images",events:{"click #main-product-image":"imageZoom","click .btn-zoom":"imageZoom","click .thumbnail":"thumbnailClick","mousedown .ts_holder":"removeDragToSpin"},gallery:[],largeImages:null,preload:[],index:0,initialize:function(){-1!=navigator.userAgent.indexOf("MSIE 10")&&void 0!=ow.state.array360&&(ow.state.array360Sml=ow.state.array360Sml.replace(/https:\/\//g,"http://")),_.bindAll(this);$("#container-360").length>0?(this.mainImage=$("#main-product-image").attr("src"),this.largeImages=ow.state.array360Lrg,$("#main-product-image").tsRotate({nophp:!0,nophpimglist:ow.state.array360Sml,zoom:!1,disablelogo:!0,wheelRotate:!0,onLoad:function(){$("#drag-to-spin").fadeIn(),$("#rotate-360").fadeIn()}})):this.gallery=ow.state.largeImages},attributeChange:function(e){var t=this,r=e.catalogEntry.description[0].mainimage,a=e.catalogEntry.description[0].attachmentimages,o=r.split("/").pop(),i=e.catalogEntry.description[0].name;$(this.el).find("#main-product-image").attr("src",this.imagePath+this.imageFolders.medium+o),this.gallery=[],this.gallery.push({href:this.imagePath+this.imageFolders.large+o});var n=0;$(this.el).find("ul.thumbnails").empty(),$(this.el).find("ul.thumbnails").append('<li class="span4"><div class="thumbnail" data-index="'+n+'"><img src="'+this.imagePath+this.imageFolders.small+o+'" alt="'+i+'"></div></li>'),$(a).each(function(){n++;var e=this.split("/").pop();$(t.el).find("ul.thumbnails").append('<li class="span4"><div class="thumbnail" data-index="'+n+'"><img src="'+t.imagePath+t.imageFolders.small+e+'" alt="'+i+'"></div></li>'),t.gallery.push({href:t.imagePath+t.imageFolders.large+e})})},thumbnailClick:function(e){this.index=$(e.currentTarget).data("index"),this.$el.find("#main-product-image").attr("src",ow.state.mediumImages[this.index]),$(e.currentTarget).parents(".thumbnails").find(".thumbnail").removeClass("active"),$(e.currentTarget).addClass("active")},removeDragToSpin:function(e){$(e.currentTarget).parent().find(".drag-to-spin").remove()},imageZoom:function(){var e=this,t={closeBtn:'<button class="btn btn-small btn-secondary" href="#">X</button>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span class="carousel-control right"></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span class="carousel-control left"></span></a>'};if($("#container-360").length>0){var e=this,r=ow.state.mainImageLrg;$.fancybox.open(r,{padding:0,tpl:t,onUpdate:function(){$(".fancybox-inner .ts_holder").length>0&&($(".fancybox-inner .ts_holder").remove(),$(".fancybox-inner .fancybox-image-backup").addClass("fancybox-image").removeClass("fancybox-image-backup").show());var t=$(".fancybox-inner").height(),r=$(".fancybox-inner").width();$(".fancybox-image").attr("height",t).attr("width",r),$(".fancybox-image").clone().addClass("fancybox-image-backup").removeClass("fancybox-image").appendTo(".fancybox-inner").hide(),$(".fancybox-image").tsRotate({nophp:!0,nophpimglist:e.largeImages,zoom:!1,disablelogo:!0,wheelRotate:!0,onLoad:function(){$(".fancybox-inner").append('<div class="drag-to-spin" title="Drag to rotate image"></div>'),$(".fancybox-inner .drag-to-spin").css("left",$(".fancybox-inner").width()/2-$(".drag-to-spin").width()/2),$(".fancybox-inner").append('<div class="tag rotate-360" title="Drag to rotate image"></div>')}}),$(".fancybox-inner .ts_holder").mousedown(function(t){e.removeDragToSpin(t)})}})}else $.fancybox.open(this.gallery,{padding:0,index:this.index,tpl:t,helpers:{thumbs:{width:69,height:69,position:"image"}}})}}));return e}(),ow.controls.inkandtonercontrol=function(){var e,t=ow.utils.wc.owutils,r=ow.utils.wc.inventory,a=Backbone.View.extend({rowSize:4,events:{"change .choose-printer select":"changeSelector","click #InkAndTonerSearchForm .btn-search":"search"},changeSelector:function(e){var t=$(e.currentTarget).data("type"),r=$(e.currentTarget).val();ow.utils.localStorageUtil.sessionStorageRemove("inkResults"),this.populateSelector(t,r)},populateSelector:function(e,r){var a=this,o=($("#category_select"),$(".category_select"),$("#brand_select")),i=$(".brand_select"),n=$("#productSeries_select"),s=$(".productSeries_select"),c=$("#model_select"),l=$(".model_select"),d=[];"category"==e&&(o.find("option:gt(0)").remove(),l.addClass("hidden"),s.addClass("hidden")),"manufacturer"==e&&(n.find("option:gt(0)").remove(),l.addClass("hidden")),"product"==e&&c.find("option:gt(0)").remove(),$.post(t.noCommentURL(ow.url.absoluteURL+"AjaxInkTonerSelectorCmd"),{tonerParamType:e,tonerParamValue:r}).done(function(r){for(var u=0;u<r.result.tonerResults.length;u++)element=r.result.tonerResults[u],"category"==e&&(i.removeClass("hidden"),o.append($("<option />").val(element.code).text(element.value))),"manufacturer"==e&&(s.removeClass("hidden"),n.append($("<option />").val(element.code).text(element.value))),"product"==e&&(l.removeClass("hidden"),c.append($("<option />").val(element.code).text(element.value))),"model"==e&&d.push(element);$(parent.document).find("#inkandtonerframe").length>0&&a.resizeParent(),"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(e){if("undefined"!=typeof e&&"BUSINESS"===e.customerType)var r=ow.url.ajaxcategoryresultsbusinessviewurl;else var r=ow.url.ajaxcategoryresultsviewurl;d.length>0&&($.ajax({type:"get",url:t.noCommentURL(r),data:{partNum:d.join("|"),searchType:10,pageView:"grid",beginIndex:0,pageSize:100},success:function(e){ow.utils.localStorageUtil.sessionStorage("inkResults",e),a.displayResults(e)},error:function(){a.displayResults()}}),a.searchTerm=$('option[value="'+$("#model_select").val()+'"]').text(),ow.utils.localStorageUtil.sessionStorage("inkSearchTerm",a.searchTerm))}),$(document).trigger("contentloaded"),a.setOptionMargins()})},setOptionMargins:function(){$(".choose-printer .form-group:visible").css("margin-bottom","20px"),$(".choose-printer .form-group:visible:last").css("margin-bottom",0)},search:function(e){if(e.preventDefault(),$("#InkAndTonerSearchForm").valid()){t.loader("show",".ow-search-wrapper","ow-loading--top-aligned");var r=this,a=$("#InkAndTonerSearchForm_SearchTerm").val();"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(e){if("undefined"!=typeof e&&"BUSINESS"===e.customerType)var o=ow.url.ajaxcategoryresultsbusinessviewurl;else var o=ow.url.ajaxcategoryresultsviewurl;$.ajax({type:"get",url:t.noCommentURL(o),data:{searchTerm:a,searchType:10,pageView:"grid",beginIndex:0,pageSize:100},success:r.displayResults})}),this.searchTerm=a,ow.utils.localStorageUtil.sessionStorage("inkSearchTerm",this.searchTerm)}},displayResults:function(a){var o=$(".ow-search-options, .ow-search-header");if(!$.isEmptyObject(a)&a.totalCount>0){$("#InkAndTonerSearchForm .btn-search").trigger("buttoncomplete");var i=a,n={},s={};s.searchTitle=i.headerName,s.categoryDescription=_.unescape(i.headerDesc),s.searchCount=parseInt(i.searchCount),s.totalCount=parseInt(i.totalCount),s.preKeywordString=1===s.totalCount?"product found for":"products found for";var c=Handlebars.templates["search-header"];if($("#search-header").html(c(s)),n.pageView="list",t.getBreakpoint().indexOf("small")>-1&&(n.pageView="grid"),"list"==n.pageView)var l=Handlebars.templates["prodList-search"];if("grid"==n.pageView)var l=Handlebars.templates["prodGrid-search"];$(".ow-delivery-details-header").detach(),$("#productList").html(l(i)).promise().done(function(){e.getUserLocationControl().isBrowseAvailabilityPreferencesEnabled()&&e.displayUserLocationHeaderBar("#productList")}),o.removeClass("hidden"),t.loader("hide",".ow-search-wrapper"),ow.state.listingpage.setResultsJson(i)}else{$("#InkAndTonerSearchForm .btn-search").trigger("buttoncomplete");var d=$("#productList"),l=Handlebars.templates["noResults-search"];o.addClass("hidden"),d.html(l),ow.state.listingpage.setResultsJson({})}r.update()},resizeParent:function(){$(parent.document).find("#inkandtonerframe").css("height",$(document).height())},initSelector:function(){$("#brand_select, #productSeries_select, #model_select").hide()},initialize:function(){_.bindAll(this),e=ow.controls.userlocationview,$(".choose-printer select").prop("selectedIndex",0),$("#InkAndTonerSearchForm").validate({errorPlacement:function(e,t){e.appendTo(t.closest("form"))}}),this.setOptionMargins();var t=ow.utils.localStorageUtil.sessionStorage("inkSearchTerm");$.isEmptyObject(t)||(this.searchTerm=t);var r=ow.utils.localStorageUtil.sessionStorage("inkResults");return $.isEmptyObject(r)||this.displayResults(r),this}});return a}(),ow.controls.invoicecontrol=function(){var e=ow.utils.wc.owutils,t=ow.utils.wc.myaccountUtil,r=Backbone.View.extend({events:{"click .invoiceSelect":"invoiceSelect","click #btn-pay-invoices":"submitInvoicePay","click #invFilter":"loadPaidInvoice","click #invUnpaidFilter":"loadOpenInvoice","click .radio-payment-opt":"togglePaymentOption","click .creditSelect":"creditSelect","click .quickXDays":"selectXDays","click #clearInvoiceSelection":"clearInvoiceSelection","click #clearCreditSelection":"clearCreditSelection","click #dueInvoiceSelection":"dueInvoiceSelection"},initialize:function(){"displayOpenInvoice"==ow.state.invoiceAction?(ow.state.activeMyAccountPage="View unpaid invoices",this.loadOpenInvoice()):"displayPurchaseSummaries"==ow.state.invoiceAction?(ow.state.activeMyAccountPage="Purchase summaries",this.loadPurchaseSummaries()):"displayMonthlyStatements"==ow.state.invoiceAction?(ow.state.activeMyAccountPage="Monthly statements",this.loadMonthlyStatements()):"displayPaidInvoice"==ow.state.invoiceAction&&(ow.state.activeMyAccountPage="View paid invoices",this.loadPaidInvoice(),$(".invDate").datepicker({dateFormat:"dd/mm/yy",changeMonth:!0,changeYear:!0,yearRange:"c-10:c",maxDate:"0"})),t.retrieveAndSetMyAccountSideMenu()},submitInvoicePay:function(){var e=parseFloat($("#netPaymentTotal").val());if(0>e)return void $("#invalidAmountMsg").html('<span class="alert-error"><strong>Negative amounts cannot be paid</strong></span>').closest(".ow-alert").removeClass("hidden");if(isNaN(e)||0==e)return void $("#invalidAmountMsg").html('<span class="alert-error"><strong>Please select invoices to be paid</strong></span>');var t="",r=$('input[name="invInput"]').length;$('input[name="invInput"]').each(function(e){t+=$(this).attr("invId")+","+$(this).val()+","+$(this).attr("invAmt"),r-1>e&&(t+="|")}),$("#paymentInput").val(t);var a="",r=$('input[name="crdInput"]').length;$('input[name="crdInput"]').each(function(e){a+=$(this).attr("crdId")+","+$(this).val()+","+$(this).attr("amt"),r-1>e&&(a+="|")}),$("#creditInput").val(a),this.setupDeviceId(),$("#pay-invoices-form").submit()},setupDeviceId:function(){try{var e=function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?r:3&r|8).toString(16)});return t},t=e();if(t){var r=r||[];r.push(["ci",{sid:"608748bfb6c6f78b",tid:t}]),r.push(["run",("https:"==document.location.protocol?"https://":"http://")+"www.cdn-net.com"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://":"http://")+"www.cdn-net.com/cc.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),$(function(){$("#pay-invoices-form input[name=deviceId]").val(t)})}}catch(a){}},loadPaidInvoice:function(){if(!ow.state.loadingInvoiceInProgress){var t=$("#invFilter"),r=$("#invFrom").val().split("/"),a=new Date(r[1]+"/"+r[0]+"/"+r[2]),o=$("#invTo").val().split("/"),i=new Date(o[1]+"/"+o[0]+"/"+o[2]),n=-1;if(isNaN(i.getTime())||isNaN(a.getTime())||(n=(i.getTime()-a.getTime())/1e3/86400),$("#dateError").html(""),-1==n)return $("#dateError").html("Please check selected Date range."),void(t.hasClass("is-pending")&&t.trigger("buttoncomplete"));if(Math.floor(n)>90)return $("#dateError").html("Maximum number of days to search is 90 at a time."),void(t.hasClass("is-pending")&&t.trigger("buttoncomplete"));ow.state.loadingInvoiceInProgress=!0,e.loader("show","#invoice-display"),$.post(e.noCommentURL(ow.url.paidInvoiceUrl),{whoseOrder:$("input[name=whoseOrder]:checked").val(),branchBP:$("select[name=branchBP]").val(),dateFrom:$("#invFrom").val(),dateTo:$("#invTo").val()}).done(function(t){var r=Handlebars.templates.invoicePaidTemplate,a=$("#invoice-display"),o=$("#invFilter");t.owInvoicePaymentUrl=ow.url.owInvoicePaymentUrl,t.owInvoiceFileDisplay=ow.state.owInvoiceFileDisplay,a.empty(),o.hasClass("is-pending")&&o.trigger("buttoncomplete"),"undefined"!=typeof t.paidInvoice&&t.paidInvoice.length>0?a.html(r(t)):$(document).trigger("alert",{type:"info",html:"<p><strong>No paid invoices were found for your account</strong></p> <p>If you require assistance, please call customer service on <strong>1300 OFFICE</strong> or <strong>1300 633 423</strong> between 8 AM and 8 PM (AEST), Monday to Friday or 9 AM and 5 PM (AEST) Saturday to Sunday.</p>",dismissible:!1,trackState:!1,insert:{method:"prependTo",selector:"#invoice-display"}}),e.loader("hide","#invoices-inner-cont, #invoice-display")}).always(function(){ow.state.loadingInvoiceInProgress=!1})}},loadOpenInvoice:function(){if(!ow.state.loadingInvoiceInProgress){var t=this;e.loader("show","#invoices-inner-cont"),$("#invoice-display").empty(),ow.state.loadingInvoiceInProgress=!0,$.post(e.noCommentURL(ow.url.openInvoiceUrl),{whoseOrder:$("input[name=whoseOrder]:checked").val(),branchBP:$("select[name=branchBP]").val()}).done(function(r){var a=Handlebars.templates.invoiceOpenTemplate;r.storeId=ow.state.storeId,r.owInvoicePaymentUrl=ow.url.owInvoicePaymentUrl,r.owInvoiceFileDisplay=ow.state.owInvoiceFileDisplay;var o=$("#invUnpaidFilter");o.hasClass("is-pending")&&o.removeClass("is-pending"),"undefined"!=typeof r.unpaidInvoice&&r.unpaidInvoice.length>0?($("#invoice-display").html(a(r)),t.preTickInvoicesAndCreditsIfRequired(),ow.state.invoiceControl.setInvoiceTotal()):$(document).trigger("alert",{type:"info",html:"<p><strong>No open invoices were found for your account</strong></p> <p>If you require assistance, please call customer service on <strong>1300 OFFICE</strong> or <strong>1300 633 423</strong> between 8 AM and 8 PM (AEST), Monday to Friday or 9 AM and 5 PM (AEST) Saturday to Sunday.</p>",dismissible:!1,trackState:!1,insert:{method:"prependTo",selector:"#invoice-display"}}),e.loader("hide","#invoices-inner-cont")}).always(function(){ow.state.loadingInvoiceInProgress=!1})}},preTickInvoicesAndCreditsIfRequired:function(){var e=this,t=0,r=0,a=new Date;$(".invoiceSelect[data-status=PAYABLE]").each(function(e,r){var o=$(r).attr("dueDate"),i=o.split("-"),n=new Date(i[2],i[1]-1,i[0]);a>=n&&(t+=parseFloat($(r).attr("dueAmt").replace(/\$/g,"")))}),$(".creditSelect").each(function(e,t){r+=parseFloat($(t).attr("availAmt").replace(/\$/g,""))}),t+r>0&&($(".invoiceSelect[data-status=PAYABLE]").each(function(t,r){var o=$(r).attr("dueDate"),i=o.split("-"),n=new Date(i[2],i[1]-1,i[0]);a>=n&&(r.checked=!0,e.invoiceProcess(r))}),$(".creditSelect").each(function(t,r){r.checked=!0,e.creditProcess(r)}))},loadPurchaseSummaries:function(){e.loader("show","ow-content"),$.post(e.noCommentURL(ow.url.purchaseSummariesUrl)).done(function(t){var r=Handlebars.templates.purchaseSummaries;t.storeId=ow.state.storeId,t.purchaseSummaryURL=ow.url.purchaseSummaryURL,$("#purchase-summaries-display").html(r(t)),e.loader("hide","#invoices-inner-cont")})},loadMonthlyStatements:function(){e.loader("show","ow-content"),$.post(e.noCommentURL(ow.url.monthlyStatementsUrl)).done(function(t){var r=Handlebars.templates.monthlyStatements;t.storeId=ow.state.storeId,t.monthlyStatementURL=ow.url.monthlyStatementURL,$("#monthly-statements-display").html(r(t)),e.loader("hide","#invoices-inner-cont")})},invoiceSelect:function(e){var t=this;t.invoiceProcess($(e.currentTarget)),ow.state.invoiceControl.setInvoiceTotal()},invoiceProcess:function(e){var t=$(e).attr("invId"),r=$(e).attr("inv"),a=$(e).attr("amt").replace(/\$/g,""),o=$(e).attr("dueAmt").replace(/\$/g,"");$("#pay-"+r).html($(e).is(":checked")?'<input class="form-control ow-form-control--plain important" type="text" size="10" name="invInput" invId="'+t+'" invAmt="'+a+'"  value="'+o+'" disabled="disabled">':"")},setInvoiceTotal:function(){var e=0;$('input[name="invInput"]').each(function(){var t=parseFloat($(this).val());e=t+e}),$("#invTotal").html("$"+e.toFixed(2)),$("#paymentTotal").val(e.toFixed(2)),ow.state.invoiceControl.setNetPayment()},creditSelect:function(e){var t=this;t.creditProcess($(e.currentTarget)),ow.state.invoiceControl.setCreditTotal()},creditProcess:function(e){var t=$(e).attr("crdId"),r=$(e).attr("crd"),a=$(e).attr("amt").replace(/\$/g,""),o=$(e).attr("availAmt").replace(/\$/g,"");$("#crd-"+r).html($(e).is(":checked")?'<input class="form-control ow-form-control--plain important" type="text" size="10" name="crdInput" crdId="'+t+'" amt="'+a+'"  value="'+o+'" disabled="disabled">':"")},setCreditTotal:function(){var e=0;$('input[name="crdInput"]').each(function(){var t=parseFloat($(this).val());e=t+e}),$("#crdTotal").html("$"+e.toFixed(2)),$("#creditTotal").val(e.toFixed(2)),ow.state.invoiceControl.setNetPayment()},setNetPayment:function(){var e=$("#netPayTotal");$("#invalidAmountMsg").html("");var t=0;$('input[name="invInput"]').each(function(){var e=parseFloat($(this).val());t=e+t}),$('input[name="crdInput"]').each(function(){var e=parseFloat($(this).val());t=e+t}),e.html("<strong>$"+t.toFixed(2))+"</strong>",$("#netPaymentTotal").val(t.toFixed(2))},hideReg:function(){$("#direct-debit-request").hasClass("hide")||$("#direct-debit-request").addClass("hide")},togglePaymentOption:function(e){var t=$(e.currentTarget);$(".payment-type label").removeClass("active"),t.closest("label").addClass("active"),"DirectDebit"==$(t).val()?($("#dd-payment-cont").css("display","block"),$("#cc-payment-cont").css("display","none"),$("#ipg-payment-cont").css("display","none")):"IPG"==$(t).val()?($("#dd-payment-cont").css("display","none"),$("#cc-payment-cont").css("display","none"),$("#ipg-payment-cont").css("display","block"),$("#ipgContainerFrame").attr("src",$("input[name='ipgIframeURL']").val())):($("#dd-payment-cont").css("display","none"),$("#cc-payment-cont").css("display","block"),$("#ipg-payment-cont").css("display","none"))},selectXDays:function(e){var t=this;e.preventDefault();var r=e.currentTarget,a=new Date,o="dd/MM/yyyy";$("#invTo").val($.format.date(a,o)),$("#invFrom").val("last60Days"==r.id?$.format.date(new Date((new Date).setDate(a.getDate()-60)),o):"last90Days"==r.id?$.format.date(new Date((new Date).setDate(a.getDate()-90)),o):$.format.date(new Date((new Date).setDate(a.getDate()-30)),o)),t.loadPaidInvoice()},clearInvoiceSelection:function(e){e.preventDefault(),$("input.invoiceSelect:checked").click()},clearCreditSelection:function(e){e.preventDefault(),$("input.creditSelect:checked").click()},dueInvoiceSelection:function(e){e.preventDefault(),this.preTickInvoicesAndCreditsIfRequired(),ow.state.invoiceControl.setInvoiceTotal()}});return r}(),ow.controls.invoiceddregcontrol=function(){var e=ow.utils.wc.myaccountUtil,t=Backbone.View.extend({el:$(document),events:{},form:$("#direct-debit-form"),initialize:function(){_.bindAll(this),this.initValidation(),e.retrieveAndSetMyAccountSideMenu()},initValidation:function(){$("#direct-debit-form").validate({ignore:":hidden",rules:{bsbNumber:{minlength:6}}})}});return t}(),ow.controls.logincontrol=function(){var e=ow.utils.wc.eventbus,t=ow.utils.wc.owutils,r=Backbone.View.extend({el:".form-login",events:{"click .log-out":"clearSessionStorageOptions","click .logOffBehalf":"logOffBehalf"},initialize:function(){var e=this;_.bindAll(e),this.$el.validate({errorPlacement:function(e,t){t.attr("placeholder",e.text())},submitHandler:function(t){e.clearSessionStorageOptions(),t.submit()}})},logOffBehalf:function(){var e=this;e.clearSessionStorageOptions(),location.href=t.noCommentURL(ow.url.logoffBehalfURL)},clearSessionStorageOptions:function(){ow.utils.localStorageUtil.sessionStorageRemove("options"),e.trigger("clearUserDataCache")}});return r}(),ow.controls.mailmanlabelcontrol=function(){var e=ow.utils.wc.owutils,t=(ow.utils.wc.eventbus,ow.utils.wc.store,function(){var t=this;this.loadLabels=function(){var e=[];if($("[data-inventory]").each(function(){e.push($(this).attr("data-id"))}),e.length>0){for(var t=[],r=100;e.length>0;)t.push(e.splice(0,r));for(var a=t.length,o=0;a>o;o++){var i=t[o];this.loadLabelSelection(i)}}},this.loadLabelSelection=function(r){if("true"==ow.state.mailmanEnabled){var a=ow.state.mailmanItems;if(void 0!=a&&null!=a&&""!=a){for(var o=a.split(","),i=!1,n=0;n<r.length;n++){var s=r[n];if(null!=s&&s.length>0&&$.inArray(s,o)>-1){i=!0;break}}1==i&&$.ajax({method:"GET",url:e.noCommentURL(ow.url.absoluteURL+"OWMailmanLabelSelectionCmd?catentryIds="+r),success:function(e){t.updateLabelSelectionWithResponse(e)},error:function(){}})}}},this.updateLabelSelectionWithResponse=function(e){$.each(e.labelSelection,function(e,t){var r=(t.pyo,t.shelf,$("#mailmanLabelTypeMainDiv_"+t.pyo)),a=r.find("#mailmanLabelTypePyo_"+t.pyo),o=a.find("label");o.attr("data-othercatentryid",t.shelf);var i=r.find("#mailmanLabelTypeShelf_"+t.pyo),n=i.find("input"),s=i.find("label");n.val(t.shelf),n.attr("id","mailmanLabelType_"+t.shelf),s.attr("for","mailmanLabelType_"+t.shelf),r.show()})}});return t}(),ow.controls.mailmantrackingcontrol=function(){var e=ow.utils.wc.owutils,t=Backbone.View.extend({events:{},initialize:function(){_.bindAll(this),$("#trackParcel").validate({rules:{trackingNumber:{required:!0,remote:{type:"POST",url:e.noCommentURL(ow.url.absoluteURL+"OWMailmanLabelTrackingCmd"),data:{label:function(){return $("#trackingNumber").val().trim()}},dataFilter:function(e){try{var t=$.parseJSON(e);if(0==t.tracking.length)return!1;var r=ow.state.mailmanTrackingPageView+"&label="+$("#trackingNumber").val();window.location.href=r}catch(a){return!0}}}}},messages:{trackingNumber:{required:"Enter label number you need to track",remote:"Tracking information not available for label number entered."}},onkeyup:function(e,t){return 13!=t.which&&$("#trackingNumber").popover("destroy"),!1},onfocusout:!1,focusInvalid:!1,focusCleanup:!0})}});return t}(),ow.controls.marketingspotcontrol=function(){"use strict";var e=Backbone.View.extend({events:{"click .marketing-spot .well-cta":"goToLink","mouseenter .marketing-spot .well-cta":"setTitle"},setTitle:function(e){$(e.currentTarget).attr("title",$(e.currentTarget).find(".btn").text())},goToLink:function(e){window.location.href=$(e.currentTarget).find(".btn").attr("href")}});return e}(),ow.controls.paymentcontrol=function(){var e=ow.utils.wc.owutils,t=Backbone.View.extend({events:{"click .btn-paypal":"PIAddPayPalAndPunchOut","click .btn-afterpay":"afterpayPunchout","click #selectPayPalLink":"selectPayPal","click #selectCreditCardLink":"selectCreditCard","click a.popupLink":"showPopup"},showPopup:function(e){var t=$(e.currentTarget).attr("id");"showPrivacyPolicy"==t?$("#privacyPolicyPopUp").modal():"showPciFAQs"==t&&$("#pciFAQsPopUp").modal()},PIAddPayPalAndPunchOut:function(t){if(t.preventDefault(),"true"==$(t.currentTarget).attr("data-clicked"))return!1;$(t.currentTarget).attr("data-clicked","true"),$(t.currentTarget).text("Please Wait..."),$(t.currentTarget).attr("disabled","true");var r=$("#orderIdPayPal").val(),a=($("#piAmountPayPal").val(),$("#payMethodIdPayPal").val());$.ajax({type:"POST",url:e.noCommentURL(ow.url.absoluteURL+"OWPaymentInstructionCmd?orderId="+r+"&payMethodId="+a),success:function(e){var t=e.piId,a=ow.url.punchoutPaymentRedirectURL+"&orderId="+r+"&piId="+t;window.location.href=a}})},afterpayPunchout:function(e){e.preventDefault();var t=$(e.currentTarget);if("true"==t.attr("data-clicked"))return console.debug("afterpayPunchout clicked"),!1;var r=t.attr("data-order-id");t.attr("data-clicked","true",r),"undefined"!=typeof AfterPay?$.ajax({type:"GET",url:ow.url.absoluteURL+"PrepareOrderAfterpayPayment?storeId=10151&catalogId=10551&langId=-1&orderId="+r+"&requesttype=ajax",dataFilter:this.afterpayResponseFilter.bind(this)}).then(this.handleAfterpaySuccess.bind(this)).fail(this.handleAfterpayError.bind(this)).always(function(){t.removeAttr("data-clicked")}):this.displayAfterpayError({errorMessage:"Afterpay is unavailable at this time. Please try again later, or choose another payment option."})},afterpayResponseFilter:function(e){return e.replace("/*","").replace("*/","").trim()},handleAfterpaySuccess:function(e){e.afterpayToken?(AfterPay.init(),AfterPay.redirect({token:e.afterpayToken})):this.displayAfterpayError({errorMessage:"Afterpay is unavailable at this time. Please try again later, or choose another payment option."})},handleAfterpayError:function(e){var t=JSON.parse(this.afterpayResponseFilter(e.responseText));this.displayAfterpayError(t)},displayAfterpayError:function(e){$(".btn-afterpay").trigger("buttonfailed"),$("#AfterpayPunchout .ow-alert").remove(),$(document).trigger("alert",{type:"danger",html:e.errorMessage,dismissible:!0,scrollTo:!1,trackState:!1,floating:!1,insert:{method:"prependTo",selector:"#AfterpayPunchout .payment-details"}})},selectPayPal:function(){var e=$("input:radio[name=paymentOptions]");e.filter("[value=PayPal]").click()},selectCreditCard:function(){var e=$("input:radio[name=paymentOptions]");e.filter("[value=OCCPunchout]").click()}});return t}(),ow.controls.paypalexpresscontrol=function(){var e=ow.utils.wc.owutils,t=Backbone.View.extend({events:{"click .btn-express":"expressCheckout"},expressCheckout:function(){var e=$("#sapOrderFailureReasonInput").val();return void 0!=e&&"sapInvalidItemInventory"==e?!1:void this.PIAddPayPalAndPunchOut()},PIAddPayPalAndPunchOut:function(){var t=$("#orderId").val(),r=($("#piAmount").val(),$("#payMethodId").val());$.ajax({type:"POST",url:e.noCommentURL(ow.url.absoluteURL+"OWPaymentInstructionCmd?orderId="+t+"&payMethodId="+r+"&express=true"),success:function(e){var r=e.piId;return void 0===r?void $("h1").html('Review your Shopping Cart <div class="security-logo"><img src="https://s3-us-west-1.amazonaws.com/wc-dev-public/img/comodo_secure_94x65_white.png" /></div><span class="alert-error">One or more items in your cart are out of stock. Please adjust your cart to proceed with your order.</span>'):void(window.location.href="PunchoutPaymentRedirectView?orderId="+t+"&piId="+r)}})}});return t}(),ow.controls.popuplinkcontrol=function(){var e=Backbone.View.extend({el:$(document),events:{"click a.popupLink":"showPopup"},showPopup:function(e){var t=$(e.currentTarget).attr("id");"showPncDeliveryPolicy"==t?$("#pncDeliveryPolicyPopUp").modal():"showAuthToLeaveTerms"==t&&$("#authToLeaveTermsPopUp").modal()},initialize:function(){}});return e}(),ow.controls.productCarouselControl=function(){var e=ow.utils.wc.inventory,t={},r=ow.utils.wc.commonUtils;return void 0!=ow.state&&void 0==ow.state.carousel&&(ow.state.carousel={},ow.state.carousel.settings={},ow.state.carousel.productIdsFromSKU={},ow.state.carousel.inventoryCheckResponse={},ow.state.carousel.priceCheckResponse={},ow.state.carousel.recsInstockSKU={},ow.state.carousel.recsInstockSKU_fetched={},ow.state.carousel.hasPriceSKUs={},ow.state.carousel.hasPriceSKUs_fetched={}),t.getAvailabilityApiEnabled=function(){return"accurate"===$.cookie("OW_AVAILABILITY")||ow.state.isAvailabilityApiEnabled},t.getInventoryUrl=function(t,r){if(this.getAvailabilityApiEnabled())return e.getInventoryCheckURL(r,t);ow.state.isRegistered="R"===r.userType,ow.state.isThirtyDayAcnt=r.thirtyDayAccountEnabled;var a=($.cookie("PREFERRED_STORE_ID")||"",$.cookie("FFMCenter"));if(a){-1!=a.indexOf(",")&&(a=a.replace(",","-"),$.cookie("FFMCenter",a,{path:"/"}));var o=a.split("-")[0],i=a.split("-")[1],n=ow.state.cachedHttpRequest+"GetInventory?storeId="+ow.state.storeId+"&catalogId="+ow.state.catalogId+"&ffmcenterId="+o+"&storeffmcenterId="+i+"&nc=true&partNumbers="+t.sort().join(",")+"&usertypecachebust="+ow.state.isRegistered+"-"+ow.state.isThirtyDayAcnt;return n}},t.getInventory=function(e){var t=this,r=$.Deferred();return ow.utils.wc.customerinfoutil.getUserData(function(a){var o=t.getInventoryUrl(e,a);$.getJSON(o).done(function(e){r.resolve(e)},function(e){r.reject(e)})}),r.promise()},t.fetchOutOfStockProducts=function(e){var r=this,a=ow.state.carousel.settings[e].SKUs,o=a.split(","),i=$.Deferred();return r.getInventory(o).then(function(r){ow.state.carousel.inventoryCheckResponse[e]=r;ow.state.carousel.recsInstockSKU[e]=new Array;var a=[];a=r.inventory?r.inventory:t.createInventoryData(r),$.each(a,function(t,r){"undefined"!=typeof r&&r.allowaddtocart&&ow.state.carousel.recsInstockSKU[e].push(r.partNumber),r.productId&&r&&ow.utils.globalvariablecache.put("inventoryCache",r.productId,r)}),ow.state.carousel.recsInstockSKU_fetched[e]=!0,i.resolve()},function(){i.resolve()}),i.promise()},t.fetchHasPriceProducts=function(t){var r=ow.state.carousel.settings[t].SKUs,a=e.getPriceCheckURL(),o={partNumber:r.split(",").sort().join(",")},i=$.Deferred();return $.get(a,o,function(r){var a=$.cookie("OW_PRICE_FETCH")||ow.state.customPriceFetchEnabled;r=a&&r&&r.prices?r.prices:r,ow.state.carousel.priceCheckResponse[t]=r,r=e.getArrayFromResponse(r),ow.state.carousel.hasPriceSKUs[t]=new Array;for(var o in r)(r[o].bulkbuy||void 0!=r[o].price)&&(ow.state.carousel.hasPriceSKUs[t].push(r[o].partNumber),ow.state.carousel.productIdsFromSKU[r[o].partNumber]=r[o].productId);ow.state.carousel.hasPriceSKUs_fetched[t]=!0,i.resolve()}).error(function(){$('[data-price="default"]').css("display","block"),i.resolve()}),i.promise()},t.filterProducts=function(e){for(var t=ow.state.carousel.settings[e].SKUs.split(","),r=new Array,a=0;a<t.length;a++)ow.state.carousel.recsInstockSKU[e].indexOf(t[a])>=0&&ow.state.carousel.hasPriceSKUs[e].indexOf(t[a])>=0&&r.push(t[a]);ow.state.carousel.settings[e].SKUs=r.join(",")},t.initialiseCarousel=function(e){var r=e.targetDivId;
ow.state.carousel.settings[r]=e,ow.state.carousel.recsInstockSKU_fetched[r]=!1,ow.state.carousel.hasPriceSKUs_fetched[r]=!1;var a=$.Deferred();return $.when(t.fetchOutOfStockProducts(r),t.fetchHasPriceProducts(r)).then(t.filterProducts.bind(this,r)).then(function(){a.resolve()}),a.promise()},t.showProductCarousel=function(e){var r=e.targetDivId;ow.state.carousel.settings[r]=e,ow.state.carousel.recsInstockSKU_fetched[r]=!1,ow.state.carousel.hasPriceSKUs_fetched[r]=!1;$.when(t.fetchOutOfStockProducts(r),t.fetchHasPriceProducts(r)).then(t.filterProducts.bind(this,r)).then(t.getProductData.bind(this,r)).then(t.renderCarousel.bind(this),t.errorCallBack)},t.fetchProductInventory=function(){},t.fetchProductPrice=function(){},t.getProductData=function(e){var t=$.Deferred(),a=ow.state.carousel.settings[e],o=a.SKUs;if(!(void 0==o||o.length<1)){var i=1==a.SKUs.split(",").length||1==a.maxNumberOfProductToShow,n={partNumbers:o,includeDescriptions:i,targetDivId:e,targetZoneId:a.targetZoneId,targetPartNumber:a.targetPartNumber,targetCategoryID:a.targetCategoryID,targetSearchTerm:a.targetSearchTerm};void 0!==a.noCache&&(n.noCache=a.noCache);var s=function(r){r.products&&(r.products=r.products.filter(function(e){return""!==e.uniqueID})),t.resolve(r,e)},c=function(e,r){t.reject(e,r)};return r.ajaxGetJSON(ow.url.IntelligentOfferURL,n,s,c),t.promise()}},t.resetShellProductAsInStock=function(e,t){var r=t;return $.each(e.products,function(e,t){void 0!==t.shellProductUrl&&t.shellProductUrl.length>0&&$.inArray(t.partNumber,r)<0&&r.push(t.partNumber)}),r},t.renderCarousel=function(t,r){var a=ow.state.carousel.settings[r],o=a.templateName,n=a.espotTitle,s=a.numOfProductsPerSlide,c=a.maxNumberOfProductToShow,l=a.targetZoneId;("undefined"==typeof s||""==s)&&(s=5);var d=Handlebars.templates[o];"undefined"!=typeof t&&(t.divId=r,void 0!=l&&""!==l&&(t.cmcrurl="?cm_vc="+l),t.espotTitle=n,t.numOfProductsPerSlide=s);var u="accurate"===$.cookie("OW_AVAILABILITY")||ow.state.isAvailabilityApiEnabled;if(u)var p=ow.state.carousel.inventoryCheckResponse[r];else var p=ow.state.carousel.inventoryCheckResponse[r].inventory;var f=[],h=ow.state.carousel.recsInstockSKU[r];if(h=ow.state.carousel.settings[r].SKUs,"undefined"!=typeof h){h=h.split(",");for(var m=0;m<h.length;m++)if(f.push(ow.state.carousel.productIdsFromSKU[h[m]]),"undefined"!=typeof c&&!isNaN(c)&&i+1>=c){t.products.splice(i+1,t.products.length);break}}"undefined"!=typeof d&&$("#"+r).append(d(t)).promise().done(function(){$(document).trigger("contentloaded"),$(document).trigger("espotLoaded"),e.updateInventoryWithResponse(f,p),e.updatePriceWithResponse(ow.state.carousel.priceCheckResponse[r]),"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(t){e.checkRestrictedRangeWithoutProductSub(t,null,{catentryIds:f})})})},t.errorCallBack=function(e,t){console.log("JSON data for rendering Offer Ajax error:"+t)},t.createInventoryData=function(t){var r=new Array;return $.each(t,function(t,a){r.push(e.updatemessaging(a,!0))}),r},t}(),ow.controls.productFamiliesControl=function(){function e(e){this.el=e,this.bindEvents(e)}function t(e,t){this.family=e,this.value=t,this.skus=[],this._selected={}}function r(e,t){this.id=e,this.name=t,this.values=[],this.skus=[],this._selected={}}var a=(ow.utils.wc.owutils,Handlebars.templates.productFamiliesTemplate),o={available:"",unavailable:" (Not Available)"};e.prototype={bindEvents:function(){$(this.el).on("change","select",this.selectVariant.bind(this)).on("blur","select",this.handleBlur.bind(this)).on("click","select",this.fireBrowseEvent.bind(this))},initialize:function(){var e=this.el.attr("data-families-data");if(e){var a=JSON.parse(e);if(a){var o,i=0;a.skus&&(i=a.skus.reduce(function(e,t){return Math.max(e,t.attributes.length)},0),o=a.skus.reduce(function(e,a,o){if("undefined"==typeof o.attributes||o.attributes.length<e)return a;var i={catEntryId:o.catEntryId,partNumber:o.partNumber,url:o.url,families:{}};return o.attributes.reduce(function(e,a,o){e.families[o.id]=o.value;var i=new t(o.id,o.value);return i.addSku(e),a[o.id]?(a[o.id].addSku(e),a[o.id].addValue(i)):(a[o.id]=new r(o.id,o.name),a[o.id].addSku(e),a[o.id].addValue(i)),a}.bind(null,i),a)}.bind(null,i),{})),a.selected&&a.selected.attributes&&a.selected.attributes.forEach(function(e){$.each(o,function(t,r){r.setSelected(e.id,e.value)})}),this.data=a,this.data.familiesLength=i,this.data.families=o,this.data.familyArr=Object.keys(o).map(function(e){return o[e]}).sort(function(e,t){return t.name.localeCompare(e.name)}),this.render()}}},render:function(){var e=a(this.data);this.el.html(e),this.el.trigger("contentloaded")},update:function(){$(this.el).find("[data-family]").each(function(e,t){var r=$(t).attr("data-family"),a=this.data.families[r];a.values.forEach(function(e){var r=$(t).find("option[value='"+e.value+"']");r.text(e.selectableSku?e.value+o.available:e.value+o.unavailable)}),$(t).trigger("update")}.bind(this))},selectVariant:function(e){var t=e.currentTarget.value,r=$(e.currentTarget).attr("data-family"),a=this.data.families[r],o=a.getSelectedSku();$.each(this.data.families,function(e,a){a.setSelected(r,t)});var i=a.getSelectedSku();this.fireAnalyticsEvent("select",a.name,i,o),this.update(),i&&this.notify(i,o)},get hasValidFamilies(){return this.data.selected.attributes&&this.data.selected.attributes.length===this.data.familiesLength},get notify(){return this._notifyFn},set notify(e){this._notifyFn=e},handleBlur:function(){this.open=!1},fireBrowseEvent:function(e){var t=$(e.currentTarget).attr("data-family"),r=this.data.families[t];this.open?this.open=!1:(this.open=!0,this.fireAnalyticsEvent("browse",r.name,this.data.selected))},fireAnalyticsEvent:function(e,t,r,a){var o={id:e,variation:t};"undefined"!=typeof a&&(o.current=a.partNumber),"undefined"!=typeof r&&(o.selected=r.partNumber),$.publish("ProductFamiliesEvent",o)}},t.prototype={hasSku:function(e){var t;return this.skus.forEach(function(r){return e.catEntryId===r.catEntryId?void(t=r):void 0}),t?!0:!1},addSku:function(e){this.hasSku(e)||this.skus.push(e)},addSkus:function(e){e.forEach(function(e){this.addSku(e)}.bind(this))},get selected(){return this._selected[this.family]===this.value},set selected(e){this._selected[this.family]=e},getSelected:function(e){return this._selected[e]},setSelected:function(e,t){this._selected[e]=t},getSelectedSku:function(){var e=this.skus.filter(function(e){var t=!0;return $.each(e.families,function(e,r){this.family!==e&&this.getSelected(e)!==r&&(t=!1)}.bind(this)),t}.bind(this));return e.length>0?e[0]:void 0},get selectableSku(){var e=!1;return this.skus.forEach(function(t){var r=0;$.each(t.families,function(t,a){r+=1,this.family!==t&&this.getSelected(t)===a&&(e=!0)}.bind(this)),1>=r&&(e=!0)}.bind(this)),e},set selectableSku(e){}},r.prototype={hasValue:function(e){var t=this.getValue(e);return t?!0:!1},hasSku:function(e){var t=this.getSku(e);return t?!0:!1},addValue:function(e){if(this.hasValue(e)){var t=this.getValue(e);t.addSkus(e.skus)}else this.values.push(e)},getSku:function(e){var t;return this.skus.forEach(function(r){return e.catEntryId===r.catEntryId?void(t=r):void 0}),t},getValue:function(e){var t;return this.values.forEach(function(r){return e.value===r.value?void(t=r):void 0}),t},addSku:function(e){this.hasSku(e)||this.skus.push(e)},getSelected:function(e){return this._selected[e]},setSelected:function(e,t){this._selected[e]=t,this.values.forEach(function(r){r.setSelected(e,t)})},getSelectedSku:function(){var e=this.values.reduce(function(e,t){return t.selected?t:e});return e?e.getSelectedSku():void 0}},$(document).on("contentloaded",function(){$("[data-families-data]").each(function(){var t,r=$(this);r.data("_productFamilies")instanceof e||(t=new e(r),r.data("_productFamilies",t),t.initialize(),t.hasValidFamilies&&r.removeClass("hidden"),r.trigger("componentloaded",["productFamilies",t]))})})}(),ow.controls.qascheckcontrol=function(){var e=ow.utils.wc.owutils,t=Backbone.View.extend({events:{"click #useSelectedAddress":"useSelectedAddress","click #useFailedAddress":"useSelectedAddress"},callBackFunction:null,form:null,qasEnabled:null,addressListTemplate:null,initialize:function(){_.bindAll(this),this.addressListHeaderTemplate=Handlebars.templates.addressListHeaderTemplate,this.addressListTemplate=Handlebars.templates.addressListTemplate,this.qasEnabled=!0},enableQas:function(e){this.qasEnabled=e.result},addressCheck:function(t,r){void 0==t.address1&&void 0!=t.length&&t.length>0&&(t=t[0]),this.form=t,this.callBackFunction=r;var a="";if(/\d/g.test($(t.address2).val())&&(a=$(t.address2).val()),1!=this.qasEnabled)return!0;var o=ow.url.qasCheckUrl+"?action=search&building="+a+"&street="+$(t.address1).val()+"&suburb="+$(t.city).val()+"&state="+$(t.state).val()+"&postcode="+$(t.zipCode).val();this.showLoading(),$.post(e.noCommentURL(o),this.qasSearchCallback)},getEnteredAddressHtml:function(){var e="";return""!=$(this.form.address2).val()&&(e+=$(this.form.address2).val()+", "),e+=$(this.form.address1).val()+", "+$(this.form.city).val()+" "+$(this.form.state).val()+" "+$(this.form.zipCode).val()},qasSearchCallback:function(e){this.hideLoading();var t=$("#addressCheck"),r=$("#addressCheckFailed");if("SUCCESS"==e.result||"SUCCESS_WITH_SAFE_MATCH"==e.result){e.addressEntered=this.getEnteredAddressHtml();var a=this.addressListHeaderTemplate(e),o=this.addressListTemplate(e);$("#addressCheckHeader").html(a),$("#addressCheckList").html(o),t.trigger("update").modal("show").on("hidden.bs.modal",function(){$("#submitRegistration").removeClass("is-pending")})}else{if("TOO_MANY_MATCHES"!=e.result&&"NO_MATCHES_FOUND"!=e.result)return this.showLoading(),this.callBackFunction();var i="";""!=$(this.form.address2).val()&&(i+=$(this.form.address2).val()+"<br />"),i+=$(this.form.address1).val()+", "+$(this.form.city).val()+" "+$(this.form.state).val()+" "+$(this.form.zipCode).val(),$("#enteredAddress").html("<strong class='ow-modal__label'>The address you entered was:</strong><input type='radio' name='addressCheck' checked='true' value='addressEntered'/> <div class='mb-standard'>"+i+"</div>"),r.modal("show")}},qasGetCallback:function(e){if(null!==this.form&&void 0!==this.form){$(this.form.address1).val(e.address.addressLine1),$(this.form.address2).val(e.address.addressLine2),$(this.form.zipCode).val(e.address.postcode),$(this.form.city).val(e.address.suburb),$(this.form.state).val(e.address.state);var t=this;if(void 0!=$(this.form).find(".postcode-autocomplete")&&$(this.form).find(".postcode-autocomplete").length>0){t.showLoading();var r=$(this.form.city);r.val(e.address.suburb);var a=e.address.suburb;$(this.form).find(".postcode-autocomplete").trigger("input",function(){return r.val(a).trigger("update"),"function"==typeof t.callBackFunction?t.callBackFunction(e):void 0})}else if(t.showLoading(),"function"==typeof t.callBackFunction)return t.callBackFunction(e)}},useSelectedAddress:function(){this.showLoading();var t=$("input[name=addressCheck]:checked").val();if("addressEntered"===t)"function"==typeof this.callBackFunction&&this.callBackFunction();else if(t&&""!=t){var r=ow.url.qasCheckUrl+"?action=get&moniker="+encodeURIComponent(t);$.post(e.noCommentURL(r),this.qasGetCallback)}$(".modal").modal("hide")},showLoading:function(){ow.utils.wc.owutils.loader("show",".address-form"),ow.utils.wc.owutils.loader("show","#memberAddresses")},hideLoading:function(){ow.utils.wc.owutils.loader("hide")}});return t}(),ow.controls.quantitycontrol=function(){var e=ow.utils.wc.eventbus,t=ow.utils.wc.inventory,r=Backbone.View.extend({minimum:1,cartMinimum:0,maximum:999,events:{"click .ow-quantity .plus":"clickPlus","click .ow-quantity .minus":"clickMinus","keyup .ow-quantity input.quantity_input":"validate","change .ow-quantity input.quantity_input":"blurValidate"},initialize:function(){_.bindAll(this);var e=this;$("input.quantity_input").each(function(){$(this).attr("maxlength",e.maximum.toString().length)}),$("#mailman-wizard").length&&(this.minimum=0)},setValue:function(t,r){t.val(r);var a=t.data("catentryid");this.updateScalePriceDisplay({product:a,quantity:r}),e.trigger("qty:update",t)},updateScalePriceDisplay:function(e){var r=this,a=e.quantity,o=r._getPriceForQty(a,e.product),i=r._formatCurrency(o);if(!(0>=i)){var n=".ow-price .ow-price__amount[data-id="+e.product+"] ";$(n).find(".price-ele").length>0?$(n).find(".price-ele").html("$"+i):$(n).html("$"+i),0!==$("#unit-price-display").length&&t.updateUnitPriceDisplay($("#unit-price-display"),i,e.product)}},_getPriceForQty:function(e,t){var r="priceRange_",a=0,o=$("div").data(r+t);if(!o)return a;for(var i=0;i<o.length;i++){var n=o[i].minQty,s=o[i].maxQty,c=o[i].catentryid,l=o[i].price;if(c==t&&(0==i&&(a=l),e>=n&&(this.isBlank(s)||s>=e)))return l}return a},isBlank:function(e){return!e||/^\s*$/.test(e)},_formatCurrency:function(e){return parseFloat(e,10).toFixed(2)},clickPlus:function(e){var t=$(e.currentTarget),r=t.closest(".ow-quantity").find(".quantity_input"),a=r.val();a=Math.min(this.maximum,++a),$(t).data("iscartpage")?this.updateCartItems(r,a,t):this.setValue(r,a)},updateCartItems:function(t,r,a){var o=$(a).data("catentryid"),i=$(a).data("extracoverfor"),n=$(a).data("extracoverforqty"),s="",c="";ow.state.productInsuranceEnabled&&(s=$(a).data("productinsurancefor"),c=$(a).data("productinsuranceforqty"));var l=$(a).data("assembleitfor"),d=$(a).data("assembleitforqty"),u=$(a).data("orderitemid"),p="addon-extraCoverFor";if(ow.state.productInsuranceEnabled)var f="addon-productInsuranceFor";var h="addon-assemblyCoverFor",m=0===$(a).data("maxqty")?null:$(a).data("maxqty"),p=i?o+"_"+i:void 0;if(ow.state.productInsuranceEnabled)var f=s?o+"_"+s:void 0;var h=l?o+"_"+l:void 0;if(!$(a).hasClass("disabled")){var v;if(m&&r>m?(t.val(m),v=m):(t.val(r),v=r),"undefined"!=typeof l||"undefined"!=typeof i||ow.state.productInsuranceEnabled&&"undefined"!=typeof s)if("undefined"!=typeof n){var g=$("#quantity_"+i).val();parseInt(r)>parseInt(g)&&(v=g)}else if(ow.state.productInsuranceEnabled&&"undefined"!=typeof c){var g=$("#quantity_"+s).val();parseInt(r)>parseInt(g)&&(v=g)}else if("undefined"!=typeof d){var g=$("#quantity_"+l).val();parseInt(r)>parseInt(g)&&(v=g)}var y={catentryId:o,orderitem_id:u,quantity:v,source:this,extraCoverLabel:p,extraCoverForQty:n,assemblyLabel:h,assemblyQty:d};ow.state.productInsuranceEnabled&&(y[f]=f,y[c]=c),e.trigger("QuantityControl:change",y)}},clickMinus:function(e){var t=$(e.currentTarget),r=t.closest(".ow-quantity").find(".quantity_input"),a=r.val(),o=ow.state.ShoppingCart?this.cartMinimum:this.minimum;a=Math.max(o,--a),$(t).data("iscartpage")?this.updateCartItems(r,a,t):this.setValue(r,a)},validate:function(e){var t=(e.originalEvent,e.currentTarget),r=ow.state.ShoppingCart?this.cartMinimum:this.minimum,a=$(t).val();a="string"===$.type(a)?a.replace(/[^\d]+/g,""):"",a=""===a?"":String(Number(a)),a!==$(t).val()&&$(t).val(a),""!=$(t).val()&&$(t).val()<r&&$(t).val(r),""!=$(t).val()&&$(t).val()>this.maximum&&$(t).val(this.maximum)},blurValidate:function(e){var t=e.currentTarget,r=$(t).val(),a=ow.state.ShoppingCart?this.cartMinimum:this.minimum;$(t).val()<a&&$(t).val(a),$(t).val()>this.maximum&&$(t).val(this.maximum),$(t).data("iscartpage")?this.updateCartItems($(t),r,t):this.setValue($(t),$(t).val())}});$(function(){new r({el:$(document)})})}(),ow.controls.selectorrecscontrol=function(){var e=Backbone.View.extend({events:{"click .recsTab":"tabClick","click .moreDetails":"moreDetails"},products:null,initialize:function(){var e=this;window.hpcbs1_zp=function(t,r,a,o,i,n,s,c){t&&t.length>0?$.ajax({context:e,type:"POST",url:ow.url.absoluteURL+"OWIntelligentOfferView",data:{partNumbers:t.join(),espotTitle:c,templateName:"ProductSelector_Bottom",catalogId:ow.state.catalogId,storeId:ow.state.storeId,langId:ow.state.langId,physicalStoreId:$.cookie("PREFERRED_STORE_ID")},success:e.processRecs,dataType:"html"}):e.noReccomendations()},bus.on("recsTrigger",this.triggerUpdate,this)},triggerUpdate:function(e){var t=Config.recsAssociations.associations[e];this.renderTabs(t),this.updateRecs(t[0].id),$("#reccomendations ul.tabs li:first-child a").addClass("selected")},updateRecs:function(e){$("#recsContainer").empty();try{cmRecRequest("hpcbs1","",e),cmDisplayRecs()}catch(t){}this.showLoader()},renderTabs:function(e){$("#reccomendations").empty();var t={};t.tabs=e;var r=$("#recsTemplateTabs").html(),a=Handlebars.compile(r);$("#reccomendations").append(a(t))},processRecs:function(e){var t=e.replace(/<!--[\s\S]*?-->/g,""),r=JSON.parse(t),a=0,o=[];$.each(r.catEntries,function(e){if(null!=this.product){var t={};t.name=this.product.name,t.description=$("<div/>").html(this.product.longDescription).text(),t.sku=this.product.partNumber,t.price=this.product.price[1].value.value.toFixed(2),t.smallImage=this.images.small,t.mediumImage=this.images.medium,t.largeImage=this.images.large,t.catentryid=this.product.uniqueID,t.index=a,t.inventory=r.inventory[e];var i=0,n=5;$.each(this.product.userData.userDataField,function(){"Rating_Range"==this.key?n=this.value:"Rating"==this.key&&(i=this.value)}),t.rating=i/n*100,o.push(t),a++}}),this.products=o,this.recDisplaySuccess(o)},recDisplaySuccess:function(e){this.hideLoader();var t=$("#recsTemplateProducts").html(),r=Handlebars.compile(t);$("#recsContainer").empty(),$.each(e,function(){$("#recsContainer").append(r(this)),this.inventory.allowaddtocart?$('[data-cart="add"][data-catentryid="'+this.catentryid+'"]').removeAttr("disabled"):$('[data-cart="add"][data-catentryid="'+this.catentryid+'"]').attr("disabled","disabled"),$('[data-cart="add"][data-catentryid="'+this.catentryid+'"]').show()})},tabClick:function(e){e.preventDefault(),$("#recsContainer .loader").is(":visible")||(this.showLoader(),e.preventDefault(),$("#reccomendations ul.tabs a").removeClass("selected"),$(e.currentTarget).addClass("selected"),this.updateRecs($(e.currentTarget).data("catid")))},moreDetails:function(e){e.preventDefault();var t=$(e.currentTarget).data("index"),r=$("#recsPopupTemplate").html(),a=Handlebars.compile(r);$.fancybox(a(this.products[t]),{tpl:{closeBtn:'<button class="btn btn-small btn-secondary" href="#">X</button>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span class="carousel-control right"></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span class="carousel-control left"></span></a>'}}),this.products[t].inventory.allowaddtocart?$('[data-cart="add"][data-catentryid="'+this.products[t].catentryid+'"]').removeAttr("disabled"):$('[data-cart="add"][data-catentryid="'+this.products[t].catentryid+'"]').attr("disabled","disabled"),$('[data-cart="add"][data-catentryid="'+this.products[t].catentryid+'"]').show()},showLoader:function(){$("#recsContainer").append('<div class="loader"><div>Loading...</div></div>'),setTimeout(function(){$("#recsContainer .loader").is(":visible")&&($("#recsContainer").empty(),$("#recsContainer").append('<h3 class="norecs">No accessories found at this time</h3>'))},7e3)},hideLoader:function(){$("#recsContainer").remove(".loader")},noReccomendations:function(){$("#recsContainer").empty(),$("#recsContainer").append('<h3 class="norecs">No accessories found at this time</h3>')}});return e},ow.controls.shellproductcontrol=function(){var e=ow.utils.wc.owutils,t=(ow.utils.wc.eventbus,ow.utils.wc.store,ow.utils.wc.commonUtils,ow.utils.wc.availability),r=function(){this.loadShellAvailabilityEspot=function(){if(!($('[data-inventory="availability"]').length<1)){var t=ow.url.dynamicEspotURL+"&emsName=Shell_Search_Availability",r="",a=$("[data-shellproduct]");e.loader("show",$("[data-shellproduct]")),a.length>0&&$.get(t,function(t){r=t;$.each(a,function(t,a){var o=$(a).data("id"),i=$('.ow-quantity[data-catentryid="'+o+'"]');i.hide();var n=ow.url.dynamicEspotURL+"&emsName="+$(a).data("emsname");$.get(n,function(t){try{var o=JSON.parse("{"+t.split("{").pop().split("}").shift()+"}");e.loader("hide",$(a)),$(a).html("true"===o.espotFound?t:r)}catch(i){}})})})}},this.loadShellProductAvailability=function(){if(this.loadShellAvailabilityEspot(),!($('[data-inventory="availability-single-line"]').length<1)){var e=$("[data-inventory]").filter(function(e,t){return $(t).data("shellproduct")});$.each(e,function(e,r){var a={productType:$(r).data("producttype"),productSubType:$(r).data("productsubtype"),partNumber:$(r).data("partnumber")};a=t.updatemessaging(a),t.applyAvailabilityMessages(r,a)})}}};return r}(),ow.controls.shoppingcartheadercontrol=function(){var e,t=ow.utils.wc.store,r="true"===$.cookie("OW_BROWSE_AVAILABILITY_PREFERENCES")||ow.state.browseAvailabilityPreferencesEnabled,a=ow.utils.wc.eventbus,o=ow.utils.wc.commonUtils,i=ow.utils.wc.owutils,n={DELIVER_TO_DOOR:"20000",COLLECT:"10000"},s=(n.DELIVER_TO_DOOR,Backbone.View.extend({events:{"click .nav-tabs li a[data-fulfilment-choice]":"selectFulfilment","click #checkoutAvailabilityPreferencesChangeClickAndCollectButton":"showStoreModal","click #checkoutAvailabilityPreferencesChangeDeliverToDoorButton":"showSuburbModalClick"},initialize:function(){_.bindAll(this);e=new ow.controls.userlocationcontrol({el:$(document)})},getUserLocationControl:function(){return e},isShoppingcartHeaderEnabled:function(){return r},renderShipmodeLocationHeaderHtml:function(){var e=this,t=ow.state.yourstoredata,r=t.deliverPostcode||t.postcode,a=t.deliverSuburb||t.city,o={shipmode:e.getShipMode(),deliverPostcode:r,deliverSuburb:a.charAt(0).toUpperCase()+a.substr(1).toLowerCase(),storeId:t.externalIdentifier,storeName:t.name,storeUniqueId:t.uniqueId},i=Handlebars.templates.checkoutAvailabilityPreferences;$("#checkout_availability_preferences").html(i(o))},displayLocationHeader:function(r){var a=this,o=!1;try{o=r.owOrderBean.orderView.containsOnlineDeliveryProductsOnly}catch(i){}if(!e.isUserLocationSet()&&!o&&r.owOrderBean)return void a.showSuburbModal(!1);if(o||!r.owOrderBean)return void a.removeLocationHeader();if(r.owOrderBean){var s=n.DELIVER_TO_DOOR;try{s=r.owOrderBean.shippingInfo.selectedShipModeId}catch(i){}a.setShipMode(s),e.isUserLocationSet()&&!ow.state.yourstoredata?t.reloadStore(function(){a.renderShipmodeLocationHeaderHtml()}):a.renderShipmodeLocationHeaderHtml()}},removeLocationHeader:function(){$("#checkout_availability_preferences").html("")},selectFulfilment:function(e){var t=this;$(".nav-tabs li a.location-change").toggle(),i.loader("show","main","ow-loading ow-loading--expand");$(e.currentTarget).data("fulfilmentChoice")==n.COLLECT?n.COLLECT:n.DELIVER_TO_DOOR;t.setShipMode($(e.currentTarget).data("fulfilmentChoice")==n.COLLECT?n.COLLECT:n.DELIVER_TO_DOOR),$.when(t.updateShipInfo(),t.promiseUserData()).always(function(){t.reloadShoppingCartPage()})},updateShipInfo:function(e){var t=this,r={orderId:".",calculationUsage:"-2,-3,-4",shipModeId:t.getShipMode(),nc:"true"};e&&(r.physicalStoreId=e),t.getShipMode()===n.COLLECT&&(r.physicalStoreId=t.getStoreUniqueId()),r.useAvailabilityPreferences="true";var a=ow.url.absoluteURL+"AjaxOrderChangeServiceShipInfoUpdate";return o.ajaxGet(a,r)},showSuburbModal:function(r){var o=this,n=!e.isUserLocationSet();e.displaySuburbLocationModal(r,n,function(r){i.loader("show","main");var n=ow.state.yourstoredata,s=e.isUserLocationSet()&&n&&n.externalIdentifier?n.externalIdentifier:r.storeId;t.setStoreAndDeliverLocation(s,r.postcode,r.suburb,function(e){e&&(a.trigger("setPrefStore",e),o.reloadShoppingCartPage())})})},showSuburbModalClick:function(){var e=!0;this.showSuburbModal(e)},showStoreModal:function(){var r=this;e.displayStoreLocationModal(function(e){i.loader("show","main"),t.setStore(e.storeId,function(e){e&&(a.trigger("setPrefStore",e),r.updateShipInfo(e.uniqueId).always(function(){r.reloadShoppingCartPage(),i.loader("hide")})),i.loader("hide")})})},getShipMode:function(){return this.currentShipMode||n.DELIVER_TO_DOOR},setShipMode:function(e){this.currentShipMode=e},promiseUserData:function(){var e=this;return e.getCustomerInfoUtil().promiseUserData()},reloadShoppingCartPage:function(){$("#errorAlert").alert("close"),i.loader("show","main"),t.reloadStore(function(e){a.trigger("setPrefStore",e),a.trigger("ShoppingCart:UpdateCart")})},getStoreUniqueId:function(){return $.cookie("PREFERRED_STORE_ID")||"10508"},getCustomerInfoUtil:function(){return"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil}}));return s}(),ow.controls.storeavailabilitycontrol=function(){var e,t=ow.utils.wc.eventbus,r=ow.utils.wc.store,a=ow.utils.wc.inventory,o=ow.utils.wc.storelocatorutil,i=(ow.utils.wc.ondemandgmaputil,Backbone.View.extend({activeForm:null,hoverTimer:null,activeCatEntry:null,events:{"keydown .change-store-availability input":"keypressed","click .set-store-availability":"setPreferredStore","click .availability .duplicate-suburb-link":"showNearbyStoresForSelectedSuburb","click #showStoresCheckBox":"refreshShowNearbyStores"},initialize:function(){this.refreshInit(),t.on("searchRefresh",this.refreshInit,this),t.on("refreshstoreavailabilityfrom",this.refreshInit,this),e=ow.controls.userlocationview,this.storeLocatorUtil=new o},showLoading:function(){$(".products").prepend('<div class="loader search"><div>Setting your store...</div></div>')},refreshInit:function(){_.bindAll(this),$(".dropdown.change-store-availability").each(function(){$(this).data("override-default","true")});for(var e=this,t=$(".store-availability"),r=0;r<t.length;r++)$(t[r]).validate({rules:{suburbPostcode:{required:!0}},messages:{suburbPostcode:{required:"Enter suburb or postcode"}},onfocusout:!1,onkeyup:function(e,t){13!=t.which&&($(e).popover("hide"),this.resetForm())},submitHandler:function(t){return e.activeForm=t,e.activeCatEntry=$(t.catEntryId).val(),e.doSubmitFindAddress(),!1}})},enterChangeStore:function(e){var t=e.currentTarget;clearTimeout(this.hoverTimer),$(t).hasClass("open")||($(".open").each(function(){$(this).hasClass("added")||$(this).removeClass("open")}),this.hoverTimer=setTimeout(function(){$(t).addClass("open")},400))},keypressed:function(){clearTimeout(this.hoverTimer)},leaveChangeStore:function(e){var t=e.currentTarget;clearTimeout(this.hoverTimer);var r=0,a=$(t).find("input.input-postcode");0==a.val().length&&(r=a.is(":focus")?3e3:500,this.hoverTimer=setTimeout(function(){$(t).removeClass("open")},r))},doSubmitFindAddress:function(){this.showAnimation();var e=$(this.activeForm).find(".input-postcode").val();return""===e?void $(this.activeForm).find(".input-postcode").focus():void this.findStoresByAddress(e)},findStoresByAddress:function(e){var t=this,r=$(this.activeForm).find("#check-stock").val();$.when(this.storeLocatorUtil.findNearbyStoresByAddressWithInventory(e,r)).done(function(e){if(void 0!=e.suburbs)t.showSuburbSelection(e);else{var r=t.storeLocatorUtil.getOWStores(e);t.render(null!=r&&r.length>0?r:null)}})},showAnimation:function(){$(this.activeForm).parent().find(".stores-list").remove(),$(this.activeForm).parent().find(".setting-store-msg").hide(),0==$(this.activeForm).parent().find(".change-store-searching").length&&$(this.activeForm).parent().append('<ul class="change-store-searching"><li>Searching for stores...</li></ul>')},hideAnimation:function(){$(this.activeForm).parent().find(".change-store-searching").remove()},refreshShowNearbyStores:function(){$(this.activeForm).submit()},showNearbyStoresForSelectedSuburb:function(e){e.preventDefault();var t=$(e.target).data("suburb"),r=t.indexOf(",");r>0&&(t=t.substring(0,r)),this.findStoresByAddress(t)},showSuburbSelection:function(e){this.hideAnimation();var t=Handlebars.templates.changeStoreLocationsTemplate,r=t(e);$(this.activeForm).parent().find(".stores-list").empty(),$(this.activeForm).parent().append(r)},render:function(e){this.hideAnimation(),null==e&&(e=[]),$.each(e,function(){this.header="header"==self.location?!0:!1,this.storeLocatorViewURL=ow.url.storeLocatorViewURL.replace(/&amp;/g,"&")});var t=Handlebars.templates.storeavailability,r=t(e);$(this.activeForm).parent().find(".stores-list").empty(),$(this.activeForm).parent().append(r),$(this.activeForm).closest(".ow-change-store").addClass("open")},removeDuplicateSuburbs:function(e){var t=[],r=[];return $.each(e,function(e,a){var o=a.address_components;if(null!=o&&o.length>0){var i=!1;for(e=0;e<o.length;e++){var n=o[e];if(null!=n){var s=n.short_name;null==s||""==s||"AU"!=s&&"au"!=s||(i=!0)}}if(i){var c=a.address;-1==$.inArray(c,r)&&(r.push(c),t.push(a))}}}),t},setPreferredStore:function(o){this.showLoading(),this.$el.find(".change-store-availability").removeClass("open"),o.preventDefault();var i=$(o.target).data("storeid");r.setStore(i,function(r){r&&(t.trigger("setPrefStore",r),ow.utils.globalvariablecache.clear("inventoryCache"),e.displayUserLocationHeaderBar(),a.update()),$(".loader").length>0&&setTimeout(function(){$(".loader").hide()},1e3)}),$(this.activeForm).parent().find(".stores-list").empty(),$(this.activeForm).find(".input-postcode").val("")}}));return i}(),ow.controls.storelocatorcontrol=function(){var e=ow.utils.wc.store,t=ow.utils.wc.eventbus,r=ow.controls.userlocationcontrol,a=Backbone.View.extend({events:{"click a[data-store-locator-set-my-store]":"setPreferredStore"},initialize:function(){_.bindAll(this),r=new ow.controls.userlocationcontrol({el:$(document)}),$(".ow-store-locator").on("componentloaded",function(e,t,r){var a=r.searchForm,o=r.searchInput;""!=o.val()&&a.submit()})},postSetStoreUpdate:function(e){var r=this;e&&(t.trigger("setPrefStore",e),r.updateStoreInPageContext(e.uniqueId,e),$.publish("SetPreferredStore"),ow.state.listingpage&&ow.state.listingpage.setView(!0))},setPreferredStore:function(t){t.preventDefault();var a=this,o=$(t.target).closest("li").data("store-id");if(r.isBrowseAvailabilityPreferencesEnabled()&&!r.isDeliveryLocationSet()){var i=$(t.target).data("store-postcode"),n=$(t.target).data("store-city");e.setStoreAndDeliverLocation(o,i,n,function(e){a.postSetStoreUpdate(e),$('p a[data-store-name="'+e.name+'"]').replaceWith('<span class="ow-store-locator__my-store">My Store</span>')})}else e.setStore(o,function(e){a.postSetStoreUpdate(e)})},updateStoreInPageContext:function(e,t){owPageContext.store=e,owPageContext.storeName=t.name,owPageContext.lat=t.lat,owPageContext.lon=t.lon,owPageContext.storePostcode=t.postcode}});return a}(),ow.controls.storelocatorformcontrol=function(){var e=Backbone.View.extend({el:".form-storelocator",initialize:function(){_.bindAll(this),this.$el.validate({errorPlacement:function(e,t){t.attr("placeholder",e.text())}})}});return e}(),ow.controls.suburbfindercontrol=function(){var e=(ow.utils.wc.owutils,ow.utils.wc.addressUtil),t=Backbone.View.extend({form:null,currentPostcode:null,subUrbOptions:null,events:{"input .postcode-input":"suburbFinder","keydown input[id$=taxPayerId], .postcode-autocomplete":"numbersOnly","forcerefresh .postcode-autocomplete":"suburbFinder","change select.suburbs-autocomplete-select":"populateStateField"},initialize:function(){_.bindAll(this),this.prepopulateSuburbOption()},prepopulateSuburbOption:function(){var e=$(".suburbs-autocomplete-input").attr("value");void 0!==e&&""!==e&&($("select.suburbs-autocomplete-select").append($("<option>").text(e).attr("value",e)),$("select.suburbs-autocomplete-select").val(e),void 0!=$("select.suburbs-autocomplete-select").data("_dropdown")&&$("select.suburbs-autocomplete-select").data("_dropdown").update(),$(".suburbs-autocomplete-input").hide())},triggerSuburbFindForeceRefresh:function(e,t){var r=$(".suburbs-autocomplete-input").attr("value");this.suburbFinder(e,t),void 0!==r&&""!==r&&($("select.suburbs-autocomplete-select").attr("selected","selected"),$("select.suburbs-autocomplete-select option[value=selectedSuburb]").attr("selected","selected"),$(".suburbs-autocomplete-input").hide())},suburbFinder:function(t,r){var a,o,i;if(void 0!=t&&void 0!=t.currentTarget)a=$(t.currentTarget).closest("form"),o=t.currentTarget.value;else{if(!t.is("form"))return void console.error("suburbfindercontrol: invalid caller, cannot find postcode from from.");
a=t,o=t.find(".postcode-input").attr("value"),i=$("form#Register select.suburbs-autocomplete-select").attr("value")}var n=a.find("select.suburbs-autocomplete-select"),s=($(".suburbs-autocomplete-input").attr("value"),n.data("_dropdown")),c=a.find(".state-autocomplete"),l=$("#noSuburbFoundError");n.empty().append($("<option>").text("Enter a postcode").attr("value","").attr("disabled","disabled").attr("selected","selected")).attr("readonly","readonly"),c.val(""),"undefined"!=typeof s&&s.update(),l.length&&l.remove(),4===o.toString().length&&e.getSuburbs(o,function(e){"undefined"!=typeof e.result&&("undefined"!=typeof e.result.suburbs?(n.empty(),$.each(e.result.suburbs,function(e,t){n.append($("<option>").text(t.suburb).attr("value",t.suburb).attr("data-state",t.state))}),e.result.suburbs.length>1?(n.removeAttr("readonly"),s&&s.dropdown.removeClass("singleoption"),$(".suburbs-autocomplete-input").hide()):(n.val(e.result.suburbs[0].suburb).valid(),s&&s.dropdown.addClass("singleoption")),c.val(e.result.suburbs[0].state).valid(),s&&s.update(),void 0!==i&&""!==i&&($("select.suburbs-autocomplete-select option[value='"+i+"']").attr("selected","selected"),$("select.suburbs-autocomplete-select").click().blur()),"function"==typeof r&&r()):$(document).trigger("alert",{type:"danger",html:"<strong>Warning!</strong> Sorry, no suburbs found for the postcode entered",dismissible:!1,id:"noSuburbFoundError",trackState:!1,floating:ow.breakpoints.isSmall(),insert:{method:"insertAfter",selector:"#postcodeEntryWrapper"}}))})},populateStateField:function(e){var t=e.currentTarget;if(t.selectedIndex>=0){var r=$(t.options[t.selectedIndex]),a=r.data("state");a="undefined"==typeof a?"":a,r.closest("#postcodeEntryWrapper").find(".state-autocomplete").val(a)}},numbersOnly:function(e){46==e.keyCode||8==e.keyCode||9==e.keyCode||27==e.keyCode||13==e.keyCode||65==e.keyCode&&e.ctrlKey===!0||86==e.keyCode&&e.ctrlKey===!0||e.keyCode>=35&&e.keyCode<=39||(e.shiftKey||(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105))&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}});return t}(),ow.controls.userlocationcontrol=function(){var e=ow.utils.wc.eventbus,t=ow.utils.wc.inventory,r=ow.utils.wc.store,a=ow.utils.wc.owutils,o=Backbone.View.extend({initialize:function(){_.bindAll(this)},isBrowseAvailabilityPreferencesEnabled:function(){return"true"===$.cookie("OW_BROWSE_AVAILABILITY_PREFERENCES")||ow.state.browseAvailabilityPreferencesEnabled},isUserLocationSet:function(){return!("undefined"==typeof $.cookie("OW_DELIVER_POSTCODE")||"undefined"==typeof $.cookie("OW_DELIVER_SUBURB")||"undefined"==typeof $.cookie("LOCATION_IDENTIFIED"))},isDeliveryLocationSet:function(){return!("undefined"==typeof $.cookie("OW_DELIVER_POSTCODE")||"undefined"==typeof $.cookie("OW_DELIVER_SUBURB"))},isStoreLocationSet:function(){return r.isLocationSet()},isShowLocationModalOnAddToCart:function(){var e=this;return e},handleSuburbSelect:function(e,t,r,a,o){var i=this;e.preventDefault(),i.selectSuburb(e,function(e){i.isCloseExpected=!0,$("#browseAvailabilityPreferencesSuburbModal").modal("hide"),r?i.displayLocationConfirmationModal(t,e,a,o):a&&a(e)})},handleAutocomplete:function(e,t,r,a,o){var i=this;if(e.preventDefault(),"37"==e.keyCode||"38"==e.keyCode||"39"==e.keyCode||"40"==e.keyCode){var n=-1,s=$(".browseAvailabilityPreferencesSelectSuburb");if(s.length>0){for(var c=0;c<s.length;c++)if($(s[c]).hasClass("selected")){n=c;break}-1!==n&&$(s[n]).removeClass("selected"),"38"==e.keyCode?n=-1===n?s.length-1:(n-1)%s.length:"40"==e.keyCode&&(n=-1===n?0:(n+1)%s.length),-1!==n&&$(s[n]).addClass("selected")}}else{var l=$("#browseAvailabilityPreferencesSuburbSearchText").val();l?i.findSuburb(l).done(function(e){i.renderSuburbAutocomplete(e),$(".browseAvailabilityPreferencesSelectSuburb").click(function(e){i.handleSuburbSelect(e,t,r,a,o)})}):$("#eac-container-browseAvailabilityPreferencesSuburbSearchText ul").hide()}},displaySuburbLocationModal:function(e,t,r,a){var o=this;o.isCloseExpected=!1,o.promiseUserData().done(function(i){var n=Handlebars.templates.browseAvailabilityPreferencesSuburbModal;$("body").append(n({userData:i})),$("#browseAvailabilityPreferencesSuburbSearchText").keyup(function(i){o.handleAutocomplete(i,e,t,r,a)}),$("#browseAvailabilityPreferencesSuburbSearchButton").click(function(i){o.handleSuburbSelect(i,e,t,r,a)}),$("#browseAvailabilityPreferencesSuburbSearchForm").submit(function(i){o.handleSuburbSelect(i,e,t,r,a)}),$("#browseAvailabilityPreferencesSuburbGeolocateButton").click(function(){o.geolocateSuburb(e,t,r,a)}),$("#browseAvailabilityPreferencesSuburbModal").one("hide.bs.modal",function(){$("#browseAvailabilityPreferencesSuburbModal").remove(),o.isCloseExpected||"function"!=typeof a||a()});var s={show:!0};e||(s.backdrop="static",s.keyboard=!1,$("#browseAvailabilityPreferencesSuburbModal button.close").toggle()),$("#browseAvailabilityPreferencesSuburbModal").modal(s),$("body").addClass("modal-open")})},findSuburb:function(e){var t=$.Deferred();return setTimeout(function(){var r=$("#browseAvailabilityPreferencesSuburbSearchText").val();if(r===e)if(ow.utils.globalvariablecache.has("suburbSearchCache",e.toLowerCase())){var a=ow.utils.globalvariablecache.get("suburbSearchCache",e.toLowerCase());t.resolve({searchTerm:e,suburbData:a})}else $.get("/webapp/wcs/stores/servlet/OWSuburbSearch?nc=true&suburbOrPostcode="+e).done(function(r){"SUCCESS"===r.status&&(ow.utils.globalvariablecache.put("suburbSearchCache",e.toLowerCase(),r[0]),t.resolve({searchTerm:e,suburbData:r}))});else t.reject()},200),t.promise()},renderSuburbAutocomplete:function(e){var t=$("#browseAvailabilityPreferencesSuburbSearchText").val();if(e.searchTerm===t){var r=Handlebars.templates.browseAvailabilityPreferencesSuburbAutocomplete;$("#eac-container-browseAvailabilityPreferencesSuburbSearchText").html(r({searchTerm:e.suburbData.suburbOrPostcode,suburbData:e.suburbData.results})),e.suburbData&&e.suburbData.results&&e.suburbData.results.length>0&&$("#eac-container-browseAvailabilityPreferencesSuburbSearchText ul").show()}},displayLocationConfirmationModal:function(e,t,r,a){var o=this;o.isCloseExpected=!1;var i=Handlebars.templates.browseAvailabilityPreferencesModal;$("body").append(i(t)),$("#browseAvailabilityPreferencesModal").one("hide.bs.modal",function(){$("#browseAvailabilityPreferencesModal").remove(),o.isCloseExpected||"function"!=typeof a||a()}),$("#browseAvailabilityPreferencesModal").one("shown.bs.modal",function(){$("body").addClass("modal-open")});var n={show:!0};e||(n.backdrop="static",n.keyboard=!1,$("#browseAvailabilityPreferencesModal button.close").toggle()),$("#browseAvailabilityPreferencesModal").modal(n),$("#browseAvailabilityPreferencesShowAvailability").click(function(e){e.preventDefault(),o.closeLocationConfirmationModal(),r(t)}),$("#browseAvailabilityPreferencesChangeSuburb").click(function(t){t.preventDefault(),o.closeLocationConfirmationModal(),o.displaySuburbLocationModal(e,!0,r,a)}),$("#browseAvailabilityPreferencesChangeStore").click(function(i){i.preventDefault(),o.closeLocationConfirmationModal(),o.displayStoreModalFromConfirm(e,t,r,a)})},closeLocationConfirmationModal:function(){this.isCloseExpected=!0,$("#browseAvailabilityPreferencesModal").modal("hide")},displayStoreModalFromConfirm:function(e,t,r,a){var o=this;o.displayStoreLocationModal(function(i){i&&(t.storeName=i.storeName,t.storeId=i.storeId,t.storeUniqueId=i.storeUniqueId,t.storeAddress=i.storeAddress),o.displayLocationConfirmationModal(e,t,r,a)},function(){o.displayLocationConfirmationModal(e,t,r,a)})},displayStoreLocationModal:function(e,t){var r=this;ow.state.addToCartDfd=null,this.isCloseExpected=!1;var a=r.getDeliverPostcode(),o=r.getDeliverSuburb(),i={postcode:a,suburb:o},n=Handlebars.templates.browseAvailabilityPreferencesStoreModal;$("body").append(n(i)),$(document).trigger("contentloaded"),$("#browseAvailabilityPreferencesStoreModal").one("hide.bs.modal",function(){$("#browseAvailabilityPreferencesStoreModal").remove(),r.isCloseExpected||"function"!=typeof t||t()}),$("#browseAvailabilityPreferencesStoreModal").modal("show"),$("body").addClass("modal-open"),$("#browseAvailabilityPreferencesStoreSearchButton").on("click submit",function(t){r.searchStore(t,e)}),$("#browseAvailabilityPreferencesStoreSearchForm").submit(function(t){r.searchStore(t,e)})},closeStoreLocationModal:function(){this.isCloseExpected=!0,$("#browseAvailabilityPreferencesStoreModal").modal("hide")},searchStore:function(e,t){var r=this;if(e.preventDefault(),$("#browseAvailabilityPreferencesStoreSearchForm").valid()){$("#browseAvailabilityPreferencesStoreSearchButton").addClass("is-pending");var a=$("#browseAvailabilityPreferencesStoreSearchText").val(),o=$("#browseAvailabilityPreferencesStoreSearchButton").data("postcode"),i=$("#browseAvailabilityPreferencesStoreSearchButton").data("suburb");a&&r.findStoreByAddress(a,o,i).done(function(e){r.renderStoreSearchResults(e,t)}).always(function(){$("#browseAvailabilityPreferencesStoreSearchButton").removeClass("is-pending")})}},findStoreByAddress:function(e,t,r){var a=$.Deferred();if(ow.utils.globalvariablecache.has("storeSearchCache",e.toLowerCase())){var o=ow.utils.globalvariablecache.get("storeSearchCache",e.toLowerCase());a.resolve({searchTerm:e,suburbData:{postcode:t,suburb:r},storeData:o})}else $.get(ow.url.storeLocatorCmdURL+"&service=&address="+e).done(function(o){o.nc&&ow.utils.globalvariablecache.put("storeSearchCache",e.toLowerCase(),o),a.resolve({searchTerm:e,suburbData:{postcode:t,suburb:r},storeData:o})}).fail(function(){a.reject()});return a.promise()},renderStoreSearchResults:function(e,t){var r=this,a=Handlebars.templates.storeavailability,o=new window.ow.utils.wc.storelocatorutil,i=o.getOWStores(e.storeData);i&&(i.isUserLocationControl=!0),$.each(i,function(e,t){t.storeLocatorViewURL=window.ow.url.storeLocatorViewURL.replace(/&amp;/g,"&")}),$("#browseAvailabilityPreferencesStoreSearchResults").html(a(i)),$.each($("#browseAvailabilityPreferencesStoreSearchResults .set-userlocation-store"),function(t,r){$(r).data("postcode",e.suburbData.postcode),$(r).data("suburb",e.suburbData.suburb),$(r).data("storeName",i[t].storeName),$(r).data("storeUniqueId",e.storeData.stores[t].storeUniqueId),$(r).data("storeAddress",$.trim(i[t].storeAddressLine)+", "+$.trim(i[t].storeCity))}),$("body").addClass("modal-open"),$(".set-userlocation-store").click(function(e){r.selectStore(e,t)})},selectStore:function(e,t){e.preventDefault();var r=$(e.currentTarget),a=this,o={postcode:r.data("postcode"),suburb:r.data("suburb"),storeId:r.data("storeid"),storeName:r.data("storeName"),storeUniqueId:r.data("storeUniqueId"),storeAddress:r.data("storeAddress")};a.closeStoreLocationModal(),t(o)},getDeliverPostcode:function(){return(ow.state.yourstoredata?ow.state.yourstoredata.deliverPostcode:!1)||$.cookie("OW_DELIVER_POSTCODE")},getDeliverSuburb:function(){return(ow.state.yourstoredata?ow.state.yourstoredata.deliverSuburb:!1)||$.cookie("OW_DELIVER_SUBURB")},geolocateSuburb:function(e,t,r,a){var o=this;navigator.geolocation.getCurrentPosition(function(i){o.promiseGeocoder().done(function(n){n.geocode({location:{lat:i.coords.latitude,lng:i.coords.longitude}},function(n,s){var c=!1;"OK"===s&&$.each(n,function(n,s){"undefined"!=typeof s.types&&$.each(s.types,function(n,l){if("postal_code"===l&&"undefined"!=typeof s.address_components&&s.address_components.length>1){c=!0;var d=s.address_components[0].short_name,u=s.address_components[1].short_name;o.findStoreByLatLong(i.coords.latitude,i.coords.longitude,d,u).done(function(i){if("undefined"!=typeof i&&"undefined"!=typeof i.storeData.stores&&i.storeData.stores.length>0){var n=i.storeData,s=n.stores[0].storeIdentifier,c=n.stores[0].storeName,l=n.stores[0].storeUniqueId,p=n.stores[0].storeAddressLine+", "+n.stores[0].storeCity;o.promiseUserData().done(function(i){o.isCloseExpected=!0,$("#browseAvailabilityPreferencesSuburbModal").modal("hide");var n={postcode:d,suburb:u,storeId:s,storeName:c,storeUniqueId:l,storeAddress:p,userData:i};t?o.displayLocationConfirmationModal(e,n,r,a):r&&r(n)}).fail(function(){$("#browseAvailabilityPreferencesSuburbGeolocateButton").prop("disabled",!0),$("#browseAvailabilityPreferencesSuburbGeolocateButton-error").css("display","block")})}else $("#browseAvailabilityPreferencesSuburbGeolocateButton").prop("disabled",!0),$("#browseAvailabilityPreferencesSuburbGeolocateButton-error").css("display","block")})}})}),c||($("#browseAvailabilityPreferencesSuburbGeolocateButton").prop("disabled",!0),$("#browseAvailabilityPreferencesSuburbGeolocateButton-error").css("display","block"))})}).fail(function(){$("#browseAvailabilityPreferencesSuburbGeolocateButton").prop("disabled",!0),$("#browseAvailabilityPreferencesSuburbGeolocateButton-error").css("display","block")})},function(){$("#browseAvailabilityPreferencesSuburbGeolocateButton").prop("disabled",!0),$("#browseAvailabilityPreferencesSuburbGeolocateButton-error").css("display","block")})},promiseGeocoder:function(){var e=this,t=$.Deferred();if("undefined"==typeof e.geocoder||""==e.geocoder){var r=$.Deferred();googleMapsCallback=function(){r.resolve()},$.extend({loadGoogleMaps:function(){return $.ajax({url:"https://maps.googleapis.com/maps/api/js?v=3&client="+ow.state.googleMapClientKey+"&sensor=false&callback=googleMapsCallback",dataType:"script"}).fail(function(){r.reject()}),r.promise()}}),$.loadGoogleMaps().done(function(){e.geocoder=new google.maps.Geocoder,t.resolve(e.geocoder)}).fail(function(){t.reject()})}else t.resolve(e.geocoder);return t.promise()},promiseUserData:function(){return"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.promiseUserData()},selectSuburb:function(e,t){var r,o=this;"submit"===e.type?(r=$(".browseAvailabilityPreferencesSelectSuburb.selected"),r&&0!==r.length||(r=$(".browseAvailabilityPreferencesSelectSuburb"))):(r=$(e.currentTarget),"browseAvailabilityPreferencesSuburbSearchButton"===e.currentTarget.id&&(r=$(".browseAvailabilityPreferencesSelectSuburb")));var i=r.data("postcode"),n=r.data("suburb"),s=r.data("lat"),c=r.data("lon");i&&n&&s&&c&&(a.loader("show","main","ow-loading ow-loading--expand"),o.findStoreByLatLong(s,c,i,n).done(function(e){var r="",s="",c="",l="";if("undefined"!=typeof e.storeData.stores&&e.storeData.stores.length>0){var d=e.storeData;r=d.stores[0].storeIdentifier,s=d.stores[0].storeName,c=d.stores[0].storeUniqueId,l=d.stores[0].storeAddressLine+", "+d.stores[0].storeCity}o.promiseUserData().done(function(e){var a={postcode:i,suburb:n,storeId:r,storeName:s,storeUniqueId:c,storeAddress:l,userData:e};t&&t(a)}).always(function(){a.loader("hide")})}))},findStoreByLatLong:function(e,t,r,a){var o=$.Deferred();return $.get(ow.url.storeLocatorCmdURL+"&service=&lat="+e+"&lon="+t).done(function(e){o.resolve({suburbData:{postcode:r,suburb:a},storeData:e})}),o.promise()},setLocationOnSearchOrPDP:function(a){var o=(ow.state.yourstoredata,$.Deferred());return r.setStoreAndDeliverLocation(a.storeId,a.postcode,a.suburb,function(r){r?(e.trigger("setPrefStore",r),ow.utils.globalvariablecache.clear("inventoryCache"),ow.state.listingpage?ow.state.listingpage.setView(!0).always(function(){o.resolve()}):t.update().always(function(){o.resolve()})):o.reject()}),o}});return o}(),ow.controls.userlocationview=function(){var e=ow.controls.userlocationcontrol,t=ow.utils.wc.store,r=ow.utils.wc.eventbus,a=ow.utils.wc.owutils,o=ow.utils.wc.inventory,i=Backbone.View.extend({initialize:function(){_.bindAll(this),e=new ow.controls.userlocationcontrol({el:$(document)})},events:{"click .showavailability-button":"setDeliveryLocation","click .changeavailability-button":"setDeliveryLocation","click .changestoreavailability-button":"setStoreLocation"},getUserLocationControl:function(){return e},setStoreLocation:function(){var a=this;e.displayStoreLocationModal(function(e){t.setStore(e.storeId,function(e){e&&(r.trigger("setPrefStore",e),ow.utils.globalvariablecache.clear("inventoryCache"),o.update(),a.displayUserLocationHeaderBar())})})},setDeliveryLocation:function(){var i=!e.isUserLocationSet(),n=!0;e.displaySuburbLocationModal(n,i,function(i){var n=ow.state.yourstoredata&&ow.state.yourstoredata.externalIdentifier?ow.state.yourstoredata.externalIdentifier:$.cookie("OW_STORE_NAME");e.isUserLocationSet()||(n=i.storeId),t.setStoreAndDeliverLocation(n,i.postcode,i.suburb,function(e){e&&(r.trigger("setPrefStore",e),ow.utils.globalvariablecache.clear("inventoryCache"),ow.state.listingpage?ow.state.listingpage.setView(!0):($('[data-cart="add"]').removeAttr("disabled"),o.noStockList=[],o.update().always(a.loader("hide","main"))))})})},setUserLocationHeaderBarHtml:function(){$(".ow-delivery-details-header").length?$(".ow-delivery-details-header").replaceWith(Handlebars.templates["availability-header"]()):$("#productList").length&&$("#productList").before(Handlebars.templates["availability-header"]())},displayUserLocationHeaderBar:function(a){var o=this;e.isUserLocationSet()&&!ow.state.yourstoredata?t.reloadStore(function(e){r.trigger("setPrefStore",e),o.setUserLocationHeaderBarHtml(a)}):o.setUserLocationHeaderBarHtml(a)}});return new i({el:$(document)})}(),ow.controls.yourstorecontrol=function(){var e=ow.utils.wc.eventbus,t=Backbone.View.extend({initialize:function(){this.yourstoreTemplate=Handlebars.templates.firstStoreTemplate,this.storelocatorIconTemplate=Handlebars.templates.storeLocatorIconTemplate,this.selectChangeMessageTemplate=Handlebars.templates.selectChangeMessageTemplate,e.on("setPrefStore",this.bind,this)},bind:function(t){this.model=t,this.render(),ow.state.yourstoredata=t,e.trigger("owSearchLocationSet")},render:function(){void 0==this.model&&(this.model={}),this.model.storeLocatorViewURL=ow.url.storeLocatorViewURL.replace(/&amp;/g,"&");var e=this.yourstoreTemplate(this.model),t=e.replace(/%2C/g,",");$(".yourfirststore").html(t);var r=this.selectChangeMessageTemplate(this.model);$(".select-change-message").html(r)}});return t}(),ow.application.app=function(){var e=(ow.controls.addtocartcontrol,ow.controls.analytics,ow.application.commonui,ow.application.minicartcontrol,ow.utils.wc.analytics);ow.tagging.analytics=e,$(function(){function e(){"function"==typeof ow.utils.wc.customerinfoutil&&(ow.utils.wc.customerinfoutil=new ow.utils.wc.customerinfoutil),ow.utils.wc.customerinfoutil.getUserData(function(e){return e.restrictedRangeActive||e.displayGSTExclusive||e.contractCustomer?($("#CatalogSearchForm").removeClass("hide"),void $("#CatalogSearchFormAlgolia").addClass("hide")):void(ow&&ow.state&&ow.state.algolia===!0&&ow.state.algoliaSearchEnabled===!0&&($("#CatalogSearchForm").addClass("hide"),$("#CatalogSearchFormAlgolia").removeClass("hide")))})}e(),ow.utils.wc.eventbus.trigger("initMiniCartQtyFromStorage"),ow.state.dontloadminicart&&$("#shopping-cart").remove(),$(document).ajaxError(function(e,t){401==t.status&&(window.location.href=ow.url.relogonFormURL)}),$(document).ajaxSuccess(function(e,t){void 0!=t.responseText&&t.responseText.lastIndexOf("errorCode")>0&&(t.responseText.lastIndexOf("_ERR_USER_AUTHORITY")>0||t.responseText.lastIndexOf("_ERR_DIDNT_LOGON")>0)&&(window.location.href=ow.url.relogonFormURL)})})}();