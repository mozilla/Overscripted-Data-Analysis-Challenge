###################################################################################
# Author: Azis Toktobaev
# Username: toktobaeva
# Purpose: Identifying all instances of Local Shared Objects, Remote Shared Objects and Java JNLP Persistence-Service
# files withing a dataset using functions provided by Java Overscripted.
#
###################################################################################
# Acknowledgements:
# Data set derived from the November 2017 SRG Mozilla Web Crawl dataset and compiled in a CSV file by @birdsarah
#
# licensed under a Creative Commons
# Attribution-Noncommercial-Share Alike 3.0 United States License.
####################################################################################

f = """
window.document.cookie,35455680
window.navigator.userAgent,15534371
window.Storage.getItem,10553944
window.localStorage,8767285
window.Storage.setItem,4175556
window.sessionStorage,4033894
window.Storage.removeItem,2932713
window.name,2484730
CanvasRenderingContext2D.fillStyle,1957519
window.navigator.plugins[Shockwave Flash].description,1863285
window.screen.colorDepth,1449905
window.navigator.appName,1286084
window.navigator.language,1172256
window.navigator.platform,1140738
CanvasRenderingContext2D.save,1000762
CanvasRenderingContext2D.restore,997755
CanvasRenderingContext2D.fill,954340
CanvasRenderingContext2D.fillRect,936267
window.navigator.plugins[Shockwave Flash].name,895289
CanvasRenderingContext2D.font,814310
CanvasRenderingContext2D.lineWidth,718195
window.navigator.appVersion,707298
window.navigator.cookieEnabled,692524
HTMLCanvasElement.width,681003
CanvasRenderingContext2D.strokeStyle,650211
HTMLCanvasElement.height,644476
HTMLCanvasElement.getContext,596749
window.Storage.key,551691
CanvasRenderingContext2D.fillText,542896
window.Storage.length,541077
CanvasRenderingContext2D.stroke,537024
CanvasRenderingContext2D.measureText,522209
window.navigator.vendor,487833
window.navigator.doNotTrack,468365
CanvasRenderingContext2D.arc,413449
HTMLCanvasElement.style,294223
CanvasRenderingContext2D.textBaseline,293489
window.navigator.product,279653
CanvasRenderingContext2D.textAlign,246380
window.navigator.plugins[Shockwave Flash].filename,225751
window.navigator.mimeTypes[application/x-shockwave-flash].type,213769
window.navigator.languages,199435
window.navigator.plugins[Shockwave Flash].length,184995
CanvasRenderingContext2D.bezierCurveTo,176757
CanvasRenderingContext2D.shadowBlur,172808
CanvasRenderingContext2D.shadowOffsetY,161446
CanvasRenderingContext2D.shadowOffsetX,159263
CanvasRenderingContext2D.shadowColor,158579
window.screen.pixelDepth,156326
CanvasRenderingContext2D.rect,154007
HTMLCanvasElement.nodeType,153630
CanvasRenderingContext2D.lineJoin,151407
window.navigator.mimeTypes[application/futuresplash].type,150364
CanvasRenderingContext2D.lineCap,149511
window.navigator.plugins[Shockwave Flash].version,144656
CanvasRenderingContext2D.strokeRect,142838
HTMLCanvasElement.toDataURL,135041
CanvasRenderingContext2D.createRadialGradient,132444
CanvasRenderingContext2D.globalCompositeOperation,122162
window.navigator.onLine,116037
CanvasRenderingContext2D.scale,115227
window.Storage.hasOwnProperty,108138
CanvasRenderingContext2D.clip,106238
CanvasRenderingContext2D.miterLimit,102589
window.navigator.mimeTypes[application/x-shockwave-flash].suffixes,94030
window.navigator.mimeTypes[application/futuresplash].suffixes,94025
RTCPeerConnection.localDescription,88683
window.navigator.productSub,71139
window.navigator.mimeTypes[application/x-shockwave-flash].description,70284
window.navigator.mimeTypes[application/futuresplash].description,70278
HTMLCanvasElement.nodeName,67621
CanvasRenderingContext2D.rotate,63824
HTMLCanvasElement.parentNode,57192
window.navigator.oscpu,54799
window.navigator.appCodeName,51161
CanvasRenderingContext2D.createLinearGradient,46710
CanvasRenderingContext2D.putImageData,45469
window.navigator.geolocation,43022
CanvasRenderingContext2D.getImageData,41412
HTMLCanvasElement.ownerDocument,37831
HTMLCanvasElement.className,36778
RTCPeerConnection.onicecandidate,32522
HTMLCanvasElement.getAttribute,31800
window.navigator.vendorSub,26840
HTMLCanvasElement.addEventListener,23485
window.navigator.buildID,23419
HTMLCanvasElement.classList,22963
HTMLCanvasElement.setAttribute,20689
HTMLCanvasElement.clientHeight,20665
HTMLCanvasElement.clientWidth,20341
HTMLCanvasElement.getElementsByTagName,16224
HTMLCanvasElement.tagName,14475
RTCPeerConnection.iceGatheringState,13984
RTCPeerConnection.createDataChannel,13776
RTCPeerConnection.signalingState,13160
RTCPeerConnection.remoteDescription,13113
RTCPeerConnection.createOffer,13015
CanvasRenderingContext2D.setLineDash,12590
HTMLCanvasElement.onselectstart,12054
RTCPeerConnection.setLocalDescription,11844
CanvasRenderingContext2D.arcTo,11428
CanvasRenderingContext2D.isPointInPath,11342
CanvasRenderingContext2D.createImageData,11163
HTMLCanvasElement.id,10941
CanvasRenderingContext2D.imageSmoothingEnabled,9722
HTMLCanvasElement.draggable,9558
HTMLCanvasElement.constructor,9246
CanvasRenderingContext2D.createPattern,8713
CanvasRenderingContext2D.lineDashOffset,7726
HTMLCanvasElement.offsetWidth,7346
CanvasRenderingContext2D.mozImageSmoothingEnabled,6561
RTCPeerConnection.idpLoginUrl,6556
RTCPeerConnection.peerIdentity,6556
RTCPeerConnection.onremovestream,6556
HTMLCanvasElement.offsetHeight,6175
CanvasRenderingContext2D.strokeText,5147
HTMLCanvasElement.firstChild,4897
HTMLCanvasElement.hasAttribute,4604
HTMLCanvasElement.localName,4577
HTMLCanvasElement.attributes,4507
HTMLCanvasElement.nextSibling,3857
AudioContext.destination,3758
HTMLCanvasElement.firstElementChild,3586
HTMLCanvasElement.nextElementSibling,3560
window.Storage.clear,3348
HTMLCanvasElement.dir,3171
CanvasRenderingContext2D.mozCurrentTransform,3102
OscillatorNode.frequency,3056
AudioContext.createOscillator,2898
OscillatorNode.start,2687
CanvasRenderingContext2D.__lookupGetter__,2543
HTMLCanvasElement.childNodes,2541
CanvasRenderingContext2D.hasOwnProperty,2422
HTMLCanvasElement.getBoundingClientRect,2276
HTMLCanvasElement.offsetLeft,2096
OscillatorNode.type,2011
OscillatorNode.connect,2011
CanvasRenderingContext2D.mozCurrentTransformInverse,1890
HTMLCanvasElement.removeAttribute,1814
HTMLCanvasElement.offsetTop,1812
HTMLCanvasElement.children,1795
HTMLCanvasElement.dispatchEvent,1698
HTMLCanvasElement.mozOpaque,1687
HTMLCanvasElement.onmousemove,1538
AudioContext.createDynamicsCompressor,1535
HTMLCanvasElement.offsetParent,1499
OfflineAudioContext.startRendering,1381
OfflineAudioContext.createDynamicsCompressor,1380
OfflineAudioContext.oncomplete,1380
OfflineAudioContext.createOscillator,1380
OfflineAudioContext.destination,1380
HTMLCanvasElement.remove,1257
HTMLCanvasElement.compareDocumentPosition,1253
AudioContext.state,1249
AudioContext.listener,1230
GainNode.connect,1204
AudioContext.createGain,1197
GainNode.gain,1112
HTMLCanvasElement.__proto__,1028
window.Storage.toString,1027
AudioContext.createAnalyser,905
HTMLCanvasElement.cloneNode,899
AudioContext.sampleRate,882
AudioContext.decodeAudioData,876
AudioContext.createMediaElementSource,860
HTMLCanvasElement.toBlob,837
HTMLCanvasElement.removeEventListener,779
AnalyserNode.fftSize,774
AnalyserNode.maxDecibels,771
AnalyserNode.smoothingTimeConstant,770
AnalyserNode.frequencyBinCount,770
AnalyserNode.minDecibels,769
RTCPeerConnection.addIceCandidate,769
AudioContext.onstatechange,745
HTMLCanvasElement.textContent,628
HTMLCanvasElement.onclick,466
HTMLCanvasElement.innerHTML,437
window.Storage.valueOf,423
RTCPeerConnection.setRemoteDescription,379
RTCPeerConnection.getStats,361
AudioContext.currentTime,354
OscillatorNode.stop,351
RTCPeerConnection.removeEventListener,346
RTCPeerConnection.addEventListener,346
HTMLCanvasElement.__lookupGetter__,344
AudioContext.createScriptProcessor,337
HTMLCanvasElement.hasOwnProperty,312
HTMLCanvasElement.onmousedown,310
HTMLCanvasElement.toString,291
ScriptProcessorNode.connect,288
ScriptProcessorNode.onaudioprocess,287
AnalyserNode.connect,285
HTMLCanvasElement.blur,280
HTMLCanvasElement.getAttributeNode,237
HTMLCanvasElement.onmouseout,232
HTMLCanvasElement.onmouseover,229
HTMLCanvasElement.append,227
HTMLCanvasElement.onmouseup,227
CanvasRenderingContext2D.ellipse,166
HTMLCanvasElement.setAttributeNode,152
HTMLCanvasElement.oncontextmenu,152
CanvasRenderingContext2D.getLineDash,146
HTMLCanvasElement.previousSibling,139
HTMLCanvasElement.parentElement,136
HTMLCanvasElement.innerText,134
HTMLCanvasElement.onkeydown,132
HTMLCanvasElement.onkeyup,129
HTMLCanvasElement.onkeypress,128
HTMLCanvasElement.onblur,128
HTMLCanvasElement.onfocus,128
HTMLCanvasElement.onmouseleave,127
HTMLCanvasElement.ondblclick,126
HTMLCanvasElement.ondragenter,125
HTMLCanvasElement.onresize,125
HTMLCanvasElement.onpaste,125
HTMLCanvasElement.onchange,125
HTMLCanvasElement.oncut,125
HTMLCanvasElement.ondragover,125
HTMLCanvasElement.ondragleave,125
HTMLCanvasElement.ondrop,125
HTMLCanvasElement.onmouseenter,125
HTMLCanvasElement.onload,125
HTMLCanvasElement.contains,102
HTMLCanvasElement.querySelectorAll,98
GainNode.disconnect,77
AudioContext.createBufferSource,70
HTMLCanvasElement.hasChildNodes,67
AudioContext.createBuffer,63
AudioContext.createPanner,60
HTMLCanvasElement.scrollLeft,60
HTMLCanvasElement.scrollTop,60
CanvasRenderingContext2D.__lookupSetter__,58
CanvasRenderingContext2D.__defineSetter__,58
HTMLCanvasElement.ondragstart,50
HTMLCanvasElement.getClientRects,49
HTMLCanvasElement.title,44
HTMLCanvasElement.tabIndex,43
RTCPeerConnection.close,43
RTCPeerConnection.iceConnectionState,33
AudioContext.close,32
HTMLCanvasElement.hasAttributes,25
HTMLCanvasElement.previousElementSibling,23
OscillatorNode.disconnect,22
HTMLCanvasElement.focus,22
RTCPeerConnection.onsignalingstatechange,16
RTCPeerConnection.oniceconnectionstatechange,16
HTMLCanvasElement.valueOf,16
HTMLCanvasElement.dataset,15
HTMLCanvasElement.requestPointerLock,15
HTMLCanvasElement.namespaceURI,13
HTMLCanvasElement.webkitMatchesSelector,12
HTMLCanvasElement.childElementCount,11
HTMLCanvasElement.removeChild,8
HTMLCanvasElement.insertBefore,8
GainNode.numberOfOutputs,7
HTMLCanvasElement.matches,6
HTMLCanvasElement.outerHTML,6
HTMLCanvasElement.appendChild,6
AudioContext.resume,5
AnalyserNode.getByteFrequencyData,5
HTMLCanvasElement.clientTop,4
HTMLCanvasElement.clientLeft,4
HTMLCanvasElement.onwheel,4
HTMLCanvasElement.DOCUMENT_NODE,4
RTCPeerConnection.onaddstream,3
AnalyserNode.channelInterpretation,3
AnalyserNode.numberOfInputs,3
AnalyserNode.channelCountMode,3
AnalyserNode.numberOfOutputs,3
AnalyserNode.channelCount,3
HTMLCanvasElement.scrollWidth,3
HTMLCanvasElement.scrollHeight,3
CanvasRenderingContext2D.__proto__,3
HTMLCanvasElement.getElementsByClassName,3
CanvasRenderingContext2D.__defineGetter__,3
HTMLCanvasElement.querySelector,2
OfflineAudioContext.decodeAudioData,2
RTCPeerConnection.createAnswer,2
CanvasRenderingContext2D.filter,2
AudioContext.createConvolver,1
HTMLCanvasElement.lastChild,1
CanvasRenderingContext2D.toString,1
"""
count = 0
for line in f.split('\n'):
    if "plugins[Shockwave Flash].description" in line:
        count += int(line.split(",")[1])
        print(line[17:])
print("Total:", count)

